"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[673],{52736:function(t,e,i){i.d(e,{j:function(){return K}});var n={getProps:function(){return{}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("input"))},events:{input:function(t){var e=t.target;return{type:"change",x:e.xValue,y:e.yValue}},"button-press":function(){return{type:"press"}},"button-release":function(){return{type:"release"}}}};function r(t){return!!t||void 0}var a={events:{"button-press":function(){return{type:"reset-press"}},"button-release":function(){return{type:"reset-release"}}},getProps:function(t){return t?{ledPower:r(t.ledPower>.05),led13:r(t.led13>.05),ledRX:r(t.ledRX>.05),ledTX:r(t.ledTX>.05)}:{}}},s={getProps:function(t){return{hasSignal:r(null===t||void 0===t?void 0:t.playing)}}},o=i(82670),u={getProps:function(){return{}},syncInitialState:function(t){var e=function(){return t.dispatchEvent(new InputEvent("input"))};e(),new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e()}))})).observe(t,{attributes:!0})},events:{input:function(t){var e=t.target;if((0,o.Z)(e,HTMLElement)){var i=parseFloat(e.getAttribute("temperature")||""),n=parseFloat(e.getAttribute("humidity")||"");return{temperature:isNaN(i)?24:i,humidity:isNaN(n)?40:n}}}}},l={getProps:function(t){return t?{ledPower:r(t.ledPower>.05),led1:r(t.led1>.05)}:{}}},c={getProps:function(t){return t?{ledPower:r(t.ledPower>.05),led1:r(t.led>.05)}:{}}},d={getProps:function(){return{}},syncInitialState:function(t){var e=function(){return t.dispatchEvent(new InputEvent("input",{detail:parseFloat(t.getAttribute("distance")||"400")}))};e(),new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&e()}))})).observe(t,{attributes:!0})},events:{input:function(t){var e=t.detail;if(null!=e)return{distance:e}}}},h={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i){for(var n=i.getImageData(0,0,128,128),r=n.data,a=t.pixels,s=t.invert,o=0;o<128;o++)for(var u=0;u<128;u++){var l=a[128*o+u],c=s?~l:l,d=4*(o*n.width+u);r[d+0]=(63488&c)>>8,r[d+1]=(2016&c)>>3,r[d+2]=(31&c)<<3,r[d+3]=255}i.putImageData(n,0,0)}}},v=240,f={getProps:function(){return{}},applyUpdate:function(t,e){var i,n=null===(i=e.canvas)||void 0===i?void 0:i.getContext("2d");if(n){for(var r=n.getImageData(0,0,v,320),a=r.data,s=t.pixels,o=t.invert,u=t.bgr,l=0;l<320;l++)for(var c=0;c<v;c++){var d=s[l*v+c],h=o?~d:d,f=4*(l*r.width+c),p=(63488&h)>>8,g=(31&h)<<3;a[f+0]=u?p:g,a[f+1]=(2016&h)>>3,a[f+2]=u?g:p,a[f+3]=255}n.putImageData(r,0,0)}},simulationStopped:function(t){var e,i=null===(e=t.canvas)||void 0===e?void 0:e.getContext("2d");i&&i.clearRect(0,0,v,320)}},p={getProps:function(){return{}},events:{"button-press":function(t){if((0,o.Z)(t,CustomEvent)&&"number"===typeof t.detail.irCode)return{address:0,command:t.detail.irCode}}}},g={getProps:function(t){return t?{cursor:r(t.cursor),blink:r(t.blink),cursorX:t.cursorX,cursorY:t.cursorY}:{}},applyUpdate:function(t,e){if(e.characters=t.value,e.backlight=t.backlight,t.cgramUpdated){var i=e.font.slice(0),n=t.cgram.slice(0,64);i.set(n,0),i.set(n,64),e.font=i}},simulationStopped:function(t){t.characters=new Uint8Array(80).fill(32),t.backlight=!1}},y={getProps:function(t){return null!=t?{value:r(t>=.01),brightness:t}:{}}},m={getProps:function(){return{}},events:{"button-press":function(t){if((0,o.Z)(t,CustomEvent))return{type:"press",row:t.detail.row,column:t.detail.column}},"button-release":function(t){if((0,o.Z)(t,CustomEvent))return{type:"release",row:t.detail.row,column:t.detail.column}}}},w={getProps:function(t){return t?{led1:r(t.ledOn)}:{}}},k=i(14116);function Z(t,e,i){return"serpentine"===i?function(t,i){return t%2===0?t*e+i:t*e+(e-i-1)}:function(t,i){return t*e+i}}var b={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i)for(var n,r=t.cols,a=t.rows,s=t.pixels,o=t.layout,u=t.brightness,l=t.colorFormat,c=Z(0,r,o),d=null!==(n=parseInt(e.dataset.pixsize||"",10))&&void 0!==n?n:1,h="circle"===e.dataset.pixtype,v=function(e){return isNaN(t.gamma)?e:255*Math.pow(e/255,t.gamma)},f=0;f<a;f++)for(var p=0;p<r;p++){var g=s[c(f,p)],y=void 0,m=void 0,w=void 0;if(l===k.q.RGBA){var b=u*((g>>24&255)/255);y=b*(255&g),m=b*(g>>8&255),w=b*(g>>16&255)}else w=u*v(255&g),y=u*v(g>>8&255),m=u*v(g>>16&255);if(i.fillStyle="rgb(".concat(y,", ").concat(m,", ").concat(w,")"),h){var C=d/2;i.beginPath(),i.ellipse(p*d+C,f*d+C,C,C,0,0,360),i.fill()}else i.fillRect(p*d,f*d,d,d)}}},C=i(11113),_={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i)for(var n,r=t.pixels,a="circle"===e.dataset.pixtype,s=null!==(n=parseInt(e.dataset.pixsize||"",10))&&void 0!==n?n:1,o=0;o<C.Cb;o++)for(var u=0;u<C.bf;u++){var l=r[o*C.bf+u],c=255&l,d=l>>8&255,h=l>>16&255;if(i.fillStyle="rgb(".concat(h,", ").concat(d,", ").concat(c,")"),a){var v=s/2;i.beginPath(),i.ellipse(u*s+v,o*s+v,v,v,0,0,360),i.fill()}else i.fillRect(u*s,o*s,s,s)}}},S={getProps:function(){return{}},applyUpdate:function(t,e){var i=t.cols,n=t.rows,r=t.pixels,a=t.layout,s=t.brightness/255,o=Z(0,i,a);if("function"===typeof e.setPixel)for(var u=0;u<n;u++)for(var l=0;l<i;l++){var c=r[o(u,l)],d=s*(255&c),h=s*(c>>8&255),v=s*(c>>16&255);e.setPixel(u,l,{r:h,g:v,b:d})}}},x={getProps:function(){return{}},applyUpdate:function(t,e){var i,n=null===(i=e.getPort)||void 0===i?void 0:i.call(e);if(n&&this.lastValue!==t){this.lastValue=t;for(var r=new Uint8Array(3*t.length),a=0;a<t.length;a++){var s=t[a],o=255&s,u=s>>8&255,l=s>>16&255;r[3*a]=u,r[3*a+1]=l,r[3*a+2]=o}if(n.writable.locked)console.log("Serial NeoPixel: Skipped a frame");else{e.setTransmitting(!0);var c=n.writable.getWriter();c.write(r).then((function(){c.releaseLock()}))}}}},P={getProps:function(t){return t?{ledPower:r(t.ledOn),ledDO:r(t.ledDigitalOut)}:{}}},I={getProps:function(){return{min:"0",max:"1023",step:"1"}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("input",{detail:t.value}))},events:{input:function(t){var e=t.detail;if(null!=e)return{value:e}}}},D={getProps:function(){return{}},syncInitialState:function(t){t.wokwiListeners||(t.addEventListener("wokwi-keydown",(function(){t.pressed=!0,t.dispatchEvent(new CustomEvent("button-press"))})),t.addEventListener("wokwi-keyup",(function(){t.pressed=!1,t.dispatchEvent(new CustomEvent("button-release"))})),t.wokwiListeners=!0)},events:{"button-press":function(){return{type:"press"}},"button-release":function(){return{type:"release"}}}},A={getProps:function(){return{}},events:{dial:function(t){return(0,o.Z)(t,CustomEvent)?{type:"dial",digit:t.detail.digit}:null}}},R=i(51438),B=i(52951),T=i(14924),E=function(){function t(e){var i=this;(0,R.Z)(this,t),(0,T.Z)(this,"rpm",void 0),(0,T.Z)(this,"raf",void 0),(0,T.Z)(this,"targetAngle",void 0),(0,T.Z)(this,"lastAnimationTime",void 0),(0,T.Z)(this,"animate",void 0),(0,T.Z)(this,"servo",void 0),this.servo=e,this.rpm=60,this.raf=null,this.targetAngle=this.servo.angle,this.lastAnimationTime=0,this.animate=function(){var t=(new Date).getTime(),e=360*(t-i.lastAnimationTime)*i.rpm/60/1e3,n=i.targetAngle-i.angle,r=Math.min(Math.abs(n),e);r&&(i.servo.angle=i.angle+r*(n>0?1:-1),i.lastAnimationTime=t),i.raf=n?requestAnimationFrame(i.animate):null}}return(0,B.Z)(t,[{key:"angle",get:function(){return this.servo.angle},set:function(t){this.targetAngle=t,t!==this.angle?null==this.raf&&(this.lastAnimationTime=(new Date).getTime(),this.animate()):this.stop()}},{key:"stop",value:function(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}}]),t}(),U=Symbol("animator"),N={getProps:function(){return{}},applyUpdate:function(t,e){e[U]||(e[U]=new E(e)),e[U].angle=t}},O={getProps:function(t){return null!=t?{values:JSON.stringify(t.segments),colonValue:r(t.colon>.05)}:{values:"[]"}}},M={getProps:function(){return{}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("input",{detail:t.value}))},events:{input:function(t){var e=t.detail;if(null!=e)return{value:e}}}},L={getProps:function(){return{}},applyUpdate:function(t,e){e.setPixels(t)},simulationStopped:function(t){t.setPixels(new Uint32Array(0))}},V={getProps:function(){return{}},applyUpdate:function(t,e){if(e){for(var i=e.imageData,n=t.pixels,r=t.invert,a=t.displayOn,s=t.reverseRows,o=t.scrollOffset,u=t.startLine,l=i.data,c=i.width,d=i.height,h=0;h<d;h++)for(var v=0;v<c;v++){var f=h+o+u,p=(s?d-1-f:f)%d,g=n[Math.floor(p/8)*c+v]&1<<p%8?!r:r,y=4*(h*i.width+v);l.fill(g?255:0,y,y+3),l[y+3]=a?255:0}e.redraw()}},simulationStopped:function(t){var e,i;null===(e=t.imageData)||void 0===e||e.data.fill(0),null===(i=t.redraw)||void 0===i||i.call(t)}},F={getProps:function(){return{}},applyUpdate:function(t,e){var i=e.getContext("2d");if(i){var n=t.pixels,r=i.getImageData(0,0,e.clientWidth,e.clientHeight);new Uint32Array(r.data.buffer).set(n),i.putImageData(r,0,0)}}},J={getProps:function(t){return null!=t?{values:JSON.stringify(t.segments)}:{values:"[]"}}},W={getProps:function(){return{}},syncInitialState:function(t){t.dispatchEvent(new InputEvent("switch-change",{detail:-1}))},events:{"switch-change":function(t){return{values:t.target.values}}}},H=i(26042);var K={"wokwi-led":y,"wokwi-buzzer":s,"wokwi-dht22":u,"wokwi-lcd1602":g,"wokwi-lcd2004":g,"wokwi-led-ring":{getProps:function(){return{}},applyUpdate:function(t,e){if("function"===typeof e.setPixel)for(var i=0;i<t.length;i++){var n=t[i],r=(255&n)/255,a=(n>>8&255)/255,s=(n>>16&255)/255;e.setPixel(i,{r:a,g:s,b:r})}}},"wokwi-arduino-mega":a,"wokwi-arduino-nano":a,"wokwi-arduino-uno":a,"wokwi-dip-switch-8":W,"wokwi-esp32-devkit-v1":l,"wokwi-ssd1306":V,"wokwi-ds1307":{getProps:function(){return{}}},"wokwi-franzininho":c,"wokwi-hc-sr04":d,"wokwi-ir-receiver":{getProps:function(){return{}}},"wokwi-ir-remote":p,"wokwi-membrane-keypad":m,"wokwi-pi-pico":{getProps:function(t){return t?{led:t.led}:{}}},"wokwi-pushbutton":D,"wokwi-rotary-dialer":A,"wokwi-7segment":O,"wokwi-neopixel":{getProps:function(t){var e=null===t||void 0===t?void 0:t[0];return null!=e?{b:(255&e)/255,r:(e>>8&255)/255,g:(e>>16&255)/255}:{}}},"wokwi-neopixel-canvas":b,"wokwi-apa102-matrix":b,"wokwi-led-matrix":S,"wokwi-il9163":h,"wokwi-ili9341":f,"wokwi-neopixel-matrix":S,"wokwi-neopixel-serial":x,"wokwi-servo":N,"wokwi-slide-switch":M,"wokwi-splendida":L,"wokwi-max7219-matrix":{getProps:function(){return{}},applyUpdate:function(t,e){e.updatePixels(t.pixels)}},"wokwi-potentiometer":I,"wokwi-slide-potentiometer":I,"wokwi-analog-joystick":n,"wokwi-tv":F,"wokwi-logic-analyzer":{getProps:function(t){return t?{samples:t.samples,activeChannels:t.activeChannels}:{}}},"wokwi-photoresistor-sensor":P,"wokwi-ky-040":{getProps:function(){return{}},events:{"rotate-cw":function(){return{type:"rotate-cw"}},"rotate-ccw":function(){return{type:"rotate-ccw"}},"button-press":function(){return{type:"press"}},"button-release":function(){return{type:"release"}}}},"wokwi-mpu6050":w,"wokwi-rgb-led":{getProps:function(t){return null!=t?{ledRed:t.r,ledGreen:t.g,ledBlue:t.b}:{}}},"wokwi-tinypico":{getProps:function(t){return t?{ledPower:t.ledPower,ledRed:t.ledRed,ledGreen:t.ledGreen,ledBlue:t.ledBlue}:{}}},"wokwi-hub75-matrix":_,"wokwi-led-bar-graph":J,"wokwi-stepper-motor":{getProps:function(t){return t?(0,H.Z)({angle:t.angle},function(t){switch(t.display){case"angle":return{value:t.angle.toFixed(1),units:"degrees"};case"steps":return{value:Math.round(t.steps).toString(),units:"steps"};case"none":return{value:"",units:""}}}(t)):{angle:0}}},"wokwi-tm1637-7segment":{getProps:function(t){return null!=t?{values:JSON.stringify(t.segments),colonValue:r(t.colon),brightness:t.brightness}:{values:"[]"}}},"wokwi-biaxial-stepper":{getProps:function(t){var e,i;return{outerHandAngle:null!==(e=null===t||void 0===t?void 0:t.angle1)&&void 0!==e?e:0,innerHandAngle:null!==(i=null===t||void 0===t?void 0:t.angle2)&&void 0!==i?i:0}}},"wokwi-relay-module":{getProps:function(t){return t||{}}}}},673:function(t,e,i){i.d(e,{F:function(){return zs},G:function(){return Hs}});var n=i(47568),r=i(51438),a=i(52951),s=i(14924),o=i(82670),u=i(26042),l=i(69396),c=i(10253),d=i(29815),h=i(20414),v=i(68949),f=i(67090),p=i(12672),g=i(80947),y={ili9341:function(t,e){for(var i=t.pixels,n=t.invert,r=t.bgr,a=e.data,s=e.width,o=e.height,u=0;u<o;u++)for(var l=0;l<s;l++){var c=i[u*s+l],d=n?~c:c,h=4*(u*e.width+l),v=(63488&d)>>8,f=(31&d)<<3;a[h+0]=r?v:f,a[h+1]=(2016&d)>>3,a[h+2]=r?f:v,a[h+3]=255}},ssd1306:function(t,e){for(var i=t.pixels,n=t.invert,r=t.displayOn,a=t.reverseRows,s=t.scrollOffset,o=t.startLine,u=e.data,l=e.width,c=e.height,d=0;d<c;d++)for(var h=0;h<l;h++){var v=d+s+o,f=(a?c-1-v:v)%c,p=i[Math.floor(f/8)*l+h]&1<<f%8?!n:n,g=4*(d*e.width+h);u.fill(p?255:0,g,g+3),u[g+3]=r?255:0}}};function m(t,e){t&&"object"===typeof t.pixels&&(0,o.Z)(t.pixels,Uint8Array)&&e.data.set(t.pixels)}function w(t){var e,i={},n=!0,r=!1,a=void 0;try{for(var s,o=(null!==(e=t.displays)&&void 0!==e?e:[])[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u,l=s.value;i[l.id]=null!==(u=y[l.chip])&&void 0!==u?u:m}}catch(c){r=!0,a=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return{applyUpdate:function(t,e){var n=e.canvases;if(n){var r=!0,a=!1,s=void 0;try{for(var o,u=Object.keys(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value,d=n[l],h=null===d||void 0===d?void 0:d.getContext("2d"),v=i[l];if(d&&h&&v){var f=h.getImageData(0,0,d.width,d.height);v(t[l],f),h.putImageData(f,0,0)}}}catch(c){a=!0,s=c}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}},simulationStopped:function(t){var e=t.canvases;if(e){var i=!0,n=!1,r=void 0;try{for(var a,s=Object.values(e)[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value,u=null===o||void 0===o?void 0:o.getContext("2d");o&&u&&u.clearRect(0,0,o.width,o.height)}}catch(c){n=!0,r=c}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},getProps:function(t){return t?{ledValues:t}:{}}}}var k=i(13291),Z=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;(0,r.Z)(this,t),(0,s.Z)(this,"_pixels",void 0),(0,s.Z)(this,"index",void 0),(0,s.Z)(this,"frame",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"zeroCounter",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"pixels",void 0),this.pins=e,this.pixels=i,this._pixels=new Uint32Array(this.pixels),this.index=0,this.frame=0,this.value=0,this.updated=!1,this.zeroCounter=0;var a=new k.g({clk:e.clock,mosi:e.data,ss:e.ss});a.onTransmit=function(t){if(t)n.zeroCounter=0;else if(n.zeroCounter++,n.zeroCounter>=4)return n.index=0,void(n.frame=0);if(n.frame||(t=t<<3&255|(1&t?7:0)),n.value=n.value<<8|t,3===n.frame){var e=n.index,i=n._pixels,r=n.value;e<i.length&&(i[e]=r,n.updated=!0),n.index++,n.frame=0}else n.frame++}}return(0,a.Z)(t,[{key:"update",value:function(){return this.updated?(this.updated=!1,this._pixels):null}},{key:"reset",value:function(){this._pixels.fill(0)}}]),t}(),b=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"apa102Decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.apa102Decoder=new Z({data:i.get("DI"),clock:i.get("CI")},1)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.apa102Decoder.update();if(t){var e=t[0],i=(e>>>24)/255,n=e>>16&255,r=e>>8&255,a=255&e;return{value:{r:Math.pow(a/256*i,.5),g:Math.pow(r/256*i,.5),b:Math.pow(n/256*i,.5)}}}return null}},{key:"reset",value:function(){this.apa102Decoder.reset()}}]),t}();(0,s.Z)(b,"pinNames",["DI","CI","VCC","GND","DO","CO"]);var C,_=i(8371),S=i(13918),x=i(35154),P=i(80450);!function(t){t[t.Idle=0]="Idle",t[t.SetWriteCount=1]="SetWriteCount",t[t.SetReadCount=2]="SetReadCount",t[t.Write=3]="Write",t[t.GetReadAvailable=4]="GetReadAvailable",t[t.GetReadLength=5]="GetReadLength",t[t.Read=6]="Read"}(C||(C={}));var I=function(){function t(e,i,n,a){var o=this;(0,r.Z)(this,t),(0,s.Z)(this,"rx",void 0),(0,s.Z)(this,"tx",void 0),(0,s.Z)(this,"i2c",void 0),(0,s.Z)(this,"rxBuf",void 0),(0,s.Z)(this,"rxBufIdx",void 0),(0,s.Z)(this,"txQueue",void 0),(0,s.Z)(this,"i2cMode",void 0),(0,s.Z)(this,"i2cState",void 0),(0,s.Z)(this,"i2cWriteCount",void 0),(0,s.Z)(this,"i2cReadCount",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"vars",void 0),this.clock=e,this.vars=a,this.rxBuf=new Uint8Array(1024),this.rxBufIdx=0,this.txQueue=[],this.i2cMode=!1,this.i2cState=C.Idle,this.i2cWriteCount=0,this.i2cReadCount=0,this.rx=new x.g(e,i.get("RX_P"),9600),this.tx=new P.x(e,i.get("TX_P"),9600),this.i2c=new S.A({scl:i.get("SCL_P"),sda:i.get("SDA_P")},23),this.rx.subscribe((function(t){o.i2cMode=!1;var e=!0,i=!1,n=void 0;try{for(var r,a=t[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;o.onRxByte(s)}}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}})),this.tx.onTxComplete=function(){var t=o.txQueue.shift();null!=t&&o.tx.transmit(t)},this.i2c.onConnect=function(t,e){return o.i2cMode=!0,e?(o.i2cState=C.SetWriteCount,o.i2cReadCount=0):o.i2cState=C.GetReadAvailable,!0},this.i2c.onWriteByte=function(t){switch(o.i2cState){case C.SetWriteCount:return o.i2cWriteCount=t,o.i2cState=t?C.Write:C.SetReadCount,!0;case C.SetReadCount:return o.i2cReadCount=t,o.i2cState=C.Idle,!0;case C.Write:return!!o.i2cWriteCount&&(o.onRxByte(t),o.i2cWriteCount--,!0);default:return!1}},this.i2c.onReadByte=function(){switch(o.i2cState){case C.GetReadAvailable:return o.i2cState=C.GetReadLength,(0,_.u)(o.txQueue.length-o.i2cReadCount,0,253);case C.GetReadLength:return o.i2cState=C.Read,o.i2cReadCount;case C.Read:var t;return o.i2cReadCount?(o.i2cReadCount--,null!==(t=o.txQueue.shift())&&void 0!==t?t:0):0;default:return 0}}}return(0,a.Z)(t,[{key:"onRxByte",value:function(t){if(10===t){if(!this.rxBufIdx)return;var e=(new TextDecoder).decode(this.rxBuf.subarray(0,this.rxBufIdx));this.processCommand(e),this.rxBufIdx=0}else this.rxBufIdx<this.rxBuf.length&&(this.rxBuf[this.rxBufIdx++]=t)}},{key:"sendResponse",value:function(t){var e,i,n=(new TextEncoder).encode(t);this.i2cMode||this.tx.isBusy?(e=this.txQueue).push.apply(e,(0,d.Z)(n)):(this.tx.transmit(n[0]),(i=this.txQueue).push.apply(i,(0,d.Z)(n.subarray(1))))}},{key:"processCommand",value:function(t){var e=this;return(0,n.Z)((function(){var i,n;return(0,h.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch("https://wokwi.com/api/external/blues?r=".concat(encodeURIComponent(t)))];case 1:return[4,r.sent().json()];case 2:return i=r.sent(),n="string"===typeof i?i:JSON.stringify(i),e.sendResponse(n+"\r\n"),[2]}}))}))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.rxBufIdx=0,this.txQueue.splice(0,this.txQueue.length)}}]),t}();(0,s.Z)(I,"pinNames",["VCC","GND","RX_P","TX_P","SCL_P","SDA_P"]);var D=i(1965),A=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e}return(0,a.Z)(t,[{key:"nanos",get:function(){return this.clock.cpuNanos}},{key:"schedule",value:function(t,e){return this.clock.addEvent(e,t),t}},{key:"unschedule",value:function(t){return this.clock.createEvent(t).unschedule(),!0}},{key:"skipToNextEvent",value:function(){}}]),t}(),R=i(28467),B=i(98561),T=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"esp32",void 0),(0,s.Z)(this,"next",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"pins",void 0),this.clock=e,this.pins=i,this.next=function(){var t=n.esp32.cores[0];t.idle&&!t.nextInterrupt||t.runInstruction(),n.clock.addEvent(100,n.next)}}return(0,a.Z)(t,[{key:"init",value:function(e){var r=e.wifi,a=this;return(0,n.Z)((function(){var e,n,s,o,u;return(0,h.__generator)(this,(function(l){switch(l.label){case 0:return e=i.e(2206).then(i.bind(i,92206)),t.snapshotPromise||(t.snapshotPromise=t.downloadAT()),[4,e];case 1:return n=l.sent().ESP32C3,s=new n({flashSizeMB:4,clock:new A(a.clock)}),o=a.loadSnapshot,u=[s],[4,t.snapshotPromise];case 2:return o.apply(a,u.concat(l.sent())),a.initUart(s),a.initWiFi(s,r),a.initNVS(s),a.esp32=s,a.clock.addEvent(100,a.next),[2]}}))}))()}},{key:"initUart",value:function(t){t.uart[0].onTX=function(){t.uart[0].txComplete()};var e=new P.x(this.clock,this.pins.get("U0TXD")),i=new x.g(this.clock,this.pins.get("U0RXD")),n=t.uart[1];e.baudRate=115200,i.baudRate=115200,n.onTX=function(t){e.transmit(t)},e.onTxComplete=function(){return n.txComplete()},i.subscribe((function(t){n.feedByte(t[0])}))}},{key:"initWiFi",value:function(t,e){var i=this,n=t.wifi;t.wifi.setMacAddress(new D.o("24:0a:c4:00:01:10").bytes),n.onTX=function(n){var r=t.wifi.channel;i.clock.addEvent(1e5,(function(){e.medium.transmit({channel:r,data:n})}))},e.medium.listen((function(t){n.sendFrame(t.data,(0,B.a)())}))}},{key:"initNVS",value:function(t){var e=65536;t.flash.fill(255,e,122880),t.flash.set([252,255,255,255,0,0,0,0,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,132,45,186,185,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,1,255,113,211,175,4,110,118,115,46,110,101,116,56,48,50,49,49,0,0,0,0,1,255,255,255,255,255,255,255,1,1,1,255,61,2,179,83,111,112,109,111,100,101,0,0,0,0,0,0,0,0,0,0,1],e)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}},{key:"loadSnapshot",value:function(t,e){var i=new R.B(e);if("WOKWI SNAPSHOT\r\n"!==i.readChars(16))throw new Error("Invalid data");var n=i.readUint32();if(n>=65536)throw new Error("Invalid data");var r=JSON.parse(i.readChars(n));if(1!==r.v)throw new Error("Invalid version");if(r.chip!==t.id)throw new Error("Incompatible MCU");for(;i.currentOffset<e.byteLength;){var a=i.readUint32(),s=i.readUint32(),o=i.readUint32();i.readUint32();var u=i.readChars(s),l=i.readBytes(o);switch(u){case"ROM":t.loadROM(l);break;case"FLASH":t.flash.set(l,a);break;case"SRAM":t.sram.data.set(l,a);break;case"IRAM":t.iramCache.data.set(l,a);break;case"MMU":t.mmuTableMemory.data.set(l);break;case"CORE":t.cores[a].restoreStateLegacy(new Uint32Array(new Uint8Array(l).buffer))}}}}],[{key:"downloadAT",value:function(){return(0,n.Z)((function(){var t,e;return(0,h.__generator)(this,(function(i){switch(i.label){case 0:return[4,fetch("https://wokwi.github.io/firmware-assets/esp-at/esp32-c3-at-2.3.0.0.wokwi")];case 1:return t=i.sent(),e=Uint8Array.bind,[4,t.arrayBuffer()];case 2:return[2,new(e.apply(Uint8Array,[void 0,i.sent()]))]}}))}))()}}]),t}();(0,s.Z)(T,"pinNames",["GND","U0TXD","GPIO2","CH_EN","GPIO0","RESET","U0RXD","VCC"]),(0,s.Z)(T,"snapshotPromise",void 0);var E=i(95315),U=i(70222),N=i(88409),O=[128,133,134,135,136,137,145,146,147,148,149,150,164,165,188],M=new WeakMap,L=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"registers",void 0),(0,s.Z)(this,"addr",void 0),(0,U.Z)(this,M,{writable:!0,value:void 0}),(0,s.Z)(this,"clock",void 0),this.clock=e,this.registers=new Uint8Array(256),this.addr=0,(0,N.Z)(this,M,!1);var a=new S.A({scl:i.get("SCL"),sda:i.get("SDA")},56);this.reset(),a.onConnect=function(){return(0,N.Z)(n,M,!0),!0},a.onReadByte=function(){var t=n.registers[n.addr];return n.addr=(n.addr+1)%256,t},a.onWriteByte=function(t){if((0,E.Z)(n,M))return n.addr=t,(0,N.Z)(n,M,!1),!0;var e=n.addr;return O.includes(e)&&(n.registers[e]=t),n.addr=(n.addr+1)%256,!0}}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=t.touches.slice(0,2);this.registers[2]=e.length;for(var i=0;i<e.length;i++){var n=e[i],r=i?6:0,a=n.x,s=n.y,o="press"===n.eventType?0:"release"===n.eventType?1:2;this.registers[r+3]=o<<6|a>>8,this.registers[r+4]=255&a,this.registers[r+5]=i<<4|s>>8,this.registers[r+6]=255&s,this.registers[r+7]=Math.floor(255*n.force),this.registers[r+8]=128}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.addr=0,this.registers.fill(0);for(var t=3;t<=14;t++)this.registers[t]=255;this.registers[128]=40,this.registers[134]=1,this.registers[135]=10,this.registers[136]=8,this.registers[137]=40,this.registers[145]=10,this.registers[146]=25,this.registers[147]=25,this.registers[148]=25,this.registers[149]=25,this.registers[150]=50,this.registers[163]=6,this.registers[164]=1,this.registers[165]=0,this.registers[166]=16,this.registers[168]=17,this.registers[175]=1,this.registers[188]=1}}]),t}();(0,s.Z)(L,"pinNames",["VCC","GND","SCL","SDA","INT"]);var V,F=(V={},(0,s.Z)(V,38,1),(0,s.Z)(V,54,1),(0,s.Z)(V,193,1),(0,s.Z)(V,180,1),(0,s.Z)(V,197,2),(0,s.Z)(V,199,1),(0,s.Z)(V,58,1),(0,s.Z)(V,242,1),(0,s.Z)(V,192,2),(0,s.Z)(V,194,2),(0,s.Z)(V,195,2),(0,s.Z)(V,196,2),(0,s.Z)(V,182,2),(0,s.Z)(V,177,3),(0,s.Z)(V,178,3),(0,s.Z)(V,42,4),(0,s.Z)(V,43,4),(0,s.Z)(V,179,6),(0,s.Z)(V,45,9),(0,s.Z)(V,224,15),(0,s.Z)(V,225,15),V),J=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"width",240),(0,s.Z)(this,"height",320),(0,s.Z)(this,"pixels",new Uint16Array(this.height*this.width)),(0,s.Z)(this,"displayOn",!1),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"invert",!1),(0,s.Z)(this,"bgr",!1),(0,s.Z)(this,"activeColumn",0),(0,s.Z)(this,"activePage",0),(0,s.Z)(this,"columnStart",0),(0,s.Z)(this,"columnEnd",0),(0,s.Z)(this,"pageStart",0),(0,s.Z)(this,"pageEnd",0),(0,s.Z)(this,"scanningDirection",0),(0,s.Z)(this,"highByte",!0),(0,s.Z)(this,"highByteValue",0),(0,s.Z)(this,"commandMode",!1),(0,s.Z)(this,"commandProcessed",!1),(0,s.Z)(this,"currentCommandIndex",0),(0,s.Z)(this,"currentCommandLength",0),(0,s.Z)(this,"currentCommand",new Uint8Array(64));var a=i.get("D/C");this.reset(),new k.g({mosi:i.get("MOSI"),miso:i.get("MISO"),clk:i.attached("SCK")?i.get("SCK"):i.get("CLK"),ss:i.get("CS")}).onTransmit=function(t){return a.value?n.processData(t):n.processCommand(t,!0),0}}return(0,a.Z)(t,[{key:"update",value:function(){if(this.updated){this.updated=!1;var t=this;return{value:{pixels:t.pixels,invert:t.invert,bgr:t.bgr}}}return null}},{key:"snapshot",value:function(){this.update()}},{key:"value",get:function(){return""}},{key:"reset",value:function(){this.displayOn=!1,this.activeColumn=0,this.activePage=0,this.columnStart=0,this.columnEnd=239,this.pageStart=0,this.pageEnd=319}},{key:"processCommand",value:function(t,e){if(e&&(this.currentCommandIndex&&!this.commandProcessed&&console.warn("Unknown ILI9341 Command",this.currentCommand[0].toString(16),this.currentCommand.slice(1,this.currentCommandIndex)),this.commandMode=!0,this.commandProcessed=!1,this.currentCommandIndex=0,this.currentCommandLength=1+(F[t]||0)),this.currentCommand[this.currentCommandIndex]=t,this.currentCommandIndex++,!(this.currentCommandIndex<this.currentCommandLength||this.commandProcessed)){var i=this.currentCommand[0];this.commandProcessed=!0;var n=!1;switch(i){case 0:case 192:case 1:case 58:case 197:break;case 16:case 40:this.displayOn=!1,n=!0;break;case 17:case 41:this.displayOn=!0,n=!0;break;case 32:this.invert=!1,n=!0;break;case 33:this.invert=!0,n=!0;break;case 44:this.commandMode=!1,this.highByte=!0;break;case 54:this.bgr=!!(8&this.currentCommand[1]),this.scanningDirection=252&this.currentCommand[1];break;case 42:case 43:var r=this.currentCommand[1]<<8|this.currentCommand[2],a=this.currentCommand[3]<<8|this.currentCommand[4],s=43===i;(32&this.scanningDirection?!s:s)?(this.activePage=r,this.pageStart=r,this.pageEnd=a):(this.activeColumn=r,this.columnStart=r,this.columnEnd=a);break;default:this.commandProcessed=!1}n&&this.displayOn&&(this.updated=!0)}}},{key:"processData",value:function(t){if(this.commandMode)this.processCommand(t,!1);else{if(this.highByte)return this.highByte=!1,void(this.highByteValue=t);var e=this.highByteValue<<8|t,i=this.activeColumn,n=this.activePage,r=!!(128&this.scanningDirection)!==!!(4&this.scanningDirection),a=!!(64&this.scanningDirection)===!!(4&this.scanningDirection);32&this.scanningDirection?(i=r?this.width-1-i:i,n=a?this.height-1-n:n):(i=a?this.width-1-i:i,n=r?this.height-1-n:n);var s=n*this.width+i;this.pixels[s]=e,32&this.scanningDirection?(this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart))):(this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart))),this.updated=!0,this.highByte=!0}}}]),t}();(0,s.Z)(J,"pinNames",["D/C","CS","SCK","MOSI","MISO"]);var W=function(){function t(e,i,n){var a,o=this;(0,r.Z)(this,t),(0,s.Z)(this,"frameNanos",void 0),(0,s.Z)(this,"subframeNanos",void 0),(0,s.Z)(this,"updateTime",void 0),(0,s.Z)(this,"lastState",void 0),(0,s.Z)(this,"subframe",void 0),(0,s.Z)(this,"subframes",void 0),(0,s.Z)(this,"subframesIndex",void 0),(0,s.Z)(this,"onTime",void 0),(0,s.Z)(this,"listener",void 0),(0,s.Z)(this,"gamma",void 0),(0,s.Z)(this,"prevValue",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updateTime=0,this.lastState=0,this.subframe=0,this.subframes=new Float64Array(8),this.subframesIndex=0,this.onTime=0,this.prevValue=null;var u,l=parseFloat(null!==(a=null===n||void 0===n?void 0:n.get("fps"))&&void 0!==a?a:""),c=l>.1?l:80;this.frameNanos=Math.floor(1e9/(c/8)),this.subframeNanos=Math.floor(this.frameNanos/8),this.subframe=Math.floor(e.cpuNanos/this.frameNanos);var d=parseFloat(null!==(u=null===n||void 0===n?void 0:n.get("gamma"))&&void 0!==u?u:"");this.gamma=d>.1?d:2.8;var h=i.get("A"),v=i.get("C");if(h&&v){this.listener=function(){var t=e.cpuNanos,i=o.subframes,n=o.updateTime,r=o.lastState,a=o.subframeNanos,s=Math.floor(t/a),u=s-o.subframe;if(u){if(u<i.length){r&&(o.onTime+=a-n%a);for(var l=o.onTime/a,c=0;c<u;c++)i[o.subframesIndex]=0==c?l:o.lastState,o.subframesIndex=(o.subframesIndex+1)%i.length}else i.fill(r?1:0);o.onTime=r?a-n%a:0}else r&&(o.onTime+=t-n);o.subframe=s,o.lastState=function(){var t=h.value?1:0,e=v.value?0:1;return h.driven&&v.driven?t*e:0}(),o.updateTime=e.cpuNanos},this.listener(),h.onStateChange(this.listener),v.onStateChange(this.listener)}}return(0,a.Z)(t,[{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this,i=e.updateTime,n=e.frameNanos,r=this.clock.cpuNanos-i,a=this.lastState;if(r<n){var s,o,u=this.subframes;null===(o=(s=this).listener)||void 0===o||o.call(s),a=u.reduce((function(t,e){return t+e}))/u.length}var l=Math.pow(a,1/this.gamma);if(this.prevValue!==l){var c={value:l};return this.prevValue=l,c}return t?{value:this.lastState}:null}},{key:"reset",value:function(){this.lastState=0}}]),t}();(0,s.Z)(W,"pinNames",["A","C"]);var H,K=(H={},(0,s.Z)(H,129,1),(0,s.Z)(H,38,6),(0,s.Z)(H,39,6),(0,s.Z)(H,41,5),(0,s.Z)(H,42,5),(0,s.Z)(H,163,2),(0,s.Z)(H,32,1),(0,s.Z)(H,33,2),(0,s.Z)(H,34,2),(0,s.Z)(H,168,1),(0,s.Z)(H,211,1),(0,s.Z)(H,218,1),(0,s.Z)(H,213,1),(0,s.Z)(H,217,1),(0,s.Z)(H,219,1),(0,s.Z)(H,141,1),H),q={0:5,1:64,2:128,3:256,4:3,5:4,6:25,7:2},G=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"width",void 0),(0,s.Z)(this,"height",void 0),(0,s.Z)(this,"pixels",void 0),(0,s.Z)(this,"displayOn",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"scrollActive",void 0),(0,s.Z)(this,"contrast",void 0),(0,s.Z)(this,"invert",void 0),(0,s.Z)(this,"reverseRows",void 0),(0,s.Z)(this,"segmentRemap",void 0),(0,s.Z)(this,"clockDivider",void 0),(0,s.Z)(this,"multiplexRatio",void 0),(0,s.Z)(this,"phase1",void 0),(0,s.Z)(this,"phase2",void 0),(0,s.Z)(this,"nextScrollTime",void 0),(0,s.Z)(this,"activeColumn",void 0),(0,s.Z)(this,"columnStart",void 0),(0,s.Z)(this,"columnEnd",void 0),(0,s.Z)(this,"activePage",void 0),(0,s.Z)(this,"pageStart",void 0),(0,s.Z)(this,"pageEnd",void 0),(0,s.Z)(this,"memoryMode",void 0),(0,s.Z)(this,"startLine",void 0),(0,s.Z)(this,"scrollRight",void 0),(0,s.Z)(this,"scrollVertical",void 0),(0,s.Z)(this,"scrollStartPage",void 0),(0,s.Z)(this,"scrollEndPage",void 0),(0,s.Z)(this,"scrollSpeed",void 0),(0,s.Z)(this,"verticalOffset",void 0),(0,s.Z)(this,"scrollOffset",void 0),(0,s.Z)(this,"controlByte",void 0),(0,s.Z)(this,"continuousMode",void 0),(0,s.Z)(this,"commandMode",void 0),(0,s.Z)(this,"currentCommandIndex",void 0),(0,s.Z)(this,"currentCommandLength",void 0),(0,s.Z)(this,"currentCommand",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.width=128,this.height=64,this.pixels=new Uint8Array(this.width*this.height/8),this.displayOn=!1,this.updated=!1,this.scrollActive=!1,this.contrast=0,this.invert=!1,this.reverseRows=!1,this.segmentRemap=!1,this.clockDivider=0,this.multiplexRatio=0,this.phase1=0,this.phase2=0,this.nextScrollTime=0,this.activeColumn=0,this.columnStart=0,this.columnEnd=0,this.activePage=0,this.pageStart=0,this.pageEnd=0,this.memoryMode=0,this.startLine=0,this.scrollRight=!1,this.scrollVertical=!1,this.scrollStartPage=0,this.scrollEndPage=0,this.scrollSpeed=0,this.verticalOffset=0,this.scrollOffset=0,this.controlByte=!0,this.continuousMode=!0,this.commandMode=!1,this.currentCommandIndex=0,this.currentCommandLength=0,this.currentCommand=new Uint8Array(8);var a=60|(i.attached("SA0")&&i.get("SA0").value?1:0),o=parseInt(n.get("ssd1306-address")||n.get("i2c-address")||"0",16)||a;new S.A({scl:i.attached("SCL")?i.get("SCL"):i.get("CLK"),sda:i.attached("SDA")?i.get("SDA"):i.get("DATA")},o).setHandler(this),this.reset(),this.snapshot()}return(0,a.Z)(t,[{key:"update",value:function(){if(this.scrollActive&&this.clock.cpuMillis>this.nextScrollTime&&(this.scroll(),this.calculateNextScroll()),this.updated){this.updated=!1;var t=this;return{value:{pixels:t.pixels,invert:t.invert,displayOn:t.displayOn,reverseRows:t.reverseRows,contrast:t.contrast,scrollOffset:t.scrollOffset,startLine:t.startLine}}}return null}},{key:"toImageData",value:function(t){for(var e=this,i=e.pixels,n=e.invert,r=e.displayOn,a=e.reverseRows,s=e.scrollOffset,o=e.width,u=e.height,l=t.data,c=0;c<u;c++)for(var d=0;d<o;d++){var h=c+s,v=(a?u-1-h:h)%u,f=i[Math.floor(v/8)*o+d]&1<<v%8?!n:n,p=4*(c*t.width+d);l.fill(f?255:0,p,p+3),l[p+3]=r?255:0}}},{key:"snapshot",value:function(){this.update()}},{key:"value",get:function(){return""}},{key:"reset",value:function(){this.memoryMode=2,this.contrast=127,this.clockDivider=1,this.multiplexRatio=63,this.phase1=2,this.phase2=2,this.scrollActive=!1,this.currentCommandIndex=0,this.activeColumn=0,this.columnStart=0,this.columnEnd=127,this.activePage=0,this.pageStart=0,this.pageEnd=7,this.startLine=0,this.invert=!1}},{key:"i2cConnect",value:function(){return this.controlByte=!0,!0}},{key:"i2cReadByte",value:function(){return 255}},{key:"i2cWriteByte",value:function(t){return this.controlByte?(this.commandMode=!(64&t),this.continuousMode=!(128&t),this.controlByte=!1):(this.commandMode?this.processCommand(t):this.processData(t),this.continuousMode||(this.controlByte=!0)),!0}},{key:"processCommand",value:function(t){if(this.currentCommand[this.currentCommandIndex]=t,this.currentCommandIndex||(this.currentCommandLength=1+(K[t]||0)),this.currentCommandIndex++,!(this.currentCommandIndex<this.currentCommandLength)){var e=this.currentCommand[0],i=!1;switch(e){case 129:this.contrast=this.currentCommand[1],i=!0;break;case 174:this.displayOn=!1,this.updated=!0;break;case 175:this.displayOn=!0,this.updated=!0;break;case 166:this.invert=!1,i=!0;break;case 167:this.invert=!0,i=!0;break;case 227:case 141:case 211:case 168:case 218:case 219:case 163:case 165:case 164:break;case 32:this.memoryMode=3&this.currentCommand[1];break;case 33:this.columnStart=127&this.currentCommand[1],this.columnEnd=127&this.currentCommand[2],this.activeColumn=this.columnStart;break;case 34:this.pageStart=7&this.currentCommand[1],this.pageEnd=7&this.currentCommand[2],this.activePage=this.pageStart;break;case 46:this.scrollOffset=0,this.scrollActive=!1;break;case 47:this.scrollActive=!0,this.calculateNextScroll();break;case 38:case 39:this.scrollVertical=!1,this.scrollRight=38===e,this.scrollStartPage=7&this.currentCommand[2],this.scrollSpeed=7&this.currentCommand[3],this.scrollEndPage=7&this.currentCommand[4];break;case 41:case 42:this.scrollRight=41===e,this.scrollStartPage=7&this.currentCommand[2],this.scrollSpeed=7&this.currentCommand[3],this.scrollEndPage=7&this.currentCommand[4],this.verticalOffset=63&this.currentCommand[5],this.scrollVertical=this.verticalOffset>0;break;case 213:this.clockDivider=1+(15&this.currentCommand[1]);break;case 217:this.phase1=15&this.currentCommand[1],this.phase2=this.currentCommand[1]>>4&15;break;case 192:this.reverseRows=!0,i=!0;break;case 200:this.reverseRows=!1,i=!0;break;case 160:this.segmentRemap=!1;break;case 161:this.segmentRemap=!0;break;default:if(e<=15){this.activeColumn=240&this.activeColumn|e;break}if(e>=16&&e<=31){this.activeColumn=15&this.activeColumn|(15&e)<<4;break}if(e>=64&&e<=127){this.startLine=63&e,i=!0;break}if(e>=176&&e<=183){this.activePage=7&e;break}console.warn("Unknown SSD1306 Command",e.toString(16),this.currentCommand.slice(1,this.currentCommandIndex))}i&&this.displayOn&&(this.updated=!0),this.currentCommandIndex=0}}},{key:"processData",value:function(t){var e=this.segmentRemap?this.activeColumn:this.width-1-this.activeColumn,i=this.activePage*this.width+e;switch(this.pixels[i]=t,this.memoryMode){case 0:this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart));break;case 1:this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart));break;default:this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart)}this.updated=!0}},{key:"i2cDisconnect",value:function(){}},{key:"scroll",value:function(){for(var t=this.width,e=this.scrollStartPage;e<=this.scrollEndPage;e++){var i=e*t;if(this.scrollRight){var n=this.pixels[i+t-1];this.pixels.set(this.pixels.slice(i,i+t-1),i+1),this.pixels[i]=n}else{var r=this.pixels[i];this.pixels.set(this.pixels.slice(i+1,i+t),i),this.pixels[i+t-1]=r}this.updated=!0}this.scrollVertical&&(this.scrollOffset=(this.scrollOffset+this.verticalOffset)%this.height)}},{key:"scrollFrameTime",get:function(){return 1e3*q[this.scrollSpeed]/this.frameFrequency}},{key:"calculateNextScroll",value:function(){this.nextScrollTime=this.clock.cpuMillis+this.scrollFrameTime}},{key:"frameFrequency",get:function(){var t=this.phase1+this.phase2+50;return 37e4/(this.clockDivider*t*(1+this.multiplexRatio))}}]),t}();function z(t,e,i){var n=e(t),r=function(){var r=e(t);r!==n&&(n=r,i(r))},a=!0,s=!1,o=void 0;try{for(var u,l=t[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.onValueChange(r)}}catch(c){s=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}i(n)}(0,s.Z)(G,"pinNames",["CLK","DATA","SCL","SDA","SA1"]);var X=i(37405),j=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.get("IN"),a=i.get("UIO");a.onValueChange((function(t){n.setState(t?X.J.High:X.J.Low)})),z([i.get("OUT"),i.get("OE")],(function(t){var e=(0,c.Z)(t,2),i=e[0];return e[1].value?i.value?X.J.High:X.J.Low:X.J.HighZ}),(function(t){a.setState(t)}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(j,"pinNames",["IN","OUT","OE","UIO"]);var Q=["CLK","RST_N","IN0","IN1","IN2","IN3","IN4","IN5","IN6","IN7"],$=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=!0,a=!1,o=void 0;try{for(var u,l=function(){var t=u.value,e=i.get(t),n=i.get("EXT".concat(t));n.setState(X.J.PullDown),e.setState(n.value?X.J.High:X.J.Low),n.onValueChange((function(t){e.setState(t?X.J.High:X.J.Low)}))},c=Q[Symbol.iterator]();!(n=(u=c.next()).done);n=!0)l()}catch(d){a=!0,o=d}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)($,"pinNames",(0,d.Z)(Q).concat((0,d.Z)(Q.map((function(t){return"EXT".concat(t)})))));var Y=["OUT0","OUT1","OUT2","OUT3","OUT4","OUT5","OUT6","OUT7"],tt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=!0,a=!1,o=void 0;try{for(var u,l=function(){var t=u.value,e=i.get(t),n=i.get("EXT".concat(t));n.setState(e.value?X.J.High:X.J.Low),e.onValueChange((function(t){n.setState(t?X.J.High:X.J.Low)}))},c=Y[Symbol.iterator]();!(n=(u=c.next()).done);n=!0)l()}catch(d){a=!0,o=d}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(tt,"pinNames",(0,d.Z)(Y).concat((0,d.Z)(Y.map((function(t){return"EXT".concat(t)})))));var et=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"_pixels",void 0),(0,s.Z)(this,"pixelIndex",void 0),(0,s.Z)(this,"currentValue",void 0),(0,s.Z)(this,"bitIndex",void 0),(0,s.Z)(this,"lastState",void 0),(0,s.Z)(this,"lastTimestamp",void 0),(0,s.Z)(this,"detectZero",void 0),(0,s.Z)(this,"detectOne",void 0),(0,s.Z)(this,"overflow",void 0),(0,s.Z)(this,"pendingUpdate",void 0),(0,s.Z)(this,"lastUpdated",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"listeners",void 0),(0,s.Z)(this,"clock",void 0),this.clock=i,this._pixels=new Uint32Array(1),this.pixelIndex=0,this.currentValue=0,this.bitIndex=0,this.lastState=!1,this.lastTimestamp=0,this.detectZero=!1,this.detectOne=!1,this.overflow=!1,this.pendingUpdate=!1,this.lastUpdated=0,this.updated=!1,this.listeners=new Set,e.onValueChange((function(t){var e=i.cpuNanos-a.lastTimestamp;!a.overflow&&a.lastState&&(e>=170&&e<=630&&(a.detectZero=!0),e>=570&&e<=1030&&(a.detectOne=!0),a.checkLastBit()),a.lastState||(a.detectZero&&e>=620?a.feedBit(0):a.detectOne&&e>=220&&a.feedBit(1),e>=5e4&&a.resetState(),a.detectZero=!1,a.detectOne=!1),a.overflow&&n&&n.setState(t?X.J.High:X.J.Low),a.lastState=t,a.lastTimestamp=i.cpuNanos}))}return(0,a.Z)(t,[{key:"checkLastBit",value:function(){23===this.bitIndex&&(this._pixels[this.pixelIndex]=this.currentValue|(this.detectOne?1:0),this.pendingUpdate=!0)}},{key:"feedBit",value:function(t){if(t&&(this.currentValue|=1<<23-this.bitIndex),this.bitIndex++,24===this.bitIndex&&(this._pixels[this.pixelIndex++]=this.currentValue,this.pendingUpdate=!0,this.bitIndex=0,this.currentValue=0),this.pixelIndex>=this.pixels.length){this.overflow=!0;var e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(this._pixels)}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}},{key:"resetState",value:function(){this.detectZero=!1,this.detectOne=!1,this.overflow=!1,this.bitIndex=0,this.currentValue=0,this.pixelIndex=0}},{key:"reset",value:function(){this.resetState(),this.pendingUpdate=!1,this.lastUpdated=0,this.updated=!1}},{key:"update",value:function(){if(this.lastUpdated<this.clock.cpuNanos&&(this.lastUpdated=this.clock.cpuNanos,this.updated=this.pendingUpdate,this.pendingUpdate)){var t=this.clock.cpuNanos-this.lastTimestamp;!this.overflow&&23===this.bitIndex&&this.detectZero&&!this.lastState&&t>=620&&(this._pixels[this.pixelIndex]=this.currentValue),this.pendingUpdate=!1}return this.updated?this._pixels:null}},{key:"resize",value:function(t){if(this._pixels.length<t){var e=new Uint32Array(t);e.set(this._pixels),this._pixels=e}}},{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"pixels",get:function(){return this._pixels}}]),t}(),it=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.attached("DO")?i.get("DO"):void 0;this.decoder=new et(i.get("DI"),e,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.decoder.update();if(t){var e=t[0],i=(255&e)/255,n=(e>>8&255)/255,r=(e>>16&255)/255;return{value:{r:Math.pow(n,.5),g:Math.pow(r,.5),b:Math.pow(i,.5)}}}return null}},{key:"reset",value:function(){this.decoder.reset()}}]),t}();(0,s.Z)(it,"pinNames",["DI","VCC","DO"]);var nt={"0603":W,apa102:b,ws2812:it},rt={ssd1306:G,ili9341:J},at={ft6206:L};function st(t,e){var i,o=function(t,i){var n=new Map,r=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value,d=l.name,h=l.target,v=(0,c.Z)(h.split(":"),2),f=v[0],p=v[1];f===i&&p&&n.set(p,d)}}catch(g){a=!0,s=g}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}return{get:function(e){var r;return t.get(null!==(r=n.get(e))&&void 0!==r?r:"".concat(i,":").concat(e))},attached:function(e){var i=n.get(e);return!!i&&t.attached(i)}}};return i=function(){function e(i,n,a,u,l){(0,r.Z)(this,e),(0,s.Z)(this,"controllers",void 0),(0,s.Z)(this,"values",void 0),(0,s.Z)(this,"clock",void 0),this.clock=i,this.controllers=[],this.values={};var c,d,h=new Map,v=!0,f=!1,p=void 0;try{for(var g,y=this,m=function(){var t=g.value,e={get:function(e){var i;return n.get(null!==(i=t.pins[e])&&void 0!==i?i:"".concat(t.id,":").concat(e))},attached:function(e){var i=t.pins[e];return!!i&&n.attached(i)}},i=nt[t.type];if(!i)return"continue";y.controllers.push({id:t.id,controller:new i(y.clock,e,h,u,l)})},w=(null!==(c=t.leds)&&void 0!==c?c:[])[Symbol.iterator]();!(v=(g=w.next()).done);v=!0)m()}catch(q){f=!0,p=q}finally{try{v||null==w.return||w.return()}finally{if(f)throw p}}var k,Z=!0,b=!1,C=void 0;try{for(var _,S=(null!==(d=t.chips)&&void 0!==d?d:[])[Symbol.iterator]();!(Z=(_=S.next()).done);Z=!0){var x=_.value;switch(x.type){case"tinytapeout-input":var P=o(n,x.id);this.controllers.push({id:x.id,controller:new $(this.clock,P)});break;case"tinytapeout-output":var D=o(n,x.id);this.controllers.push({id:x.id,controller:new tt(this.clock,D)});break;case"tinytapeout-bidirectional-io":var A=o(n,x.id);this.controllers.push({id:x.id,controller:new j(this.clock,A)});break;case"blues-notecard":var R=o(n,x.id);this.controllers.push({id:x.id,controller:new I(this.clock,R,h,u)});break;case"esp-01":var B=o(n,x.id);this.controllers.push({id:x.id,controller:new T(this.clock,B)})}if(x.type.startsWith("github:")){var E=o(n,x.id),U=l[x.type];U&&this.controllers.push({id:x.id,controller:new U(this.clock,E,h,u,l)})}}}catch(q){b=!0,C=q}finally{try{Z||null==S.return||S.return()}finally{if(b)throw C}}var N=!0,O=!1,M=void 0;try{for(var L,V=(null!==(k=t.displays)&&void 0!==k?k:[])[Symbol.iterator]();!(N=(L=V.next()).done);N=!0){var F=L.value,J=rt[F.chip];if(J){var W=new J(i,o(n,F.id),a,u,l);if(this.controllers.push({id:F.id,controller:W}),F.touch){var H=at[F.touch.chip];if(!H)continue;var K=new H(i,o(n,F.touch.id),h,u,l);this.controllers.push({id:F.touch.id,controller:K})}}}}catch(q){O=!0,M=q}finally{try{N||null==V.return||V.return()}finally{if(O)throw M}}}return(0,a.Z)(e,[{key:"onEvent",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s,o=r.value,u=o.id,l=o.controller;if(u===t.id)null===(s=l.onEvent)||void 0===s||s.call(l,t)}}catch(c){i=!0,n=c}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"init",value:function(t){var e=this;return(0,n.Z)((function(){return(0,h.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all(e.controllers.map((function(e){var i,n=e.controller;return null===(i=n.init)||void 0===i?void 0:i.call(n,t)})))];case 1:return i.sent(),[2]}}))}))()}},{key:"update",value:function(){var t=!1,e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value,o=s.id,u=s.controller.update();u&&(this.values[o]=u.value,t=!0)}}catch(l){i=!0,n=l}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}return t?{value:this.values}:null}},{key:"reset",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.controller.reset(t)}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}]),e}(),(0,s.Z)(i,"pinNames",Object.keys(t.pins)),i}function ot(t){switch(t){case"esp32":case"esp32-c3":case"esp32-c6":case"esp32-s2":case"esp32-s3":case"rp2040":case"stm32f103c8":case"stm32l432kc":return t;default:return"avr"}}var ut={"esp32-s2":{intentctf:{firmware:"https://urish.github.io/intent-ctf-firmware/intent-ctf-$VERSION.bin",defaultVersion:"1.0.0"}}};function lt(t){return"GND"===t?g.bq:t.startsWith("power(")?{type:"power",voltage:parseFloat(t.split(/[()]/)[1])}:t}function ct(t,e,i){var n=(0,p.Qc)(e),r=[],a=!0,s=!1,l=void 0;try{for(var d,h=Object.entries(n.pins)[Symbol.iterator]();!(a=(d=h.next()).done);a=!0){var v=(0,c.Z)(d.value,2),f=v[0],y=v[1].target;if("string"===typeof y)r.push({name:f,target:y});else if((0,o.Z)(y,Array))for(var m=0;m<y.length;m++)r.push({name:f,target:y[m]})}}catch(_){s=!0,l=_}finally{try{a||null==h.return||h.return()}finally{if(s)throw l}}if(n.mcu){var k,Z,b=null!==(k=ut[n.mcu])&&void 0!==k?k:{};g.tj[t]={name:n.name,mcuType:ot(n.mcu),hexiBoard:function(t){var e,i,r;return null!==(r=null===(e=n.environments)||void 0===e||null===(i=e[t])||void 0===i?void 0:i.fqbn)&&void 0!==r?r:n.fqbn},pins:r.map((function(t){return{name:t.name,target:lt(t.target)}})),environments:(0,u.Z)({},b,null!==(Z=n.environments)&&void 0!==Z?Z:{})},g.dH.push(t)}var C=i.startsWith("https://")?i:URL.createObjectURL(new Blob([i],{type:"image/svg+xml"}));return{board:n,svgURL:C,adapter:w(n),controller:st(n,r)}}var dt=i(52736),ht={0:16,1:8,2:4,3:2,4:1,5:1,6:1,7:1},vt=[[1,1,0],[-1,1,1],[-1,-1,0],[1,-1,1]],ft=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"stepIndex",void 0),(0,s.Z)(this,"microsteps",void 0),(0,s.Z)(this,"enable",void 0),(0,s.Z)(this,"amValue",void 0),(0,s.Z)(this,"apValue",void 0),(0,s.Z)(this,"bmValue",void 0),(0,s.Z)(this,"bpValue",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.stepIndex=8,this.microsteps=16,this.enable=!1,this.amValue=X.J.Low,this.apValue=X.J.Low,this.bmValue=X.J.Low,this.bpValue=X.J.Low;var a=i.get("1A"),o=i.get("1B"),u=i.get("2B"),l=i.get("2A"),d=i.get("MS1"),h=i.get("MS2"),v=i.get("MS3"),f=i.get("STEP"),p=i.get("DIR"),g=i.get("RESET"),y=i.get("SLEEP"),m=i.get("ENABLE");d.state=X.J.PullDown,h.state=X.J.PullDown,v.state=X.J.PullDown,y.state=X.J.PullUp,m.state=X.J.PullDown;var w=function(){o.state=n.enable?n.amValue:X.J.HighZ,a.state=n.enable?n.apValue:X.J.HighZ,l.state=n.enable?n.bmValue:X.J.HighZ,u.state=n.enable?n.bpValue:X.J.HighZ},k=function(){var t=15&n.stepIndex,e=(0,c.Z)(vt[n.stepIndex>>4&3],3),i=e[0],r=e[1],a=e[2],s=a?t>3:t<12,o=a?t<12:t>3;n.apValue=i>=0?X.J.High:X.J.Low,n.amValue=s?i>=0?X.J.Low:X.J.High:n.apValue,n.bpValue=r>=0?X.J.High:X.J.Low,n.bmValue=o?r>=0?X.J.Low:X.J.High:n.bpValue};f.onValueChange((function(t){if(t){var e=p.value;n.stepIndex=(n.stepIndex+(e?n.microsteps:-n.microsteps)+64)%64,k(),w()}})),k(),z([g,y],(function(){return!g.value||!y.value}),(function(t){t&&n.home()})),z([g,y,m],(function(){return y.value&&g.value&&!m.value}),(function(t){n.enable=t,w()})),z([d,h,v],(function(){return(v.value?4:0)|(h.value?2:0)|(d.value?1:0)}),(function(t){n.microsteps=ht[t]}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"home",value:function(){this.stepIndex=8}},{key:"reset",value:function(){this.home()}}]),t}();(0,s.Z)(ft,"pinNames",["ENABLE","MS1","MS2","MS3","RESET","SLEEP","STEP","DIR","GND","VDD","1B","1A","2A","2B","GND","VMOT"]);var pt=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,r.Z)(this,t),(0,s.Z)(this,"connectedValue",void 0),(0,s.Z)(this,"pin1",void 0),(0,s.Z)(this,"pin2",void 0),this.pin1=e,this.pin2=i,this.connectedValue=!1,this.connectedValue=n}return(0,a.Z)(t,[{key:"connected",get:function(){return this.connectedValue},set:function(t){if(this.connectedValue!==t){var e=this.pin1,i=this.pin2;this.connectedValue=t,t?(e.node.bridges.add(i),i.node.bridges.add(e),e.node.updateBridges()):(e.node.bridges.delete(i),i.node.bridges.delete(e),e.node.updateBridges(),i.node.updateBridges())}}}]),t}(),gt=new WeakMap,yt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"state",void 0),(0,U.Z)(this,gt,{writable:!0,value:void 0}),(0,s.Z)(this,"toggle",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"bridge",void 0),this.clock=e,this.bridge=i,this.state=!1,(0,N.Z)(this,gt,0),this.toggle=function(){n.bridge.connected=!n.bridge.connected}}return(0,a.Z)(t,[{key:"connected",get:function(){return this.state},set:function(t){if(t!==this.state)if(this.state=t,0!==this.clock.cpuNanos){for(var e=1+2*Math.floor(100*Math.random()),i=44e5/e,n=0,r=0;r<e;r++)n+=66+Math.round(Math.random()*(i-66)),this.clock.addEvent(n,this.toggle);(0,N.Z)(this,gt,n+66)}else this.bridge.connected=t}},{key:"bounceDuration",get:function(){return(0,E.Z)(this,gt)}}]),t}();function mt(t,e,i,n){var r=new pt(e,i);return n?new yt(t,r):r}var wt=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"bridge",void 0),(0,s.Z)(this,"horz",void 0),(0,s.Z)(this,"vert",void 0);var a=i.get("SEL"),o=i.get("GND"),u="0"!==n.get("bounce");this.vert=i.get("VERT"),this.horz=i.get("HORZ"),this.bridge=mt(e,a,o,u)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this.bridge;switch(t.type){case"press":e&&(e.connected=!0);break;case"release":e&&(e.connected=!1);break;case"change":this.horz.node.analogPort.writeNormalized(.5+t.x/2),this.vert.node.analogPort.writeNormalized(.5+t.y/2)}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(wt,"pinNames",["VCC","VERT","HORZ","SEL","GND"]);var kt=i(14116),Zt=function(){function t(e,i,n){var a;(0,r.Z)(this,t),(0,s.Z)(this,"apa102Decoder",void 0),(0,s.Z)(this,"rows",void 0),(0,s.Z)(this,"cols",void 0),(0,s.Z)(this,"layout",void 0),(0,s.Z)(this,"brightness",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.rows=parseInt(n.get("rows")||"8",10)||8,this.cols=parseInt(n.get("cols")||"8",10)||8,this.layout=n.get("matrixLayout")||"";var o=parseFloat(null!==(a=n.get("matrixBrightness"))&&void 0!==a?a:"1");this.brightness=o>=.01?o:1;var u=this.rows*this.cols;this.apa102Decoder=new Z({data:i.get("DI"),clock:i.get("CI")},u)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.apa102Decoder.update();return t?{value:{pixels:t.slice(0,this.rows*this.cols),rows:this.rows,cols:this.cols,brightness:this.brightness,layout:this.layout,colorFormat:kt.q.RGBA}}:null}},{key:"reset",value:function(){this.apa102Decoder.reset()}}]),t}();(0,s.Z)(Zt,"pinNames",["DI","CI","VCC","GND","DO","CO"]);var bt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"led13Controller",void 0),(0,s.Z)(this,"rxController",void 0),(0,s.Z)(this,"txController",void 0),(0,s.Z)(this,"resetBridge",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={ledPower:1,ledRX:0,ledTX:0,led13:0};var n=new Map;n.set("A",i.get("13")),n.set("C",i.get("GND")),this.led13Controller=new W(this.clock,n);var a=new Map;a.set("A",i.get("5V")),a.set("C",i.get("0")),this.rxController=new W(this.clock,a);var o=new Map;o.set("A",i.get("5V")),o.set("C",i.get("1")),this.txController=new W(this.clock,o),this.resetBridge=mt(e,i.get("GND"),i.get("RESET"),!1)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){switch(t.type){case"reset-press":this.resetBridge.connected=!0;break;case"reset-release":this.resetBridge.connected=!1}}},{key:"update",value:function(){var t=this.led13Controller.update();t&&(this.value.led13=t.value,this.updated=!0);var e=this.txController.update();e&&(this.value.ledTX=e.value,this.updated=!0);var i=this.rxController.update();i&&(this.value.ledRX=i.value,this.updated=!0);var n=this.updated?{value:(0,u.Z)({},this.value)}:null;return this.updated=!1,n}},{key:"reset",value:function(t){this.led13Controller.reset(),this.txController.reset(),this.rxController.reset(),this.value.led13=0,this.value.ledRX=0,this.value.ledTX=0,t&&(this.value.ledPower=0),this.updated=!0}}]),t}();(0,s.Z)(bt,"pinNames",["0","1","13","GND","5V","RESET"]);var Ct=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"pinMap",void 0),this.pins=e,this.pinMap=i}return(0,a.Z)(t,[{key:"get",value:function(t){var e;return this.pins.get(null!==(e=this.pinMap[t])&&void 0!==e?e:t)}},{key:"attached",value:function(t){var e;return this.pins.attached(null!==(e=this.pinMap[t])&&void 0!==e?e:t)}}]),t}(),_t=49152,St=Math.round(60000.00000000001);function xt(t,e){var i=t<e?t:e,n=t>e?t:e,r=i+65536-n<n-i;return Math.round(r?(i+65536+n)/2:(i+n)/2)}function Pt(t){return!isNaN(t)&&t>1e-9}var It=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"display",void 0),(0,s.Z)(this,"gearRatio",void 0),(0,s.Z)(this,"steps",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"toffset",void 0),(0,s.Z)(this,"nextDelta",void 0),(0,s.Z)(this,"changeTime",void 0),(0,s.Z)(this,"event",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.display="none",this.gearRatio=1,this.steps=0,this.updated=!0,this.toffset=xt(0,_t),this.nextDelta=0,this.changeTime=-1,this.event=this.clock.createEvent((function(){return a.finishStep()}));for(var o,u=i.get("A-"),l=i.get("A+"),c=i.get("B-"),d=i.get("B+"),h=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=u.driven&&l.driven&&u.value!==l.value,n=c.driven&&d.driven&&c.value!==d.value,r=l.value?0:32768,s=d.value?16384:_t,o=i&&n?xt(r,s):i?r:s;if(a.finishStep(),i||n){var h=a.toffset,v=o-h&65535,f=h-o&65535,p=v<f?v:-f;t?a.toffset=o:(a.nextDelta=p,a.changeTime=e.cpuNanos,a.event.schedule(St))}},v=0,f=[u,l,c,d];v<f.length;v++){f[v].onStateChange(h)}h(!0);var p,g=null!==(o=n.get("display"))&&void 0!==o?o:"";switch(g){case"angle":this.display=g;break;case"steps":case"":this.display="steps";break;default:this.display="none"}var y=null!==(p=n.get("gearRatio"))&&void 0!==p?p:"";if(y.includes(":")){var m=y.split(":").map((function(t){return parseFloat(t)}));Pt(m[0])&&Pt(m[1])&&(this.gearRatio=m[1]/m[0])}else{var w=parseFloat(y);Pt(w)&&(this.gearRatio=w)}}return(0,a.Z)(t,[{key:"finishStep",value:function(){var t=this.nextDelta,e=this.changeTime;if(t){var i=this.clock.cpuNanos-e,n=Math.round(t*Math.min(i/St,1));this.steps+=n/16384,this.toffset=this.toffset+n&65535,this.updated=!0,this.nextDelta-=n}}},{key:"update",value:function(){if(this.finishStep(),this.updated){var t=this.steps,e=t*this.gearRatio;return this.updated=!1,{value:{steps:t,angle:e/200*360%360,display:this.display}}}return null}},{key:"reset",value:function(){this.updated=!0}}]),t}();(0,s.Z)(It,"pinNames",["A-","A+","B-","B+"]);var Dt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"stepper1",void 0),(0,s.Z)(this,"stepper2",void 0),(0,s.Z)(this,"value",{angle1:0,angle2:0});var n=new Ct(i,{"A-":"A1-","A+":"A1+","B-":"B1-","B+":"B1+"});this.stepper1=new It(e,n,new Map);var a=new Ct(i,{"A-":"A2-","A+":"A2+","B-":"B2-","B+":"B2+"});this.stepper2=new It(e,a,new Map)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.stepper1.update(),e=this.stepper2.update();return t&&(this.value.angle1=t.value.angle),e&&(this.value.angle2=null===e||void 0===e?void 0:e.value.angle),t||e?{value:this.value}:null}},{key:"reset",value:function(){this.stepper1.reset(),this.stepper2.reset()}}]),t}();(0,s.Z)(Dt,"pinNames",["A1-","A1+","B1-","B1+","A2-","A2+","B2-","B2+"]);var At=function(){function t(e){var i=e.pin1,n=e.pin2,a=e.volume,o=e.clock,u=this;(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"context",new AudioContext),(0,s.Z)(this,"gainNode",this.context.createGain()),(0,s.Z)(this,"chunkBuffer",new AudioBuffer({length:this.context.sampleRate/10,numberOfChannels:1,sampleRate:this.context.sampleRate})),(0,s.Z)(this,"chunk",this.chunkBuffer.getChannelData(0)),(0,s.Z)(this,"node",null),(0,s.Z)(this,"prevValue",0),(0,s.Z)(this,"playedSamples",0),(0,s.Z)(this,"lastSample",0),(0,s.Z)(this,"active",!1),(0,s.Z)(this,"lastValue",!1),(0,s.Z)(this,"value",null),this.clock=o,this.gainNode.connect(this.context.destination),a>.01&&this.setVolume(a),this.prevValue=(null===i||void 0===i?void 0:i.value)!==!!(null===n||void 0===n?void 0:n.value)?1:0,null===i||void 0===i||i.onValueChange((function(){u.feed(i.value!==!!(null===n||void 0===n?void 0:n.value)?1:0)})),null===n||void 0===n||n.onValueChange((function(){u.feed(!!(null===i||void 0===i?void 0:i.value)!==n.value?1:0)}))}return(0,a.Z)(t,[{key:"setVolume",value:function(t){this.gainNode.gain.value=t}},{key:"feed",value:function(t){if(this.prevValue!==t){var e=this.clock.cpuNanos/1e9,i=this.context.sampleRate,n=Math.floor(e*i)-this.playedSamples;n-this.lastSample>i/20?(this.lastSample=n,n=0):this.lastSample=n,n>this.chunk.length&&(this.playedSamples+=this.chunk.length,this.node=new AudioBufferSourceNode(this.context,{buffer:this.chunkBuffer}),this.node.connect(this.gainNode),this.node.start(),n%=this.chunk.length,this.chunkBuffer=new AudioBuffer({length:i/10,numberOfChannels:1,sampleRate:i}),this.chunk=this.chunkBuffer.getChannelData(0),this.chunk.fill(this.prevValue,0,n)),this.chunk.fill(t,n),this.prevValue=t,this.active=!0}}},{key:"update",value:function(){var t=this.active;return this.active=!1,t!==this.lastValue?(this.lastValue=t,{playing:t}):null}},{key:"reset",value:function(){}},{key:"pause",value:function(){}},{key:"resume",value:function(){}}]),t}(),Rt=function(){function t(e){var i=e.pin1,n=e.pin2,a=e.volume,o=e.clock,u=this;(0,r.Z)(this,t),(0,s.Z)(this,"context",new AudioContext),(0,s.Z)(this,"gainNode",this.context.createGain()),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"prevTime",0),(0,s.Z)(this,"lastTime",0),(0,s.Z)(this,"freq",0),(0,s.Z)(this,"prevFreq",0),(0,s.Z)(this,"oscillator",null),(0,s.Z)(this,"lastValue",null),(0,s.Z)(this,"playing",!1),(0,s.Z)(this,"value",null),this.clock=o,this.gainNode.connect(this.context.destination),a>.01&&this.setVolume(a),this.lastValue=(null===i||void 0===i?void 0:i.value)!==!!(null===n||void 0===n?void 0:n.value)?1:0,null===i||void 0===i||i.onValueChange((function(){u.feed(i.value!==!!(null===n||void 0===n?void 0:n.value)?1:0)})),null===n||void 0===n||n.onValueChange((function(){u.feed(!!(null===i||void 0===i?void 0:i.value)!==n.value?1:0)}))}return(0,a.Z)(t,[{key:"setVolume",value:function(t){this.gainNode.gain.value=t}},{key:"feed",value:function(t){if(t!==this.lastValue){this.lastValue=t;var e=this.clock.cpuNanos/1e9,i=Math.round(1/(e-this.prevTime));if(this.prevTime=this.lastTime,this.lastTime=e,i<20)this.oscillator&&(this.oscillator.stop(),this.oscillator=null);else{var n=Math.abs(i-this.freq),r=Math.abs(this.freq-this.prevFreq);this.prevFreq=this.freq,this.freq=i,n<10&&r<10&&(this.oscillator?this.oscillator.frequency.setValueAtTime(i,this.context.currentTime):(this.oscillator=new OscillatorNode(this.context,{type:"square",frequency:i}),this.oscillator.connect(this.gainNode),this.oscillator.start()))}}}},{key:"update",value:function(){var t=this.clock.cpuNanos/1e9;this.oscillator&&t-this.lastTime>.05&&this.oscillator&&(this.oscillator.stop(),this.oscillator=null);var e=this.lastTime>=0&&t-this.lastTime<.5;return this.playing!==e?(this.playing=e,{playing:e}):null}},{key:"reset",value:function(){this.pause(),this.freq=0,this.playing=!1,this.lastTime=0,this.lastValue=null}},{key:"pause",value:function(){this.oscillator?(this.freq=this.oscillator.frequency.value,this.oscillator.stop(),this.oscillator=null):this.freq=0}},{key:"resume",value:function(){this.freq&&!this.oscillator&&(this.oscillator=new OscillatorNode(this.context,{type:"square",frequency:this.freq}),this.oscillator.connect(this.gainNode),this.oscillator.start())}}]),t}(),Bt=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"backend",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var a={clock:e,volume:parseFloat(n.get("volume")||"1"),pin1:i.get("1"),pin2:i.get("2")},o=n.get("mode");this.backend="accurate"===o?new At(a):new Rt(a)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.backend.update();return t?{value:t}:null}},{key:"reset",value:function(){this.backend.reset()}},{key:"pause",value:function(){this.backend.pause()}},{key:"resume",value:function(){this.backend.resume()}}]),t}();(0,s.Z)(Bt,"pinNames",["1","2"]);var Tt=i(79207),Et=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var a,o=i.get("CLK"),u=1e9/((0,Tt.Z)(null!==(a=n.get("frequency"))&&void 0!==a?a:"0")||1e4)/2,l=!1;o.state=X.J.Low;var c=e.createEvent((function(){l=!l,o.state=l?X.J.High:X.J.Low,c.schedule(u)}));c.schedule(u)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Et,"pinNames",["CLK"]);var Ut=1e6,Nt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"pinIn",void 0),(0,s.Z)(this,"bridgeNO",void 0),(0,s.Z)(this,"bridgeNC",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.pinIn=i.get("IN");var a=i.get("NO"),o=i.get("NC"),u=i.get("COM");this.bridgeNO=mt(e,a,u,!1),this.bridgeNC=mt(e,o,u,!1);var l=e.createEvent((function(){n.pinIn.value?(n.bridgeNO.connected=!0,n.bridgeNC.connected=!1):(n.bridgeNO.connected=!1,n.bridgeNC.connected=!0)}));this.pinIn.onValueChange((function(){l.schedule(5*Ut),n.updated=!0}))}return(0,a.Z)(t,[{key:"reset",value:function(){}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{ledPower:1,led1:this.pinIn.value?1:0}}):null}}]),t}();(0,s.Z)(Nt,"pinNames",["IN","NO","NC","COM","VCC","GND"]);var Ot=new WeakMap,Mt=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X.J.PullUp;(0,r.Z)(this,t),(0,U.Z)(this,Ot,{writable:!0,value:void 0}),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"pin",void 0),(0,s.Z)(this,"highState",void 0),this.clock=e,this.pin=i,this.highState=n,(0,N.Z)(this,Ot,!1)}return(0,a.Z)(t,[{key:"busy",get:function(){return(0,E.Z)(this,Ot)}},{key:"transmit",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this,n=this,r=n.clock,a=n.pin;(0,N.Z)(this,Ot,!0);var s=e,o=function(){a.setState(s?i.highState:X.J.Low),s=!s;var e=t.shift();e?r.addEvent(e,o):(0,N.Z)(i,Ot,!1)};o()}}]),t}(),Lt=function(t,e){var i=Math.abs(Math.round(10*t)),n=Math.round(10*e);return[n>>8,255&n,(t<0?128:0)|i>>8,255&i]},Vt={DHT11:function(t,e){return[Math.floor(e),0,Math.floor(t),0]},DHT12:function(t,e){var i=t<0?128:0;return[Math.round(e),Math.round(10*e)%10,i|Math.round(t),Math.round(10*t)%10]},DHT21:Lt,DHT22:Lt},Ft=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"temperature",void 0),(0,s.Z)(this,"humidity",void 0),(0,s.Z)(this,"lastTimestamp",void 0),(0,s.Z)(this,"type",void 0),(0,s.Z)(this,"pulseTransmitter",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.temperature=24,this.humidity=40,this.lastTimestamp=0,this.type="DHT22";var a=i.get("SDA");this.pulseTransmitter=new Mt(e,a),a.setState(X.J.PullUp),a.onValueChange((function(t){var i=e.cpuMillis-n.lastTimestamp;!n.pulseTransmitter.busy&&t&&i>=1&&i<=100&&n.transmit(),n.lastTimestamp=e.cpuMillis}))}return(0,a.Z)(t,[{key:"transmit",value:function(){if(this.pulseTransmitter){var t=Vt[this.type](this.temperature,this.humidity),e=255&t.reduce((function(t,e){return t+e}));t.push(e);var i=[3e4,8e4,8e4],n=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)for(var u=s.value,l=7;l>=0;l--){var c=!!(u&1<<l);i.push(5e4,c?7e4:27e3)}}catch(d){r=!0,a=d}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}i.push(5e4),this.pulseTransmitter.transmit(i)}}},{key:"onEvent",value:function(t){this.temperature=t.temperature,this.humidity=t.humidity}},{key:"reset",value:function(){this.lastTimestamp=0}},{key:"update",value:function(){return null}}]),t}();(0,s.Z)(Ft,"pinNames",["SDA"]);var Jt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"bridges",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.bridges=[];for(var n=1;n<=8;n++){var a=i.get("".concat(n,"a")),o=i.get("".concat(n,"b"));this.bridges.push(new pt(a,o,!1))}}return(0,a.Z)(t,[{key:"onEvent",value:function(t){for(var e=this.bridges,i=0;i<e.length;i++)e[i].connected=!!t.values[i]}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Jt,"pinNames",["1a","1b","2a","2b","3a","3b","4a","4b","5a","5b","6a","6b","7a","7b","8a","8b"]);var Wt=function(t){return t/10<<4|t%10},Ht=function(t){return(15&t)+10*(t>>4)},Kt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"addr",void 0),(0,s.Z)(this,"isFirstByte",void 0),(0,s.Z)(this,"halted",void 0),(0,s.Z)(this,"nvram",void 0),(0,s.Z)(this,"lastDate",void 0),(0,s.Z)(this,"lastDay",void 0),(0,s.Z)(this,"dayLastUpdated",void 0),(0,s.Z)(this,"controlRegister",void 0),(0,s.Z)(this,"delta",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.addr=0,this.isFirstByte=!1,this.halted=!1,this.nvram=new Uint8Array(56),this.lastDate=new Date,this.lastDay=0,this.dayLastUpdated=0,this.controlRegister=3,this.delta=0,this.value=null,new S.A({scl:i.get("SCL"),sda:i.get("SDA")},104).setHandler(this)}return(0,a.Z)(t,[{key:"date",get:function(){return this.halted?this.lastDate:new Date((new Date).getTime()-this.delta)},set:function(t){this.lastDate=t,this.delta=(new Date).getTime()-t.getTime()}},{key:"readRegister",value:function(t){var e=this.date;switch(t){case 0:return Wt(e.getSeconds())|(this.halted?128:0);case 1:return Wt(e.getMinutes());case 2:return Wt(e.getHours());case 3:return e.getDay()+1;case 4:return Wt(e.getDate());case 5:return Wt(e.getMonth()+1);case 6:return Wt(e.getFullYear()-2e3);case 7:return this.controlRegister;default:return this.nvram[t-8]}}},{key:"writeRegister",value:function(t,e){var i=new Date(this.date);switch(t){case 0:return this.halted=!!(128&e),i.setSeconds(Ht(127&e)),void(this.date=i);case 1:return i.setMinutes(Ht(e)),void(this.date=i);case 2:return i.setHours(Ht(e)),void(this.date=i);case 3:return;case 4:return this.lastDay=Ht(e),this.dayLastUpdated=this.clock.cpuNanos,i.setDate(this.lastDay),void(this.date=i);case 5:return i.setMonth(Ht(e)-1),this.lastDay&&this.clock.cpuNanos-this.dayLastUpdated<1e9&&i.setDate(this.lastDay),void(this.date=i);case 6:return i.setFullYear(2e3+Ht(e)),void(this.date=i);case 7:return void(this.controlRegister=e);default:this.nvram[t-8]=e}}},{key:"i2cConnect",value:function(){return this.isFirstByte=!0,!0}},{key:"i2cReadByte",value:function(){this.isFirstByte=!1;var t=this.readRegister(this.addr);return this.addr=(this.addr+1)%64,t}},{key:"i2cWriteByte",value:function(t){return this.isFirstByte?(this.addr=t,this.isFirstByte=!1,!0):(this.writeRegister(this.addr,t),this.addr=(this.addr+1)%64,!0)}},{key:"i2cDisconnect",value:function(){}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.isFirstByte=!0,this.addr=0}}]),t}();(0,s.Z)(Kt,"pinNames",["SCL","SDA"]);var qt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ledController",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={led1:0,ledPower:1};var n=new Map,a=i.get("D2"),o=i.get("GND");n.set("A",a),n.set("C",o),this.ledController=new W(this.clock,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ledController.update();return t&&(this.value.led1=t.value,this.updated=!0),this.updated?{value:(0,u.Z)({},this.value)}:null}},{key:"reset",value:function(t){this.ledController.reset(),t&&(this.value.ledPower=0),this.updated=!0}}]),t}();(0,s.Z)(qt,"pinNames",["D2","GND"]);var Gt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"nextOutput",Math.random()>=.5),(0,s.Z)(this,"lastNegEdge",0),(0,s.Z)(this,"outputEvent",void 0);var a=i.get("CLK"),o=i.get("D"),u=i.attached("S")?i.get("S"):null,l=i.attached("R")?i.get("R"):null,c=i.get("Q"),d=i.get("NOTQ");this.outputEvent=e.createEvent((function(){(null===l||void 0===l?void 0:l.value)?n.nextOutput=!1:(null===u||void 0===u?void 0:u.value)&&(n.nextOutput=!0);var t=n.nextOutput;c.setState(t?X.J.High:X.J.Low),d.setState(t?X.J.Low:X.J.High)})),null===u||void 0===u||u.onValueChange((function(t){t&&n.outputEvent.schedule(4)})),null===l||void 0===l||l.onValueChange((function(){n.outputEvent.schedule(4)})),a.onValueChange((function(t){t&&e.cpuNanos-n.lastNegEdge>=4?(n.nextOutput=o.value,n.outputEvent.schedule(4)):n.lastNegEdge=e.cpuNanos})),this.outputEvent.schedule(4)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Gt,"pinNames",["D","CLK","Q","NOTQ","S","R"]);var zt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"nextOutput",Math.random()>=.5),(0,s.Z)(this,"lastNegEdge",0),(0,s.Z)(this,"outputEvent",void 0);var a=i.get("CLK"),o=i.get("Q"),u=i.get("S"),l=i.get("R"),c=i.get("NOTQ");this.outputEvent=e.createEvent((function(){var t=n.nextOutput;o.setState(t?X.J.High:X.J.Low),c.setState(t?X.J.Low:X.J.High)})),a.onValueChange((function(t){!t||e.cpuNanos-n.lastNegEdge<4?n.lastNegEdge=e.cpuNanos:(u.value&&l.value?n.nextOutput=!n.nextOutput:u.value?n.nextOutput=!0:l.value&&(n.nextOutput=!1),n.outputEvent.schedule(4))})),this.outputEvent.schedule(4)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(zt,"pinNames",["S","CLK","R","Q","NOTQ"]);var Xt=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ledController",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={led:0,ledPower:1};var n=new Map,a=i.get("PB1"),o=i.get("GND");a&&o&&(n.set("A",a),n.set("C",o)),this.ledController=new W(this.clock,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ledController.update();return t&&(this.value.led=t.value,this.updated=!0),this.updated?{value:(0,u.Z)({},this.value)}:null}},{key:"reset",value:function(t){this.ledController.reset(),this.value.led=0,t&&(this.value.ledPower=0),this.updated=!0}}]),t}();(0,s.Z)(Xt,"pinNames",["PB1","GND"]);var jt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"distance",400);var a=i.get("ECHO"),o=i.get("TRIG");a.setState(X.J.Low),o.onValueChange((function(t){if(!t){var i=3e5,r=Math.round(58.82*n.distance*1e3);e.addEvent(i,(function(){a.setState(X.J.High)})),e.addEvent(i+r,(function(){a.setState(X.J.Low)}))}}))}return(0,a.Z)(t,[{key:"onEvent",value:function(t){this.distance=t.distance}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(jt,"pinNames",["ECHO","TRIG"]);var Qt=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"value",0);var a=i.get("PL"),o=[i.get("D0"),i.get("D1"),i.get("D2"),i.get("D3"),i.get("D4"),i.get("D5"),i.get("D6"),i.get("D7")],u=i.get("Q7"),l=i.get("Q7_N"),c=function(){l.state=1&n.value?X.J.Low:X.J.High,u.state=1&n.value?X.J.High:X.J.Low},d=function(){a.value||(n.value=(o[0].value?128:0)|(o[1].value?64:0)|(o[2].value?32:0)|(o[3].value?16:0)|(o[4].value?8:0)|(o[5].value?4:0)|(o[6].value?2:0)|(o[7].value?1:0),c())};a.onValueChange(d);var h=!0,v=!1,f=void 0;try{for(var p,g=o[Symbol.iterator]();!(h=(p=g.next()).done);h=!0){p.value.onValueChange(d)}}catch(b){v=!0,f=b}finally{try{h||null==g.return||g.return()}finally{if(v)throw f}}var y=i.get("CP"),m=i.get("CE"),w=i.get("DS"),k=!1,Z=function(){var t=y.value||m.value;!k&&t&&a.value&&(n.value=(w.value?128:0)|n.value>>1,e.addEvent(0,c)),k=t};y.onValueChange(Z),m.onValueChange(Z)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Qt,"pinNames",["PL","CP","D4","D5","D6","D7","Q7_N","GND","Q7","DS","D0","D1","D2","D3","CE","VCC"]);var $t=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"outputs",[]),(0,s.Z)(this,"enable",!1),(0,s.Z)(this,"clear",!1),(0,s.Z)(this,"inputValue",0),(0,s.Z)(this,"outputValue",0);var a=i.get("DS"),o=i.get("Q7S");i.get("SHCP").onValueChange((function(t){if(t){var e,i=null!==(e=a.value)&&void 0!==e&&e;n.inputValue=n.inputValue<<1|(i?1:0)}!t&&o&&(o.state=128&n.inputValue?X.J.High:X.J.Low)})),i.get("STCP").onValueChange((function(t){t&&(n.outputValue=n.clear?0:n.inputValue,n.enable&&n.updateOutput())}));var u=i.get("OE");this.enable=!u.value,u.onValueChange((function(t){if(n.enable=!t,t){var e=!0,i=!1,r=void 0;try{for(var a,s=n.outputs[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){a.value.setState(X.J.HighZ)}}catch(o){i=!0,r=o}finally{try{e||null==s.return||s.return()}finally{if(i)throw r}}}else n.updateOutput()}));var l=i.get("MR");this.clear=!!i.attached("MR")&&!l.value,l.onValueChange((function(t){n.clear=!t,n.inputValue=0}));for(var c=0,d=[0,1,2,3,4,5,6,7];c<d.length;c++){var h=d[c];this.outputs[h]=i.get("Q".concat(h))}}return(0,a.Z)(t,[{key:"updateOutput",value:function(){var t=this.outputValue,e=!0,i=!1,n=void 0;try{for(var r,a=this.outputs[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.setState(1&t?X.J.High:X.J.Low),t>>=1}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)($t,"pinNames",["Q1","Q2","Q3","Q4","Q5","Q6","Q7","GND","Q7S","MR","SHCP","STCP","OE","DS","Q0","VCC"]);var Yt,te=i(11113),ee=i(29399),ie=(Yt={},(0,s.Z)(Yt,54,1),(0,s.Z)(Yt,193,1),(0,s.Z)(Yt,180,1),(0,s.Z)(Yt,197,1),(0,s.Z)(Yt,58,1),(0,s.Z)(Yt,194,2),(0,s.Z)(Yt,195,2),(0,s.Z)(Yt,196,2),(0,s.Z)(Yt,182,2),(0,s.Z)(Yt,177,3),(0,s.Z)(Yt,178,3),(0,s.Z)(Yt,42,4),(0,s.Z)(Yt,43,4),(0,s.Z)(Yt,192,3),(0,s.Z)(Yt,179,6),(0,s.Z)(Yt,224,16),(0,s.Z)(Yt,225,16),Yt),ne=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"width",128),(0,s.Z)(this,"height",128),(0,s.Z)(this,"pixels",new Uint16Array(this.height*this.width)),(0,s.Z)(this,"blackDisplay",!0),(0,s.Z)(this,"displayOn",!1),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"invert",!1),(0,s.Z)(this,"activeColumn",0),(0,s.Z)(this,"activePage",0),(0,s.Z)(this,"columnStart",0),(0,s.Z)(this,"columnEnd",0),(0,s.Z)(this,"pageStart",0),(0,s.Z)(this,"pageEnd",0),(0,s.Z)(this,"scanningDirection",0),(0,s.Z)(this,"highByte",!0),(0,s.Z)(this,"highByteValue",0),(0,s.Z)(this,"commandMode",!1),(0,s.Z)(this,"currentCommandIndex",0),(0,s.Z)(this,"currentCommandLength",0),(0,s.Z)(this,"currentCommand",new Uint8Array(8));var a=i.get("D/C");this.reset(),new k.g({mosi:i.get("SDA"),clk:i.get("SCL"),ss:i.get("CS")}).onTransmit=function(t){return a.value?n.processData(t):n.processCommand(t),0}}return(0,a.Z)(t,[{key:"update",value:function(){if(this.updated){this.updated=!1;return{value:{pixels:this.pixels,invert:this.invert}}}return null}},{key:"snapshot",value:function(){this.update()}},{key:"value",get:function(){return""}},{key:"reset",value:function(){this.displayOn=!1,this.activeColumn=0,this.activePage=0,this.columnStart=0,this.columnEnd=127,this.pageStart=0,this.pageEnd=7}},{key:"fixBlackDisplayPageOffsets",value:function(){128&this.scanningDirection&&(this.activePage-=32,this.pageStart-=32),128&this.scanningDirection&&(this.pageEnd-=32)}},{key:"processCommand",value:function(t){if(this.commandMode=!0,this.currentCommand[this.currentCommandIndex]=t,this.currentCommandIndex||(this.currentCommandLength=1+(ie[t]||0)),this.currentCommandIndex++,!(this.currentCommandIndex<this.currentCommandLength)){var e=this.currentCommand[0],i=!1;switch(e){case 0:case 192:case 1:case 58:case 197:break;case 16:case 40:this.displayOn=!1,i=!0;break;case 17:case 41:this.displayOn=!0,i=!0;break;case 32:this.invert=!1,i=!0;break;case 33:this.invert=!0,i=!0;break;case 44:this.commandMode=!1,this.highByte=!0;break;case 54:this.scanningDirection=252&this.currentCommand[1];break;case 42:case 43:var n=this.currentCommand[1]<<8|this.currentCommand[2],r=this.currentCommand[3]<<8|this.currentCommand[4],a=43===e;(32&this.scanningDirection?!a:a)?(this.activePage=n,this.pageStart=n,this.pageEnd=r,this.blackDisplay&&this.fixBlackDisplayPageOffsets()):(this.activeColumn=n,this.columnStart=n,this.columnEnd=r);break;default:console.warn("Unknown IL9163 Command",e.toString(16),this.currentCommand.slice(1,this.currentCommandIndex))}i&&this.displayOn&&(this.updated=!0),this.currentCommandIndex=0}}},{key:"processData",value:function(t){if(this.commandMode)this.processCommand(t);else{if(this.highByte)return this.highByte=!1,void(this.highByteValue=t);var e=this.highByteValue<<8|t,i=this.activeColumn,n=this.activePage;32&this.scanningDirection?(i=64&this.scanningDirection?this.width-1-i:i,n=128&this.scanningDirection?this.height-1-n:n):(i=128&this.scanningDirection?this.width-1-i:i,n=64&this.scanningDirection?this.height-1-n:n);var r=n*this.width+i;this.pixels[r]=e,32&this.scanningDirection?(this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart))):(this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart))),this.updated=!0,this.highByte=!0}}}]),t}();(0,s.Z)(ne,"pinNames",["D/C","CS","SDA","SCL"]);var re=526500,ae=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"transmitter",void 0);var n=i.get("DAT");n.setState(X.J.PullUp),this.transmitter=new Mt(e,n),t.instances.set(e,this)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){for(var e=this.transmitter,i=255&t.command,n=255&t.address,r=n|(255&~n)<<8|i<<16|(255&~i)<<24,a=[9e6,45e5],s=0;s<32;s++)a.push(re,r&1<<s?1687500:526500);a.push(re),e.transmit(a,!1)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}],[{key:"find",value:function(e){return t.instances.get(e)}}]),t}();(0,s.Z)(ae,"instances",new WeakMap),(0,s.Z)(ae,"pinNames",["DAT"]);var se=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e;null===(e=ae.find(this.clock))||void 0===e||e.onEvent(t)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(se,"pinNames",[]);var oe=i(66869),ue=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"switch",void 0),(0,s.Z)(this,"clk",void 0),(0,s.Z)(this,"dt",void 0),(0,s.Z)(this,"rotateEvent",void 0),(0,s.Z)(this,"currentState",void 0),(0,s.Z)(this,"firstPin",void 0),(0,s.Z)(this,"secondPin",void 0),(0,s.Z)(this,"rotateNext",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.currentState=0,this.rotateNext=function(){switch(n.currentState){case 0:var t;null===(t=n.firstPin)||void 0===t||t.setState(X.J.Low),n.rotateEvent.schedule((0,oe.r)(2e6,8e6)),n.currentState++;break;case 1:var e;null===(e=n.secondPin)||void 0===e||e.setState(X.J.Low),n.rotateEvent.schedule((0,oe.r)(2e6,19e6)),n.currentState++;break;case 2:var i;null===(i=n.firstPin)||void 0===i||i.setState(X.J.PullUp),n.rotateEvent.schedule((0,oe.r)(100,5e6)),n.currentState++;break;case 3:var r;null===(r=n.secondPin)||void 0===r||r.setState(X.J.PullUp),n.currentState=0}},this.switch=new pt(i.get("SW"),i.get("GND")),this.clk=i.get("CLK"),this.dt=i.get("DT"),this.clk.state=X.J.PullUp,this.dt.state=X.J.PullUp,this.rotateEvent=this.clock.createEvent(this.rotateNext)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){switch(t.type){case"press":this.switch.connected=!0;break;case"release":this.switch.connected=!1;break;case"rotate-cw":this.rotate(this.clk,this.dt);break;case"rotate-ccw":this.rotate(this.dt,this.clk)}}},{key:"rotate",value:function(t,e){var i,n;if(0!==this.currentState)return null===(i=this.firstPin)||void 0===i||i.setState(X.J.PullUp),null===(n=this.secondPin)||void 0===n||n.setState(X.J.PullUp),this.firstPin=t,this.secondPin=e,this.currentState=0,void this.rotateEvent.schedule(1e3);this.firstPin=t,this.secondPin=e,this.rotateNext()}},{key:"reset",value:function(){}},{key:"update",value:function(){return null}}]),t}();(0,s.Z)(ue,"pinNames",["CLK","DT","SW","VCC","GND"]);var le=80,ce=40,de=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"ddram",new Uint8Array(le)),(0,s.Z)(this,"cgram",new Uint8Array(64)),(0,s.Z)(this,"cgramUpdated",!0),(0,s.Z)(this,"addr",0),(0,s.Z)(this,"writeCGRam",!1),(0,s.Z)(this,"busy",!1),(0,s.Z)(this,"firstByte",!0),(0,s.Z)(this,"registerValue",0),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"shift",0),(0,s.Z)(this,"incrementMode",!0),(0,s.Z)(this,"shiftMode",!1),(0,s.Z)(this,"displayOn",!1),(0,s.Z)(this,"blinkOn",!1),(0,s.Z)(this,"cursorOn",!1),(0,s.Z)(this,"backlight",!1),(0,s.Z)(this,"is8bit",!0),(0,s.Z)(this,"cols",16),(0,s.Z)(this,"rows",2),this.reset()}return(0,a.Z)(t,[{key:"reset",value:function(){this.cgram.fill(0),this.ddram.fill(0),this.cgramUpdated=!0,this.addr=0,this.writeCGRam=!1,this.firstByte=!0,this.registerValue=0,this.shift=0,this.incrementMode=!0,this.shiftMode=!1,this.displayOn=!1,this.blinkOn=!1,this.cursorOn=!1,this.backlight=!1,this.is8bit=!0,this.updated=!0}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:this.snapshot()}):null}},{key:"snapshot",value:function(){var t=this,e=t.rows,i=t.cols,n=t.shift,r=t.ddram,a=new Uint8Array(e*i),s=[0,ce,i,ce+i];if(this.displayOn)for(var o=0;o<e;o++)for(var u=0;u<i;u++){var l=(u+ce-n)%ce;a[o*i+u]=r[s[o]+l]}else a.fill(32);var c=this,d=c.cursorOn,h=c.blinkOn,v=c.backlight,f=c.cgram,p=c.cgramUpdated,g=c.addr,y=(g+ce+n)%ce,m=g>ce?1:0;return i>2&&y>i&&(y-=i,m+=2),this.cgramUpdated=!1,{cursor:d,blink:h,cursorX:y,cursorY:m,value:a,backlight:v,cgram:f,cgramUpdated:p}}},{key:"value",get:function(){return""}},{key:"readByte",value:function(t){var e=(this.busy?128:0)|127&this.addr,i=t?this.readData(!this.firstByte):e;return this.is8bit?i:this.firstByte?(this.firstByte=!1,240&i):(this.firstByte=!0,(15&i)<<4)}},{key:"readData",value:function(t){if(this.writeCGRam){var e=this.cgram[this.addr],i=(1&e)<<4|(2&e)<<2|4&e|(8&e)>>2|(16&e)>>4;return t&&(this.addr=(this.addr+1)%64),i}var n=this.ddram[this.addr];if(t){var r=this.incrementMode?1:-1;this.addr=(this.addr+le+r)%le}return n}},{key:"feedByte",value:function(t,e){if(!this.is8bit){if(this.firstByte)return this.registerValue=t,void(this.firstByte=!1);t=this.registerValue|t>>4,this.firstByte=!0}e?this.writeData(t):this.executeCommand(t),this.updated=!0}},{key:"writeData",value:function(t){if(this.writeCGRam){var e=(1&t)<<4|(2&t)<<2|4&t|(8&t)>>2|(16&t)>>4;this.cgram[this.addr]=e,this.addr=(this.addr+1)%64,this.cgramUpdated=!0}else{this.ddram[this.addr]=t;var i=this.incrementMode?1:-1;this.addr=(this.addr+le+i)%le,this.shiftMode&&(this.shift=(this.shift+i)%ce)}}},{key:"executeCommand",value:function(t){if(128&t){var e=127&t;this.addr=e<ce?e:e-24,this.addr>=le&&(this.addr=0),this.writeCGRam=!1}else if(64&t)this.addr=63&t,this.writeCGRam=!0;else if(32&t)this.is8bit=!!(16&t);else if(16&t){var i=!!(8&t),n=!!(4&t)?1:-1;this.addr=(this.addr+le+n)%le,i&&(this.shift=(this.shift+n)%ce),this.writeCGRam=!1}else 8&t?(this.displayOn=!!(4&t),this.blinkOn=!!(1&t),this.cursorOn=!!(2&t)):4&t?(this.incrementMode=!!(2&t),this.shiftMode=!!(1&t)):2&t?(this.writeCGRam=!1,this.addr=0,this.shift=0):1&t&&(this.ddram.fill(32),this.incrementMode=!0,this.addr=0,this.shift=0,this.writeCGRam=!1)}},{key:"setBacklight",value:function(t){t!==this.backlight&&(this.backlight=t,this.updated=!0)}},{key:"attachToPins",value:function(t){var e=this,i=t.enable,n=t.rw;n.setState(X.J.PullDown);var r=t.a,a=t.k;r&&a&&z([r,a],(function(){return r.value&&!a.value&&(r.driven||a.driven)}),(function(t){e.setBacklight(t)})),i&&i.onValueChange((function(i){if(i&&!n.value){var r,a,s,o,u,l,c,d,h=((null===(r=t.d0)||void 0===r?void 0:r.value)?1:0)|((null===(a=t.d1)||void 0===a?void 0:a.value)?2:0)|((null===(s=t.d2)||void 0===s?void 0:s.value)?4:0)|((null===(o=t.d3)||void 0===o?void 0:o.value)?8:0)|((null===(u=t.d4)||void 0===u?void 0:u.value)?16:0)|((null===(l=t.d5)||void 0===l?void 0:l.value)?32:0)|((null===(c=t.d6)||void 0===c?void 0:c.value)?64:0)|((null===(d=t.d7)||void 0===d?void 0:d.value)?128:0);e.feedByte(h,t.rs.value)}if(i&&n.value){var v,f,p,g,y,m,w,k,Z=e.readByte(t.rs.value);null===(v=t.d0)||void 0===v||v.setState(1&Z?X.J.High:X.J.Low),null===(f=t.d1)||void 0===f||f.setState(2&Z?X.J.High:X.J.Low),null===(p=t.d2)||void 0===p||p.setState(4&Z?X.J.High:X.J.Low),null===(g=t.d3)||void 0===g||g.setState(8&Z?X.J.High:X.J.Low),null===(y=t.d4)||void 0===y||y.setState(16&Z?X.J.High:X.J.Low),null===(m=t.d5)||void 0===m||m.setState(32&Z?X.J.High:X.J.Low),null===(w=t.d6)||void 0===w||w.setState(64&Z?X.J.High:X.J.Low),null===(k=t.d7)||void 0===k||k.setState(128&Z?X.J.High:X.J.Low)}if(!i){var b=[t.d0,t.d1,t.d2,t.d3,t.d4,t.d5,t.d6,t.d7],C=!0,_=!1,S=void 0;try{for(var x,P=b[Symbol.iterator]();!(C=(x=P.next()).done);C=!0){var I=x.value;null===I||void 0===I||I.setState(X.J.PullDown)}}catch(D){_=!0,S=D}finally{try{C||null==P.return||P.return()}finally{if(_)throw S}}}}))}}]),t}(),he=i(4111),ve=i(28668),fe=i(26626),pe=function(t){(0,ve.Z)(i,t);var e=(0,fe.Z)(i);function i(t,n){var a;return(0,r.Z)(this,i),a=e.call(this),(0,s.Z)((0,he.Z)(a),"prevEnable",!1),(0,s.Z)((0,he.Z)(a),"readMode",!1),(0,s.Z)((0,he.Z)(a),"inputMask",0),(0,s.Z)((0,he.Z)(a),"inputValue",255),new S.A({scl:t.get("SCL"),sda:t.get("SDA")},n).setHandler((0,he.Z)(a)),a}return(0,a.Z)(i,[{key:"i2cConnect",value:function(){return!0}},{key:"i2cReadByte",value:function(){return this.readMode?this.inputMask&this.inputValue:this.inputMask}},{key:"i2cWriteByte",value:function(t){var e=240&t,i=!!(1&t),n=!!(2&t),r=!!(4&t),a=!!(8&t);this.inputMask=t,this.readMode=r&&n,this.setBacklight(a);var s=r&&!this.prevEnable;if(s&&!this.readMode&&this.feedByte(e,i),s&&this.readMode){var o=this.readByte(i);this.inputValue=240&o|7}return this.prevEnable=r,!0}},{key:"i2cDisconnect",value:function(){}}]),i}(de),ge=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"controller",void 0);var a=parseInt(n.get("i2c-address")||"0",16)||39;"i2c"===n.get("pins")?this.controller=new pe(i,a):(this.controller=new de,this.controller.attachToPins({a:i.attached("A")?i.get("A"):null,k:i.attached("K")?i.get("K"):null,v0:i.attached("V0")?i.get("V0"):null,rs:i.get("RS"),rw:i.get("RW"),enable:i.get("E"),d0:i.get("D0"),d1:i.get("D1"),d2:i.get("D2"),d3:i.get("D3"),d4:i.get("D4"),d5:i.get("D5"),d6:i.get("D6"),d7:i.get("D7")}))}return(0,a.Z)(t,[{key:"update",value:function(){var t,e;return null!==(e=null===(t=this.controller)||void 0===t?void 0:t.update())&&void 0!==e?e:null}},{key:"reset",value:function(){var t;null===(t=this.controller)||void 0===t||t.reset()}}]),t}();(0,s.Z)(ge,"pinNames",["A","K","V0","RS","RW","E","D0","D1","D2","D3","D4","D5","D6","D7","SCL","SDA"]);var ye=function(t){(0,ve.Z)(i,t);var e=(0,fe.Z)(i);function i(t,n,a){var s;return(0,r.Z)(this,i),(s=e.call(this,t,n,a)).controller&&(s.controller.rows=4,s.controller.cols=20),s}return i}(ge);(0,s.Z)(ye,"pinNames",ge.pinNames);var me=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"leds",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.leds=[],this.value={segments:[]};for(var n=1;n<=10;n++){var a=new Map;a.set("A",i.get("A".concat(n))),a.set("C",i.get("C".concat(n))),this.leds.push(new W(e,a))}}return(0,a.Z)(t,[{key:"update",value:function(){for(var t=!1,e=0;e<this.leds.length;e++){var i,n=null===(i=this.leds[e])||void 0===i?void 0:i.update();n&&(this.value.segments[e]=n.value,t=!0)}return t?{value:this.value}:null}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.leds[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a=n.value;null===a||void 0===a||a.reset()}}catch(s){e=!0,i=s}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}}]),t}();(0,s.Z)(me,"pinNames",["A1","A2","A3","A4","A5","A6","A7","A8","A9","A10","C1","C2","C3","C4","C5","C6","C7","C8","C9","C10"]);var we=80,ke=55,Ze=75,be=5,Ce=function(){function t(e,i,n){var a,o=this;(0,r.Z)(this,t),(0,s.Z)(this,"lastUpdate",void 0),(0,s.Z)(this,"frames",void 0),(0,s.Z)(this,"lastFrame",void 0),(0,s.Z)(this,"power",void 0),(0,s.Z)(this,"lastPower",void 0),(0,s.Z)(this,"pixelCount",void 0),(0,s.Z)(this,"standbyPower",void 0),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.lastUpdate=0,this.frames=0,this.lastFrame=0,this.power=0,this.lastPower=0,this.pixelCount=parseInt(null!==(a=n.get("pixels"))&&void 0!==a?a:"",10)||0,this.standbyPower=this.pixelCount*be,this.reset();var u=i.get("DIN");this.ws2812Decoder=new et(u,e),this.ws2812Decoder.resize(this.pixelCount),this.ws2812Decoder.subscribe((function(t){o.lastPower=o.standbyPower;var i=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,l=255&u,c=u>>8&255,d=u>>16&255;o.lastPower+=(c*we+d*ke+l*Ze)/256}}catch(h){n=!0,r=h}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}o.power=Math.max(o.power,o.lastPower),o.frames++,o.lastFrame=e.cpuMillis}))}return(0,a.Z)(t,[{key:"update",value:function(){this.ws2812Decoder.update();var t=this.clock.cpuMillis-this.lastUpdate;if(t>1e3){var e={fps:this.frames?this.frames/(t/1e3):1e3/(this.clock.cpuMillis-this.lastFrame),milliWatts:this.power};return this.lastUpdate=this.clock.cpuMillis,this.power=this.lastPower,this.frames=0,{value:e}}return null}},{key:"reset",value:function(){this.frames=0,this.lastUpdate=0,this.lastFrame=0,this.lastPower=this.standbyPower,this.power=this.lastPower}}]),t}();(0,s.Z)(Ce,"pinNames",["DIN"]);var _e,Se=["D0","D1","D2","D3","D4","D5","D6","D7"],xe="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~";!function(t){t[t.Off=0]="Off",t[t.Level=1]="Level",t[t.Edge=2]="Edge"}(_e||(_e={}));var Pe=function(){function t(e,i,n){var a,o,u,l=this,c=function(t){var n=i.get(Se[t]);if(i.attached(Se[t])){var r=l.channelNames.length;l.pins[t]=n,l.channelNames.push(m[t]||Se[t]),l.triggered&&(k[l.sampleIndex]=0,w[l.sampleIndex++]=r<<1|(n.value?1:0));var a=n===l.triggerPin;n.onValueChange((function(i){(d.triggered||a)&&(d.activeChannels|=1<<t,d.updated=!0,d.sampleIndex<k.length&&(k[d.sampleIndex]=e.cpuNanos,w[d.sampleIndex++]=r<<1|(i?1:0)))}))}},d=this;(0,r.Z)(this,t),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"triggerPin",void 0),(0,s.Z)(this,"samples",void 0),(0,s.Z)(this,"filename",void 0),(0,s.Z)(this,"sampleTimes",void 0),(0,s.Z)(this,"sampleIndex",void 0),(0,s.Z)(this,"channelNames",void 0),(0,s.Z)(this,"traceNames",void 0),(0,s.Z)(this,"traces",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"activeChannels",void 0),(0,s.Z)(this,"triggered",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.pins=[],this.sampleIndex=0,this.channelNames=[],this.traceNames=[],this.traces=[],this.updated=!1,this.activeChannels=0,this.triggered=!1;var h,v,f=parseInt(null!==(u=n.get("bufferSize"))&&void 0!==u?u:"0",10)||1e6;this.filename=(null===(a=n.get("filename"))||void 0===a?void 0:a.replace(/[\\/:"*?<>|]/g,""))||"wokwi-logic",this.samples=new Uint8Array(f),this.sampleTimes=new Float64Array(f),this.updated=!0,this.triggerPin=i.get(null!==(h=n.get("triggerPin"))&&void 0!==h?h:"D7");var p,g=function(t){switch(t){case"level":return _e.Level;case"edge":return _e.Edge;default:return _e.Off}}(null!==(v=n.get("triggerMode"))&&void 0!==v?v:"off"),y="low"!==n.get("triggerLevel");this.setupTrigger(g,y);for(var m=null!==(p=null===(o=n.get("channelNames"))||void 0===o?void 0:o.split(",").map((function(t){return t.trim()})))&&void 0!==p?p:[],w=this.samples,k=this.sampleTimes,Z=0;Z<Se.length;Z++)c(Z);t.instance=this}return(0,a.Z)(t,[{key:"trace",value:function(t,e){var i=this.traceNames.indexOf(t);i<0&&(i=this.traceNames.length,this.traceNames.push(t)),this.traces[this.sampleIndex]=e,this.samples[this.sampleIndex]=i+32<<1,this.sampleTimes[this.sampleIndex++]=this.clock.cpuNanos}},{key:"dumpPinValues",value:function(){for(var t=this,e=t.samples,i=t.sampleTimes,n=t.clock,r=0;r<this.pins.length;r++){var a=this.pins[r];a&&(i[this.sampleIndex]=n.cpuNanos,e[this.sampleIndex++]=r<<1|(a.value?1:0))}}},{key:"setupTrigger",value:function(t,e){var i=this;switch(t){case _e.Off:this.triggered=!0;break;case _e.Level:this.triggered=this.triggerPin.value===e,this.triggerPin.onValueChange((function(t){i.triggered=t===e,t&&i.dumpPinValues()}));break;case _e.Edge:this.triggered=!1,this.triggerPin.onValueChange((function(t){t!==e||i.triggered||(i.triggered=!0,i.dumpPinValues())}))}}},{key:"update",value:function(){var t=this.updated,e=this.activeChannels;return this.activeChannels||(this.updated=!1),this.activeChannels=0,t?{value:{activeChannels:e,samples:this.sampleIndex}}:null}},{key:"finalize",value:function(){var t=this,e=t.sampleIndex,i=t.sampleTimes,n=t.samples,r=t.pins;if(e<i.length){this.sampleTimes[this.sampleIndex]=this.clock.cpuNanos;var a=parseInt(Object.keys(r)[0],10);n[this.sampleIndex++]=a<<1|(r[a].value?1:0)}}},{key:"reset",value:function(){if(this.updated=!0,this.sampleIndex){this.finalize();var t=this.channelNames.length,e=xe.slice(t,t+this.traceNames.length),i=["$version Generated by Wokwi.com $end","$date ".concat((new Date).toUTCString()," $end"),"$timescale 1ns $end","$scope module logic $end"].concat((0,d.Z)(this.channelNames.map((function(t,e){return"$var wire 1 ".concat(xe[e]," ").concat(t," $end")}))),(0,d.Z)(this.traceNames.map((function(t,i){return"$var real 64 ".concat(e[i]," ").concat(t," $end")}))),["$upscope $end","$enddefinitions $end"]),n=this,r=n.samples,a=n.sampleTimes,s=n.sampleIndex;s&&0!==a[0]&&i.push("#0");for(var o=0;o<s;o++){var u=1&r[o],l=r[o]>>1;if(i.push("#".concat(a[o].toFixed(0))),l<32){var c=xe[l];i.push("".concat(u).concat(c))}else{var h=e[l-32];i.push("r".concat(this.traces[o]," ").concat(h))}}i.push("");var v=new Blob([i.join("\n")],{type:"application/octet-stream"}),f=window.URL.createObjectURL(v),p=document.createElement("a");p.href=f,p.download=this.filename+".vcd",p.style.display="none",document.body.appendChild(p),p.click(),p.remove()}this.sampleIndex=0}}]),t}();function Ie(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["A","B"],i="OUT",n=function(){function n(a,o){(0,r.Z)(this,n),(0,s.Z)(this,"clock",void 0),this.clock=a;var u=e.map((function(t){return o.get(t)})),l=o.get(i);z(u,t,(function(t){l.setState(t?X.J.High:X.J.Low)}))}return(0,a.Z)(n,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),n}();return(0,s.Z)(n,"pinNames",(0,d.Z)(e).concat([i])),n}(0,s.Z)(Pe,"pinNames",Se),(0,s.Z)(Pe,"instance",void 0);var De=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15];function Ae(t){return De[15&t]<<4|De[t>>4&15]}var Re=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"ram",void 0),(0,s.Z)(this,"inputBuffer",void 0),(0,s.Z)(this,"chainLength",void 0),(0,s.Z)(this,"inputIndex",0),(0,s.Z)(this,"bitOutIndex",0),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"revColumns",!1);var o=i.get("CLK"),u=i.get("DIN"),l=i.get("DOUT"),c=i.get("CS"),d=i.attached("DOUT"),h=n.get("layout");(this.revColumns="fc16"===h,this.chainLength=parseInt(n.get("chain")||"",10)||8,this.ram=new Uint8Array(8*this.chainLength),this.inputBuffer=new Uint8Array(2*this.chainLength),c&&o&&u)&&(new k.g({clk:o,mosi:u,ss:c}).onTransmit=function(t){a.inputBuffer[a.inputIndex++%a.inputBuffer.length]=t},d&&o.onValueChange((function(t){if(!c.value&&!t){var e=a.inputBuffer[a.inputIndex%a.inputBuffer.length]&1<<7-a.bitOutIndex;l.setState(e?X.J.High:X.J.Low),a.bitOutIndex=(a.bitOutIndex+1)%8}})),c.onValueChange((function(t){t?(a.transmissionComplete(),a.updated=!0):(a.inputIndex=0,a.bitOutIndex=1)})))}return(0,a.Z)(t,[{key:"transmissionComplete",value:function(){for(var t=this.inputBuffer,e=this.chainLength,i=this.inputIndex%t.length,n=Math.min(Math.floor(this.inputIndex/2),e),r=0;r<n;r++){(i-=2)<0&&(i+=t.length);var a=t[i];if(a>=1&&a<=8){var s=t[i+1];this.revColumns&&(s=Ae(s)),this.ram[8*(e-1-r)+a-1]=s}}}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{pixels:this.ram}}):null}},{key:"reset",value:function(){this.inputIndex=0}}]),t}();(0,s.Z)(Re,"pinNames",["DIN","DOUT","CS","GND","V+","CLK"]);var Be=["R1","R2","R3","R4"],Te=["C1","C2","C3","C4"],Ee=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"bridges",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.bridges=new Map;for(var n=0;n<Te.length;n++)for(var a=0;a<Be.length;a++){var o=i.get(Be[a]),u=i.get(Te[n]);this.bridges.set("".concat(n,",").concat(a),new pt(u,o))}}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this.bridges.get("".concat(t.column,",").concat(t.row));e&&(e.connected="press"===t.type)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Ee,"pinNames",(0,d.Z)(Be).concat((0,d.Z)(Te)));var Ue=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"pin1",void 0),(0,s.Z)(this,"pin2",void 0),(0,s.Z)(this,"context",void 0),(0,s.Z)(this,"userMedia",void 0),(0,s.Z)(this,"source",void 0),(0,s.Z)(this,"captureNode",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.context=new AudioContext,this.pin1=i.get("1"),this.pin2=i.get("2"),this.initMic().catch((function(t){console.warn("Failed to initialize microphone",t)}))}return(0,a.Z)(t,[{key:"initMic",value:function(){var t=this;return(0,n.Z)((function(){var e,i;return(0,h.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===navigator||void 0===navigator||null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia({audio:!0})];case 1:return t.userMedia=n.sent(),t.userMedia?(t.source=t.context.createMediaStreamSource(t.userMedia),(i=t.context.createScriptProcessor(256,1,1)).addEventListener("audioprocess",(function(e){var i=e.inputBuffer.getChannelData(0),n=e.inputBuffer.duration/e.inputBuffer.length*1e9,r=0,a=function(){var e,s,o=Math.max(0,.5+.5*i[r]);null===(e=t.pin1)||void 0===e||e.node.analogPort.writeNormalized(o),null===(s=t.pin2)||void 0===s||s.node.analogPort.writeNormalized(o),++r<i.length&&t.clock.addEvent(n,a)};a()})),t.source.connect(i),i.connect(t.context.destination),t.captureNode=i,[2]):(console.warn("Failed to initialize microphone input track!"),[2])}}))}))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.pause()}},{key:"pause",value:function(){var t,e;null===(t=this.userMedia)||void 0===t||t.getAudioTracks().map((function(t){return t.stop()})),null===(e=this.captureNode)||void 0===e||e.disconnect()}},{key:"resume",value:function(){}}]),t}();(0,s.Z)(Ue,"pinNames",["1","2"]);var Ne=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"onmidimessage",null),(0,s.Z)(this,"message",[]),this.createPlayer(),new x.g(e,i.get("RX")).subscribe((function(t){var e;(e=n.message).push.apply(e,(0,d.Z)(t)),n.checkMessage()}))}return(0,a.Z)(t,[{key:"createPlayer",value:function(){var t=this;return(0,n.Z)((function(){return(0,h.__generator)(this,(function(e){switch(e.label){case 0:return[4,i.e(5661).then(i.bind(i,95661))];case 1:return[4,(0,e.sent().instrument)(new AudioContext,"acoustic_grand_piano")];case 2:return e.sent().listenToMidi(t),[2]}}))}))()}},{key:"checkMessage",value:function(){for(;this.message.length>=3;){var t;null===(t=this.onmidimessage)||void 0===t||t.call(this,{data:new Uint8Array(this.message.slice(0,3))}),this.message.splice(0,3)}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.message=[]}}]),t}();(0,s.Z)(Ne,"pinNames",["RX"]);var Oe=i(11551),Me=function(){function t(e,i,n){var a;(0,r.Z)(this,t),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"rows",void 0),(0,s.Z)(this,"cols",void 0),(0,s.Z)(this,"layout",void 0),(0,s.Z)(this,"brightness",void 0),(0,s.Z)(this,"gamma",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.rows=parseInt(n.get("rows")||"0",10)||0,this.cols=parseInt(n.get("cols")||"0",10)||0,this.layout=n.get("matrixLayout")||"";var o,u=parseFloat(null!==(a=n.get("matrixBrightness"))&&void 0!==a?a:"1");this.brightness=u>=.01?u:1,this.gamma=parseFloat(null!==(o=n.get("_temp_gamma"))&&void 0!==o?o:"");var l=this.rows*this.cols,c=i.get("DIN"),d=i.get("DOUT");this.ws2812Decoder=new et(c,e,d),this.ws2812Decoder.resize(l)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ws2812Decoder.update();return t?{value:{pixels:t.slice(0,this.rows*this.cols),rows:this.rows,cols:this.cols,brightness:this.brightness,gamma:this.gamma,layout:this.layout,colorFormat:kt.q.BRG}}:null}},{key:"reset",value:function(){this.ws2812Decoder.reset()}}]),t}();(0,s.Z)(Me,"pinNames",["DIN","VDD","VSS","DOUT"]);var Le=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"pixel",void 0),(0,s.Z)(this,"pixels",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.pixel=parseInt(n.get("pixel")||"0",10)||0,this.pixels=parseInt(n.get("pixels")||"1",10)||1;var a=i.get("DIN"),o=i.get("DOUT");this.ws2812Decoder=new et(a,e,o),this.ws2812Decoder.resize(this.pixel+this.pixels)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ws2812Decoder.update();return t?{value:t.slice(this.pixel,this.pixel+this.pixels)}:null}},{key:"reset",value:function(){this.ws2812Decoder.reset()}}]),t}();(0,s.Z)(Le,"pinNames",["DIN","VDD","VSS","DOUT"]);var Ve=["QA","QB","QC","QD","QE","QF","QG","QH"],Fe=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"outputs",void 0),(0,s.Z)(this,"enable",!1),(0,s.Z)(this,"clear",!1),(0,s.Z)(this,"inputValue",0),(0,s.Z)(this,"outputValue",0);var a=i.get("SI"),o=i.get("SQH");i.get("SCK").onValueChange((function(t){if(t){var e,i=null!==(e=a.value)&&void 0!==e&&e;n.inputValue=n.inputValue<<1|(i?1:0)}!t&&o&&(o.state=128&n.inputValue?X.J.High:X.J.Low)})),i.get("RCK").onValueChange((function(t){t&&(n.outputValue=n.clear?0:n.inputValue,n.enable&&n.updateOutput())}));var u=i.get("OE");this.enable=!u.value,u.onValueChange((function(t){if(n.enable=!t,t){var e=!0,i=!1,r=void 0;try{for(var a,s=n.outputs[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){a.value.setState(X.J.HighZ)}}catch(o){i=!0,r=o}finally{try{e||null==s.return||s.return()}finally{if(i)throw r}}}else n.updateOutput()}));var l=i.get("SCLR");this.clear=!!i.attached("SCLR")&&!l.value,l.onValueChange((function(t){n.clear=!t,n.inputValue=0})),this.outputs=Ve.map((function(t){return i.get(t)}))}return(0,a.Z)(t,[{key:"updateOutput",value:function(){var t=this.outputValue,e=!0,i=!1,n=void 0;try{for(var r,a=this.outputs[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.setState(1&t?X.J.HighZ:X.J.Low),t>>=1}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Fe,"pinNames",(0,d.Z)(Ve).concat(["GND","SQH","SCLR","SCK","RCK","OE","SI","VCC"]));var Je=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"out",void 0),(0,s.Z)(this,"beta",void 0),(0,s.Z)(this,"temperature",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.value=null,this.temperature=24,this.out=i.get("OUT");var a=parseFloat(n.get("temperature")||"");this.temperature=isNaN(a)?24:a;var o=parseFloat(n.get("beta")||"");this.beta=!isNaN(o)&&o?o:3950,this.out.node.analogPort.writeNormalized(this.analogValue)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=t.temperature;this.temperature=e,this.out.node.analogPort.writeNormalized(this.analogValue)}},{key:"analogValue",get:function(){var t=273.15,e=this.temperature+t,i=1e4*Math.exp(this.beta*(1/e-1/298.15));return i/(i+1e4)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Je,"pinNames",["OUT"]);var We=i(42191),He=["P0","P1","P2","P3","P4","P5","P6","P7"],Ke=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"firstWriteByte",void 0),(0,s.Z)(this,"ioPins",void 0),(0,s.Z)(this,"intPin",void 0),(0,s.Z)(this,"inputMask",void 0),(0,s.Z)(this,"prevValue",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.firstWriteByte=!1,this.inputMask=0,this.prevValue=0;var a=i.get("A0"),o=i.get("A1"),u=i.get("A2"),l=new S.A({scl:i.get("SCL"),sda:i.get("SDA")});(0,We.u)(l,32,[a,o,u]),this.ioPins=He.map((function(t){return i.get(t)})),this.intPin=i.get("INT"),this.reset();var c=!0,d=!1,h=void 0;try{for(var v,f=this.ioPins[Symbol.iterator]();!(c=(v=f.next()).done);c=!0){v.value.onValueChange((function(){(n.readValue()^n.prevValue)&n.inputMask&&(n.intPin.state=X.J.Low)}))}}catch(p){d=!0,h=p}finally{try{c||null==f.return||f.return()}finally{if(d)throw h}}l.onConnect=function(){return n.firstWriteByte=!0,!0},l.onReadByte=function(){return n.intPin.state=X.J.HighZ,n.readValue()},l.onWriteByte=function(t){if(!n.firstWriteByte)return!1;n.inputMask=t;for(var e=0;e<n.ioPins.length;e++)n.ioPins[e].state=t&1<<e?X.J.PullUp:X.J.Low;return n.firstWriteByte=!1,n.intPin.state=X.J.HighZ,!0}}return(0,a.Z)(t,[{key:"readValue",value:function(){for(var t=0,e=0;e<this.ioPins.length;e++)t|=this.ioPins[e].value?1<<e:0;return t}},{key:"update",value:function(){return null}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.ioPins[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.state=X.J.PullUp}}catch(a){e=!0,i=a}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}this.inputMask=255,this.prevValue=this.readValue(),this.intPin.state=X.J.HighZ}}]),t}();(0,s.Z)(Ke,"pinNames",["A0","A1","A2","GND","INT"].concat((0,d.Z)(He),["SCL","SDA","VCC"]));var qe=i(41812),Ge=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ledController",void 0),(0,s.Z)(this,"updated",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.updated=!0,this.value={led:0};var n=new Map,a=i.get("TP5"),o=i.get("GND");n.set("A",a),n.set("C",o),this.ledController=new W(this.clock,n)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ledController.update();return t&&(this.value.led=t.value,this.updated=!0),this.updated?{value:(0,u.Z)({},this.value)}:null}},{key:"reset",value:function(){this.ledController.reset(),this.value.led=0,this.updated=!0}}]),t}();(0,s.Z)(Ge,"pinNames",["TP5","GND"]);var ze=function(){function t(e,i,n){var a,o;(0,r.Z)(this,t),(0,s.Z)(this,"outPin",void 0),(0,s.Z)(this,"retrigger",void 0),(0,s.Z)(this,"delayTime",void 0),(0,s.Z)(this,"inhibitTime",void 0),(0,s.Z)(this,"active",void 0),(0,s.Z)(this,"motionTimeout",void 0),(0,s.Z)(this,"inhibitTimeout",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.active=!1,this.motionTimeout=0,this.inhibitTimeout=0,this.outPin=i.get("OUT"),this.outPin.setState(X.J.Low),this.retrigger="0"!==n.get("retrigger"),this.delayTime=parseFloat(null!==(a=n.get("delayTime"))&&void 0!==a?a:"5")||5,this.inhibitTime=parseFloat(null!==(o=n.get("inhibitTime"))&&void 0!==o?o:"1.2")||1.2}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this;if("motion"===t.type){if(this.active&&!this.retrigger)return;if(!this.active&&this.clock.cpuMillis<this.inhibitTimeout)return;this.active=!0,this.motionTimeout=this.clock.cpuNanos+1e9*this.delayTime,this.inhibitTimeout=this.clock.cpuMillis+1e3*(this.delayTime+this.inhibitTime),this.outPin.setState(X.J.High),this.clock.addEvent(1e9*this.delayTime+10,(function(){e.clock.cpuNanos>e.motionTimeout&&(e.outPin.setState(X.J.Low),e.active=!1)}))}}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(ze,"pinNames",["OUT"]);var Xe=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"sig",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.value=null,this.sig=i.get("SIG")}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=t.value;this.sig.node.analogPort.writeNormalized(e/1023)}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Xe,"pinNames",["SIG"]);var je=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e,i.get("GND").setState(X.J.Low),i.get("VCC").setState(X.J.High)}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(je,"pinNames",["GND","VCC"]);var Qe=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"bridge",void 0);var a=i.get("1"),o=i.get("2"),u="0"!==n.get("bounce");this.bridge=mt(e,a,o,u)}return(0,a.Z)(t,[{key:"onEvent",value:function(t){this.bridge.connected="press"===t.type}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Qe,"pinNames",["1","2"]);var $e=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"no1Bridge",void 0),(0,s.Z)(this,"nc1Bridge",void 0),(0,s.Z)(this,"no2Bridge",void 0),(0,s.Z)(this,"nc2Bridge",void 0),(0,s.Z)(this,"currentState",!1),(0,s.Z)(this,"nextState",!1);var o=i.get("COIL1"),u=i.get("COIL2"),l=i.get("P1"),c=i.get("P2"),d="1"===n.get("bounce");this.no1Bridge=mt(e,l,i.get("NO1"),d),this.nc1Bridge=mt(e,l,i.get("NC1"),d),this.no2Bridge=mt(e,c,i.get("NO2"),d),this.nc2Bridge=mt(e,c,i.get("NC2"),d);var h=e.createEvent((function(){a.currentState=a.nextState,a.updatePoles()})),v=function(){var t=o.driven&&u.driven&&o.value!=u.value,e=t?5e6:15e6;a.nextState=t,t!==a.currentState&&h.schedule(e)};o.onStateChange(v),u.onStateChange(v),this.updatePoles()}return(0,a.Z)(t,[{key:"updatePoles",value:function(){var t=this.currentState;this.no1Bridge.connected=t,this.no2Bridge.connected=t,this.nc1Bridge.connected=!t,this.nc2Bridge.connected=!t}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.currentState=!1,this.nextState=!1,this.updatePoles()}}]),t}();function Ye(t){switch(t.state){case X.J.High:return X.J.PullUp;case X.J.Low:return X.J.PullDown;default:return X.J.HighZ}}(0,s.Z)($e,"pinNames",["COIL1","COIL2","P1","NO1","NC1","P2","NO2","NC2"]);var ti=function(){function t(e,i){(0,r.Z)(this,t);var n=i.get("1"),a=i.get("2");n.setState(Ye(a)),a.setState(Ye(n)),n.onStateChange((function(){a.setState(Ye(n))})),a.onStateChange((function(){n.setState(Ye(a))}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(ti,"pinNames",["1","2"]);var ei=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"r",void 0),(0,s.Z)(this,"g",void 0),(0,s.Z)(this,"b",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"attrs",void 0),this.clock=e,this.attrs=n,this.value={r:0,g:0,b:0};var a="cathode"===n.get("common"),o=i.get("COM");this.r=this.createLED(i.get("R"),o,a),this.g=this.createLED(i.get("G"),o,a),this.b=this.createLED(i.get("B"),o,a)}return(0,a.Z)(t,[{key:"createLED",value:function(t,e,i){var n=new Map;n.set("A",i?t:e),n.set("C",i?e:t);var r=new Map,a=this.attrs.get("fps");return a&&r.set("fps",a),new W(this.clock,n,r)}},{key:"update",value:function(){var t=this.r.update(),e=this.g.update(),i=this.b.update();return t&&(this.value.r=t.value),e&&(this.value.g=e.value),i&&(this.value.b=i.value),t||e||i?{value:this.value}:null}},{key:"reset",value:function(){this.r.reset(),this.g.reset(),this.b.reset()}}]),t}();(0,s.Z)(ei,"pinNames",["COM","R","G","B"]);var ii=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"dialing",void 0),(0,s.Z)(this,"pulsing",void 0),(0,s.Z)(this,"pulses",void 0),(0,s.Z)(this,"dial",void 0),(0,s.Z)(this,"pulse",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.dialing=!1,this.pulsing=!1,this.pulses=0,this.value="",this.dial=i.get("DIAL"),this.pulse=i.get("PULSE")}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.dial,e=this.pulse;return this.dialing&&(this.pulses?this.pulsing?(e.setState(X.J.HighZ),this.pulsing=!1,this.pulses--):(e.setState(X.J.Low),this.pulsing=!0):(t.setState(X.J.HighZ),this.dialing=!1)),null}},{key:"reset",value:function(){this.dialing=!1,this.pulsing=!1}},{key:"onEvent",value:function(t){var e=t.digit;this.dial.setState(X.J.Low),this.pulses=e>0?e:10,this.dialing=!0,this.pulsing=!1}}]),t}();(0,s.Z)(ii,"pinNames",["GND","DIAL","PULSE"]);var ni=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];function ri(t){for(var e=0,i=0;i<t.length;i++)e=ni[255&(e>>8^t[i])]^e<<8;return 65535&e}var ai,si,oi,ui,li,ci=512;!function(t){t[t.Ready=0]="Ready",t[t.Command=1]="Command",t[t.Write=2]="Write",t[t.WriteData=3]="WriteData"}(ai||(ai={})),function(t){t[t.GO_IDLE_STATE=0]="GO_IDLE_STATE",t[t.SEND_OP_COND=1]="SEND_OP_COND",t[t.SEND_IF_COND=8]="SEND_IF_COND",t[t.SEND_CSD=9]="SEND_CSD",t[t.SEND_CID=10]="SEND_CID",t[t.STOP_TRANSMISSION=12]="STOP_TRANSMISSION",t[t.SEND_STATUS=13]="SEND_STATUS",t[t.SET_BLOCKLEN=16]="SET_BLOCKLEN",t[t.READ_SINGLE_BLOCK=17]="READ_SINGLE_BLOCK",t[t.READ_MULTIPLE_BLOCK=18]="READ_MULTIPLE_BLOCK",t[t.SET_BLOCK_COUNT=23]="SET_BLOCK_COUNT",t[t.WRITE_BLOCK=24]="WRITE_BLOCK",t[t.WRITE_MULTIPLE_BLOCK=25]="WRITE_MULTIPLE_BLOCK",t[t.APP_CMD=55]="APP_CMD",t[t.READ_OCR=58]="READ_OCR",t[t.CRC_ON_OFF=59]="CRC_ON_OFF",t[t.INVALID=255]="INVALID"}(si||(si={})),function(t){t[t.SET_WR_BLOCK_ERASE_COUNT=23]="SET_WR_BLOCK_ERASE_COUNT",t[t.APP_SEND_OP_COND=41]="APP_SEND_OP_COND",t[t.APP_CLR_CARD_DETECT=42]="APP_CLR_CARD_DETECT",t[t.APP_SEND_SCR=51]="APP_SEND_SCR"}(oi||(oi={})),function(t){t[t.Idle=1]="Idle",t[t.CRCError=8]="CRCError"}(ui||(ui={})),function(t){t[t.OutOfRange=128]="OutOfRange"}(li||(li={}));var di=254,hi=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"currentCommand",void 0),(0,s.Z)(this,"commandBuffer",void 0),(0,s.Z)(this,"commandBufferIndex",void 0),(0,s.Z)(this,"responseBuffer",void 0),(0,s.Z)(this,"responseBufferIndex",void 0),(0,s.Z)(this,"responseBufferCount",void 0),(0,s.Z)(this,"appCommand",void 0),(0,s.Z)(this,"idle",void 0),(0,s.Z)(this,"writeAddress",void 0),(0,s.Z)(this,"writeBuffer",void 0),(0,s.Z)(this,"writeBufferIndex",void 0),(0,s.Z)(this,"crcEnabled",void 0),(0,s.Z)(this,"r2Value",void 0),(0,s.Z)(this,"processByte",void 0),(0,s.Z)(this,"spi",void 0),(0,s.Z)(this,"storage",void 0),this.spi=e,this.storage=i,this.state=ai.Ready,this.currentCommand=si.INVALID,this.commandBuffer=new Uint8Array(5),this.commandBufferIndex=0,this.responseBuffer=new Uint8Array(1024),this.responseBufferIndex=0,this.responseBufferCount=0,this.appCommand=!1,this.idle=!0,this.writeAddress=0,this.writeBuffer=new Uint8Array(514),this.writeBufferIndex=0,this.crcEnabled=!1,this.r2Value=0,this.processByte=function(t){switch(n.state){case ai.Ready:64===(192&t)&&(n.currentCommand=63&t,n.commandBufferIndex=0,n.state=ai.Command);break;case ai.Command:n.commandBuffer[n.commandBufferIndex++]=t,n.commandBufferIndex===n.commandBuffer.length&&(n.state=ai.Ready,n.processCommand());break;case ai.Write:t===di?(n.state=ai.WriteData,n.writeBufferIndex=0):255!==t&&(n.state=ai.Ready);break;case ai.WriteData:if(n.writeBuffer[n.writeBufferIndex++]=t,n.writeBufferIndex===n.writeBuffer.length){var e=n.writeBuffer.subarray(0,ci),i=n.writeBuffer[512]<<8|n.writeBuffer[513];n.state=ai.Ready,n.r2Value=0,n.crcEnabled&&i!==ri(e)?n.respond([11]):n.writeAddress>=n.storage.blockCount?(n.r2Value=li.OutOfRange,n.respond([13])):(n.storage.writeBlock(n.writeAddress,e),n.respond([5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255]))}}n.responseBufferIndex<n.responseBufferCount?(n.spi.sendByte(n.responseBuffer[n.responseBufferIndex]),n.responseBufferIndex++):n.spi.sendByte(255)},e.onTransmit=this.processByte}return(0,a.Z)(t,[{key:"R1Flags",get:function(){return this.idle?ui.Idle:0}},{key:"uintParam",get:function(){return(this.commandBuffer[0]<<24|this.commandBuffer[1]<<16|this.commandBuffer[2]<<8|this.commandBuffer[3])>>>0}},{key:"crcCheck",value:function(){var t=this.commandBuffer,e=function(t){for(var e=0,i=0;i<t.length;i++)for(var n=t[i],r=0;r<8;r++)128&n^128&(e<<=1)&&(e^=9),n<<=1;return 127&e}([64|this.currentCommand,t[0],t[1],t[2],t[3]]);return t[4]===(e<<1|1)}},{key:"respond",value:function(t){this.responseBuffer.set(t),this.responseBufferIndex=0,this.responseBufferCount=t.length}},{key:"processCommand",value:function(){if(!this.crcEnabled||this.crcCheck()){if(this.appCommand)return this.appCommand=!1,void this.processAppCommand();switch(this.currentCommand){case si.GO_IDLE_STATE:if(this.idle=!0,!this.crcCheck())return void this.respond([255,this.R1Flags|ui.CRCError]);this.respond([255,this.R1Flags]);break;case si.SEND_IF_COND:if(!this.crcCheck())return void this.respond([255,this.R1Flags|ui.CRCError,0,0,0,0]);var t=this.commandBuffer[3];this.respond([255,this.R1Flags,0,0,1,t]);break;case si.READ_OCR:this.respond([255,this.R1Flags,192,255,128,0]);break;case si.SEND_CSD:this.respond([255,this.R1Flags,di].concat((0,d.Z)(this.csd)));break;case si.SEND_CID:this.respond([255,this.R1Flags,di].concat((0,d.Z)(this.cid)));break;case si.SEND_STATUS:this.respond([255,this.R1Flags,this.r2Value]);break;case si.APP_CMD:this.appCommand=!0,this.respond([255,this.R1Flags]);break;case si.CRC_ON_OFF:this.crcEnabled=!!(1&this.commandBuffer[3]),this.respond([255,this.R1Flags]);break;case si.STOP_TRANSMISSION:this.respond([255,this.R1Flags]);break;case si.READ_SINGLE_BLOCK:case si.READ_MULTIPLE_BLOCK:var e=this.uintParam;if(e>=this.storage.blockCount)return void this.respond([255,this.R1Flags,128]);this.respond([255,this.R1Flags,255,255,255,255,di]);var i=this.storage.readBlock(e),n=ri(i);this.responseBuffer.set(i,this.responseBufferCount),this.responseBufferCount+=512,this.responseBuffer[this.responseBufferCount++]=n>>8,this.responseBuffer[this.responseBufferCount++]=255&n;break;case si.WRITE_BLOCK:this.writeAddress=this.uintParam,this.respond([255,this.R1Flags]),this.state=ai.Write;break;default:console.warn("Unimplemented SD Command: 0x".concat(this.currentCommand.toString(16)))}}else this.respond([255,this.R1Flags|ui.CRCError])}},{key:"processAppCommand",value:function(){switch(this.currentCommand){case oi.APP_SEND_OP_COND:this.idle=!1,this.respond([255,this.R1Flags]);break;case oi.APP_CLR_CARD_DETECT:this.respond([255,this.R1Flags]);break;case oi.APP_SEND_SCR:this.respond([255,this.R1Flags,di].concat((0,d.Z)(this.scr)));break;default:console.warn("Unimplemented SD APP Command: 0x".concat(this.currentCommand.toString(16)))}}},{key:"csd",get:function(){var t=Math.ceil(this.storage.blockCount/1024)-1,e=new Uint8Array(18);return e[0]=64,e[1]=14,e[2]=0,e[3]=90,e[4]=91,e[5]=9,e[6]=0,e[7]=t>>16&255,e[8]=t>>8&255,e[9]=255&t,e[10]=64,e[11]=128,e[12]=10,e[13]=64,e[14]=0,e[15]=0,e[16]=137,e[17]=49,e}},{key:"cid",get:function(){var t=new Uint8Array(18);return t[0]=66,t[1]=67,t[2]=77,t[3]=87,t[4]=79,t[5]=75,t[6]=87,t[7]=73,t[8]=16,t[9]=254,t[10]=202,t[11]=254,t[12]=202,t[13]=1,t[14]=185,t[15]=0,t[16]=82,t[17]=162,t}},{key:"scr",get:function(){return new Uint8Array([0,0,0,0,0,0,0,0,0,0])}}]),t}(),vi=16384,fi=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"data",new Uint8Array(8388608)),(0,s.Z)(this,"sdcardProtocol",void 0),(0,s.Z)(this,"blockCount",vi);var n=new k.g({mosi:i.get("DI"),miso:i.get("DO"),clk:i.get("SCK"),ss:i.get("CS")},0,!0);this.sdcardProtocol=new hi(n,this)}return(0,a.Z)(t,[{key:"init",value:function(e){var i=e.files,r=this;return(0,n.Z)((function(){var e;return(0,h.__generator)(this,(function(n){switch(n.label){case 0:return(null===(e=t.files)||void 0===e?void 0:e.length)?[4,r.initFS(t.files)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,r.initFS(i)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))()}},{key:"initFS",value:function(t){var e=this;return(0,n.Z)((function(){return(0,h.__generator)(this,(function(n){switch(n.label){case 0:return[4,Promise.all([i.e(4102),i.e(9829)]).then(i.bind(i,59829))];case 1:return[4,(0,n.sent().makeFatFS)({flash:e.data,numBlocks:vi,blockSize:ci,noFat12:!0},t)];case 2:return n.sent(),[2]}}))}))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}},{key:"readBlock",value:function(t){return this.data.subarray(t*ci,(t+1)*ci)}},{key:"writeBlock",value:function(t,e){this.data.set(e,t*ci)}}]),t}();(0,s.Z)(fi,"pinNames",["CS","SCK","DI","DO","CD"]),(0,s.Z)(fi,"files",void 0);var pi=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"currentPromise",null),(0,s.Z)(this,"currentController",null),e.subscribe((function(t){var e,n,r;null===(e=i.currentController)||void 0===e||e.enqueue(t),null===(r=(n=i).currentPromise)||void 0===r||r.call(n),i.currentPromise=null}))}return(0,a.Z)(t,[{key:"pull",value:function(t){var e=this;return new Promise((function(i){e.currentController=t,e.currentPromise=i}))}},{key:"cancel",value:function(){var t;this.currentController=null,null===(t=this.currentPromise)||void 0===t||t.call(this),this.currentPromise=null}}]),t}(),gi=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"queue",void 0),(0,s.Z)(this,"sendNextByte",void 0),(0,s.Z)(this,"encoder",void 0),this.encoder=e,this.queue=[],this.sendNextByte=function(){var t=i.queue.shift();null!=t&&i.encoder.transmit(t)},e.onTxComplete=this.sendNextByte}return(0,a.Z)(t,[{key:"write",value:function(t){var e;(e=this.queue).push.apply(e,(0,d.Z)(t)),this.encoder.isBusy||this.sendNextByte()}}]),t}(),yi=function(){function t(e,i,n){var a;(0,r.Z)(this,t),(0,s.Z)(this,"abort",new AbortController),(0,s.Z)(this,"cleanup",null),(0,s.Z)(this,"encoder",void 0),(0,s.Z)(this,"decoder",void 0);var o=parseInt(null!==(a=n.get("baud"))&&void 0!==a?a:"",10)||9600;this.encoder=new P.x(e,i.get("TX"),o),this.decoder=new x.g(e,i.get("RX"),o),this.initSerial(o).catch(console.error)}return(0,a.Z)(t,[{key:"initSerial",value:function(t){var e=this;return(0,n.Z)((function(){var i,r,a,s;return(0,h.__generator)(this,(function(o){switch(o.label){case 0:if("undefined"===typeof navigator.serial)throw new Error("Serial API not supported in this browser");return[4,navigator.serial.requestPort({})];case 1:return(i=o.sent()).addEventListener("disconnect",(function(){e.cleanup=null})),i.readable?[3,3]:[4,i.open({baudRate:t})];case 2:o.sent(),o.label=3;case 3:return i.writable&&(a=null===(r=i.readable)||void 0===r?void 0:r.pipeTo(new WritableStream(new gi(e.encoder)),{signal:e.abort.signal}).catch((function(){})),s=new ReadableStream(new pi(e.decoder)).pipeTo(i.writable,{signal:e.abort.signal}).catch((function(){})),e.cleanup=(0,n.Z)((function(){return(0,h.__generator)(this,(function(t){switch(t.label){case 0:return[4,a];case 1:return t.sent(),[4,s];case 2:return t.sent(),[4,i.close()];case 3:return t.sent(),[2]}}))}))),[2]}}))}))()}},{key:"update",value:function(){return null}},{key:"reset",value:function(){var t=this;return(0,n.Z)((function(){var e,i;return(0,h.__generator)(this,(function(n){return t.abort.abort(),null===(i=(e=t).cleanup)||void 0===i||i.call(e).catch(console.error),t.cleanup=null,[2]}))}))()}}]),t}();(0,s.Z)(yi,"pinNames",["RX","TX","GND"]);var mi=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"angle",90),(0,s.Z)(this,"updated",!0),(0,s.Z)(this,"min",544),(0,s.Z)(this,"max",2400),(0,s.Z)(this,"margin",88),i.get("PWM").onValueChange((function(t,e){var i=e.nanos;if(!t){var r=n.min,a=n.max,s=n.margin,o=i/1e3;if(o<r-s||o>a+s)return;var u=((0,_.u)(o,r,a)-r)/(a-r);n.angle=Math.round(180*u),n.updated=!0}}))}return(0,a.Z)(t,[{key:"update",value:function(){return this.updated?(this.updated=!1,{value:this.angle}):null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(mi,"pinNames",["PWM"]);var wi=["A","B","C","D","E","F","G","DP"],ki=["DIG1","DIG2","DIG3","DIG4"],Zi=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"leds",void 0),(0,s.Z)(this,"colonLed",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.leds=[],this.value={segments:[],colon:0};var a=wi.map((function(t){return i.get(t)})),o=ki.map((function(t){return i.attached(t)?i.get(t):null})),u="cathode"===n.get("common"),l=u?"C":"A",c=u?"A":"C";o[0]||(o[0]=i.get("COM"));for(var d=0;d<o.length;d++){var h=o[d];if(h)for(var v=0;v<a.length;v++){var f=a[v],p=new Map;p.set(l,h),p.set(c,f),this.leds[d*a.length+v]=new W(e,p,n)}}var g=i.get("CLN"),y=i.get("COM"),m=new Map;m.set(l,y),m.set(c,g),this.colonLed=new W(e,m,n)}return(0,a.Z)(t,[{key:"update",value:function(){for(var t=!1,e=0;e<this.leds.length;e++){var i,n=null===(i=this.leds[e])||void 0===i?void 0:i.update();n&&(this.value.segments[e]=n.value,t=!0)}var r=this.colonLed.update();return r&&(this.value.colon=r.value,t=!0),t?{value:this.value}:null}},{key:"reset",value:function(){var t,e=!0,i=!1,n=void 0;try{for(var r,a=this.leds[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;null===s||void 0===s||s.reset()}}catch(o){i=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}null===(t=this.colonLed)||void 0===t||t.reset()}}]),t}();(0,s.Z)(Zi,"pinNames",(0,d.Z)(wi).concat((0,d.Z)(ki),["COM","CLN"]));var bi=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"bridge1",void 0),(0,s.Z)(this,"bridge2",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var a,o=i.get("1"),u=i.get("2"),l=i.get("3"),c=1===parseInt(null!==(a=n.get("value"))&&void 0!==a?a:"0",10),d="0"!==n.get("bounce");this.bridge1=mt(e,o,u,d),this.bridge1.connected=!c,this.bridge2=mt(e,u,l,d),this.bridge2.connected=c}return(0,a.Z)(t,[{key:"onEvent",value:function(t){var e=this.bridge1,i=this.bridge2,n=t.value?e:i,r=t.value?i:e;n.connected=!1;var a=(0,o.Z)(n,yt)?n.bounceDuration:0;this.clock.addEvent(a+42e4,(function(){r.connected=!0}))}},{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(bi,"pinNames",["1","2","3"]);var Ci=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"ws2812Decoder",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.get("DIN"),a=i.get("DOUT");this.ws2812Decoder=new et(n,e,a),this.ws2812Decoder.resize(256)}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.ws2812Decoder.update();return t?{value:t.slice(0,256)}:null}},{key:"reset",value:function(){var t;null===(t=this.ws2812Decoder)||void 0===t||t.reset()}}]),t}();(0,s.Z)(Ci,"pinNames",["DIN","VDD","VSS","DOUT"]);var _i,Si=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"decoder",void 0),(0,s.Z)(this,"value",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.value={ledPower:1,ledRed:0,ledGreen:0,ledBlue:.1},this.decoder=new Z({clock:i.get("$APA_CLK"),data:i.get("$APA_DATA"),ss:i.get("$APA_PWR")})}return(0,a.Z)(t,[{key:"update",value:function(){var t=this.decoder.update();if(t){var e=t[0],i=(e>>>24)/255,n=e>>16&255,r=e>>8&255,a=255&e;return this.value.ledRed=Math.pow(a/256*i,.5),this.value.ledGreen=Math.pow(r/256*i,.5),this.value.ledBlue=Math.pow(n/256*i,.5),{value:this.value}}return null}},{key:"reset",value:function(t){this.value.ledRed=0,this.value.ledGreen=0,this.value.ledBlue=0,t&&(this.value.ledPower=0)}}]),t}();(0,s.Z)(Si,"pinNames",["$APA_PWR","$APA_CLK","$APA_DATA","GND"]),function(t){t[t.Idle=0]="Idle",t[t.Active=1]="Active",t[t.Ack=2]="Ack"}(_i||(_i={}));var xi=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"updated",!1),(0,s.Z)(this,"bytes",new Uint8Array(4)),(0,s.Z)(this,"segments",new Uint8Array(32)),(0,s.Z)(this,"state",_i.Idle),(0,s.Z)(this,"clockIndex",0),(0,s.Z)(this,"incomingByte",0),(0,s.Z)(this,"isCommand",!0),(0,s.Z)(this,"addrAuto",!1),(0,s.Z)(this,"addr",0),(0,s.Z)(this,"on",!1),(0,s.Z)(this,"brightness",0);var a=i.get("CLK"),o=i.get("DIO");a.setState(X.J.PullUp),o.setState(X.J.PullUp),o.onValueChange((function(t){a.value&&!t&&(n.state=_i.Active,n.clockIndex=0,n.incomingByte=0),a.value&&t&&n.state!==_i.Ack&&(n.state=_i.Idle,n.isCommand=!0)})),a.onValueChange((function(t){if(t&&n.state===_i.Active)return n.incomingByte>>=1,n.incomingByte|=o.value?128:0,n.clockIndex++,void(8===n.clockIndex&&(n.isCommand?n.processCommand(n.incomingByte):n.processData(n.incomingByte),n.isCommand=!1,n.state=_i.Ack,n.clockIndex=0,n.incomingByte=0));n.state==_i.Ack&&(o.setState(t?X.J.PullUp:X.J.PullDown),t&&(n.state=_i.Active))}))}return(0,a.Z)(t,[{key:"processCommand",value:function(t){if(128!==(192&t))if(192!==(192&t))switch(t){case 64:this.addrAuto=!0;break;case 68:this.addrAuto=!1}else this.addr=15&t;else{var e=!!(8&t),i=7&t;e===this.on&&i===this.brightness||(this.on=e,this.brightness=i,this.updated=!0)}}},{key:"processData",value:function(t){this.addr<4&&this.bytes[this.addr]!==t&&(this.bytes[this.addr]=t,this.updated=!0),this.addrAuto&&(this.addr=(this.addr+=1)%15)}},{key:"update",value:function(){if(this.updated){this.updated=!1;for(var t=!1,e=0;e<4;e++){for(var i=0;i<7;i++)this.segments[8*e+i]=this.bytes[e]&1<<i?1:0;128&this.bytes[e]&&(t=!0)}return this.on||(this.segments.fill(0),t=!1),{value:{segments:this.segments,colon:t,brightness:this.normalizedBrightness}}}return null}},{key:"normalizedBrightness",get:function(){switch(this.brightness){case 0:return.5;case 1:return.7;default:return 1}}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(xi,"pinNames",["CLK","DIO"]);var Pi=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"clock",void 0),this.clock=e;var n=i.get("IN"),a=i.get("EN"),o=i.get("OUT");z([n,a],(function(){return a.value?n.value?X.J.High:X.J.Low:X.J.HighZ}),(function(t){return o.setState(t)}))}return(0,a.Z)(t,[{key:"update",value:function(){return null}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Pi,"pinNames",["IN","EN","OUT"]);var Ii=768,Di=4278190080,Ai=64e3,Ri=function(){function t(e,i){var n=this;(0,r.Z)(this,t),(0,s.Z)(this,"lineStart",0),(0,s.Z)(this,"oddField",!1),(0,s.Z)(this,"y",0),(0,s.Z)(this,"lastX",0),(0,s.Z)(this,"pixels",new Uint32Array(442368)),(0,s.Z)(this,"lastSync",0),(0,s.Z)(this,"lastVSync",0),(0,s.Z)(this,"nextColor",Di);var a=i.get("IN");i.get("SYNC").onValueChange((function(t){if(t){var i=e.cpuNanos-n.lastSync;if(i>3200&&i<5800){n.y>=0&&n.pixels.fill(n.nextColor,n.y*Ii+n.lastX,(n.y+1)*Ii);var r=e.cpuNanos-n.lastVSync,a=n.oddField?0:1;n.y=2*Math.round(r/Ai-22)+a,n.lineStart=e.cpuNanos+4700+5200,n.lastX=0}if(i>17e3&&i<62e3)e.cpuNanos-n.lastVSync>64e4&&(n.lastX=0,n.oddField=!n.oddField,n.lastVSync=e.cpuNanos)}n.lastSync=e.cpuNanos})),this.pixels.fill(Di),a.onValueChange((function(t){var i=e.cpuNanos-n.lineStart;if(i>0&&n.y>=0){var r=Math.min(i/51900*Ii*1.0909,Ii),a=n.y*Ii;n.pixels.fill(n.nextColor,a+n.lastX,a+r),n.lastX=r}n.nextColor=t?4294967295:Di}))}return(0,a.Z)(t,[{key:"update",value:function(){return{value:{pixels:this.pixels}}}},{key:"reset",value:function(){}}]),t}();(0,s.Z)(Ri,"pinNames",["IN","SYNC","GND"]);var Bi={"wokwi-analog-joystick":wt,"wokwi-dht22":Ft,"wokwi-led":W,"wokwi-neopixel":Le,"wokwi-led-ring":Le,"wokwi-buzzer":Bt,"wokwi-led-matrix":Me,"wokwi-lcd1602":ge,"wokwi-lcd2004":ye,"wokwi-neopixel-meter":Ce,"wokwi-arduino-uno":bt,"wokwi-arduino-mega":bt,"wokwi-arduino-nano":bt,"wokwi-esp32-devkit-v1":qt,"wokwi-franzininho":Xt,"wokwi-mpu6050":Oe._,"wokwi-midi-player":Ne,"wokwi-ir-receiver":ae,"wokwi-ir-remote":se,"wokwi-il9163":ne,"wokwi-ili9341":J,"wokwi-pi-pico":Ge,"wokwi-pir-motion-sensor":ze,"wokwi-pushbutton":Qe,"wokwi-microsd-card":fi,"wokwi-slide-switch":bi,"wokwi-servo":mi,"wokwi-ssd1306":G,"wokwi-max7219-matrix":Re,"wokwi-microphone":Ue,"wokwi-neopixel-matrix":Me,"wokwi-neopixel-canvas":Me,"wokwi-neopixel-strip":Le,"wokwi-neopixel-serial":Le,"wokwi-ntc-temperature-sensor":Je,"wokwi-potentiometer":Xe,"wokwi-slide-potentiometer":Xe,"wokwi-hc-sr04":jt,"wokwi-ds1307":Kt,"wokwi-membrane-keypad":Ee,"wokwi-resistor":ti,"wokwi-rotary-dialer":ii,"wokwi-7segment":Zi,"wokwi-74hc165":Qt,"wokwi-74hc595":$t,"wokwi-nlsf595":Fe,"wokwi-tv":Ri,"wokwi-logic-analyzer":Pe,"wokwi-splendida":Ci,"wokwi-photoresistor-sensor":qe.l,"wokwi-ky-040":ue,"wokwi-rgb-led":ei,"wokwi-serial-port":yi,"wokwi-tinypico":Si,"wokwi-hub75-matrix":te.al,"wokwi-apa102-matrix":Zt,"wokwi-led-bar-graph":me,"wokwi-dip-switch-8":Jt,"wokwi-pcf8574":Ke,"wokwi-hx711":ee.j,"wokwi-ks2e-m-dc5":$e,"wokwi-stepper-motor":It,"wokwi-a4988":ft,"wokwi-esp-01":T,"wokwi-gnd":je,"wokwi-vcc":je,"wokwi-gate-not":Ie((function(t){return!(0,c.Z)(t,1)[0].value}),["IN"]),"wokwi-gate-buffer":Ie((function(t){return(0,c.Z)(t,1)[0].value}),["IN"]),"wokwi-gate-and-2":Ie((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return i.value&&n.value})),"wokwi-gate-or-2":Ie((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return i.value||n.value})),"wokwi-gate-xor-2":Ie((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return i.value!=n.value})),"wokwi-gate-nand-2":Ie((function(t){var e=(0,c.Z)(t,2),i=e[0],n=e[1];return!(i.value&&n.value)})),"wokwi-mux-2":Ie((function(t){var e=(0,c.Z)(t,3),i=e[0],n=e[1];return e[2].value?n.value:i.value}),["A","B","SEL"]),"wokwi-tristate-buffer":Pi,"wokwi-flip-flop-d":Gt,"wokwi-flip-flop-sr":zt,"wokwi-flip-flop-dsr":Gt,"wokwi-clock-generator":Et,"wokwi-tm1637-7segment":xi,"wokwi-biaxial-stepper":Dt,"wokwi-relay-module":Nt},Ti="https://wokwi.com/api/external/chips",Ei="wokwi-custom-board",Ui=["esp32-devkit-v1","esp-01","franzininho-wifi","ili9341-cap-touch","ssd1306","pi-pico","notecarrier-a","esp32-devkit-c-v4","esp32-c3-devkitm-1","esp32-c3-rust-1","esp32-c6-devkitc-1","esp32-s2-devkitm-1","esp32-s3-devkitc-1","mch2022-badge","st-nucleo-l432kc","stm32-bluepill","wemos-s2-mini","ds18b20","epaper-2in9","tt-block-input","tt-block-input-8","tt-block-output","tt-block-bidirectional-io"],Ni=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"boards",{}),(0,s.Z)(this,"chips",{}),(0,s.Z)(this,"loading",{}),(0,v.ky)(this)}return(0,a.Z)(t,[{key:"loadFromUrl",value:function(t){var e=this;return(0,n.Z)((function(){var i,n,r,a,s,o,u,l,c;return(0,h.__generator)(this,(function(d){switch(d.label){case 0:return i="".concat("https://wokwi.github.io/wokwi-boards/boards","/").concat(t),n="".concat(i,"/board.svg"),[4,fetch("".concat(i,"/board.json?v=11"))];case 1:return[4,d.sent().text()];case 2:return r=d.sent(),a="board-".concat(t),s=ct(a,r,n),o=s.board,u=s.svgURL,l=s.adapter,c=s.controller,e.boards[t]={board:o,svgURL:u},dt.j[a]=l,Bi[a]=c,[2]}}))}))()}},{key:"loadUserBoard",value:function(t,e){var i=this;return(0,n.Z)((function(){var n,r,a,s,o;return(0,h.__generator)(this,(function(u){return n=ct(Ei,t,e),r=n.board,a=n.svgURL,s=n.adapter,o=n.controller,i.boards[Ei]={board:r,svgURL:a},dt.j[Ei]=s,Bi[Ei]=o,[2]}))}))()}},{key:"loadBoards",value:function(t){var e=this;return(0,n.Z)((function(){var i,n,r,a,s,o,u;return(0,h.__generator)(this,(function(l){switch(l.label){case 0:i=[],n=!0,r=!1,a=void 0;try{for(s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)(u=o.value)in e.boards||i.push(e.loadFromUrl(u))}catch(c){r=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return[4,Promise.all(i)];case 1:return l.sent(),[2]}}))}))()}},{key:"isBoardType",value:function(t){return t.startsWith("board-")||t===Ei}},{key:"get",value:function(t){var e=this;if(!this.isBoardType(t))throw new Error("Invalid board type: ".concat(t));var i=t.replace(/^board-/,""),n=this.boards[i];return n||this.loading[t]||!Ui.includes(i)||(this.loading[t]=!0,this.loadFromUrl(i).then((function(){e.loading[t]=!1}))),n}},{key:"getBoardChips",value:function(t){if(!this.isBoardType(t))return[];var e=this.get(t);return((null===e||void 0===e?void 0:e.board.chips)||[]).filter((function(t){return t.type.includes(":")}))}},{key:"getChip",value:function(t){var e=this,i=this.chips[t],n="".concat(Ti,"/").concat(encodeURIComponent(t));return i||this.loading[t]||(this.loading[t]=!0,fetch("".concat(n,"/chip.json")).then((function(t){return t.text()})).then((function(i){e.chips[t]=i,e.loading[t]=!1}))),i}},{key:"loaded",get:function(){return!Object.values(this.loading).some((function(t){return t}))}}]),t}(),Oi=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"_callstack",[]),(0,s.Z)(this,"locals",[]),(0,s.Z)(this,"globals",[]),(0,v.ky)(this)}return(0,a.Z)(t,[{key:"evaluateVars",value:function(t,e,i){var n,r,a;return i.map((function(i){var s,o;return{type:null!==(n=null===(s=i.type)||void 0===s?void 0:s.name)&&void 0!==n?n:"unknown",name:null!==(r=i.name)&&void 0!==r?r:"<unknown>",value:null!==(a=null===(o=t.evaluateVariable(i,e))||void 0===o?void 0:o.toString())&&void 0!==a?a:"<unavailable>"}}))}},{key:"formatFilename",value:function(t){return t.startsWith("/tmp/")?t.split("/").slice(4).join(""):t}},{key:"update",value:function(t){var e,i;this._callstack=Array.from(t.backtrace());var n,r=t.target.PC,a=null!==(n=null===(e=this._callstack[0])||void 0===e||null===(i=e.func)||void 0===i?void 0:i.getLocals())&&void 0!==n?n:[];this.locals=this.evaluateVars(t,r,Array.from(a)),this.globals=this.evaluateVars(t,r,Array.from(t.getGlobals()))}},{key:"callstack",get:function(){var t,e=this,i=this._callstack.map((function(i){var n;return{pc:i.pc,file:i.file&&e.formatFilename(i.file),line:i.line,column:i.column,function:null!==(t=null===(n=i.func)||void 0===n?void 0:n.name)&&void 0!==t?t:"<unknown>"}}));if(0===i.length)return i;var n=i[i.length-1];return null==n.file&&"<unknown>"===n.function?i.slice(0,-1):i}}]),t}(),Mi=i(81564),Li=i(22560),Vi=i(21831),Fi=i(74372),Ji=i(84104),Wi="https://wokwi.github.io/wokwi-circuitpython-libraries",Hi="".concat(Wi,"/packages/7.x-mpy");function Ki(t,e){for(var i=[],n=new DataView(e),r=new TextDecoder,a=0;a<e.byteLength;){if(2003529559!==n.getUint32(a,!0)||810697065!==n.getUint32(a+4,!0))return console.error("Error extracting library ".concat(t,": Bad magic!")),i;a+=8;var s=n.getUint16(a,!0);a+=4;var o=n.getUint32(a,!0);a+=4;var u=r.decode(new Uint8Array(e,a,s));a+=s;var l=new Uint8Array(e,a,o);a+=o,i.push({name:"".concat("lib/").concat(u),content:l})}return i}function qi(t){return Gi.apply(this,arguments)}function Gi(){return(Gi=(0,n.Z)((function(t){var e,i,n;return(0,h.__generator)(this,(function(r){switch(r.label){case 0:return i=t.map((function(t){return fetch("".concat(Hi,"/").concat(t,".mpylib")).then((function(t){return t.arrayBuffer()})).then((function(e){return Ki(t,e)}))})),[4,Promise.all(i)];case 1:return n=r.sent(),[2,(e=[]).concat.apply(e,(0,d.Z)(n))]}}))}))).apply(this,arguments)}function zi(t){return Xi.apply(this,arguments)}function Xi(){return Xi=(0,n.Z)((function(t){var e,i,n,r;return(0,h.__generator)(this,(function(a){switch(a.label){case 0:return e=function(){var t,e=r.shift()||"",a=n.find((function(t){return t.name===e}));if(!a)throw new Error("Library not found in index: ".concat(e));var s=!0,o=!1,u=void 0;try{for(var l,c=(null!==(t=null===a||void 0===a?void 0:a.deps)&&void 0!==t?t:[])[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var d=l.value;i.has(d)||i.add(d)}}catch(h){o=!0,u=h}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}},(i=new Set(t.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length&&!t.startsWith("#")})))).size?[4,fetch("".concat(Wi,"/index.json"))]:[2,[]];case 1:return[4,a.sent().json()];case 2:for(n=a.sent().libs,r=Array.from(i);r.length>0;)e();return[2,qi(Array.from(i))]}}))})),Xi.apply(this,arguments)}var ji=i(26783),Qi=i(95863),$i=i(56498),Yi=i(53124),tn=i(49006),en=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"outputEnable",void 0),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"onChange",void 0),this.name=e,this.onChange=i,this.outputEnable=!1}return(0,a.Z)(t,[{key:"attach",value:function(t){t.state=X.J.PullUp,t.onValueChange(this.onChange)}}]),t}(),nn=i(99941),rn=i(26017);var an=i(99569),sn=i(3776),on=new WeakMap,un=new WeakMap,ln=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"master",void 0),(0,U.Z)(this,on,{writable:!0,value:void 0}),(0,U.Z)(this,un,{writable:!0,value:void 0}),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"twi",void 0),(0,s.Z)(this,"avrPins",void 0),this.clock=e,this.twi=i,this.avrPins=n,(0,N.Z)(this,on,!1),(0,N.Z)(this,un,{scl:new X.U(new an.Y(this.clock),"$dummy:$scl"),sda:new X.U(new an.Y(this.clock),"$dummy:$sda")}),this.master=new sn.n(e,(0,E.Z)(this,un)),i.eventHandler=this}return(0,a.Z)(t,[{key:"gate",value:function(t){this.avrPins.scl&&(this.avrPins.scl.gated=t),this.avrPins.sda&&(this.avrPins.sda.gated=t)}},{key:"start",value:function(){var t=this;if(!(0,E.Z)(this,on)){var e,i,n=null===(e=this.avrPins.scl)||void 0===e?void 0:e.netPin,r=null===(i=this.avrPins.sda)||void 0===i?void 0:i.netPin;n&&((0,E.Z)(this,un).scl=n),r&&((0,E.Z)(this,un).sda=r),(0,N.Z)(this,on,!0)}this.master.frequency=this.twi.sclFrequency,this.gate(!0),this.master.start((function(){t.twi.completeStart()}))}},{key:"stop",value:function(){var t=this;this.master.stop((function(){t.gate(!1),t.twi.completeStop()}))}},{key:"connectToSlave",value:function(t,e){var i=this;this.master.connect(t,e,(function(t){i.twi.completeConnect(t)}))}},{key:"writeByte",value:function(t){var e=this;this.master.write(t,(function(t){e.twi.completeWrite(t)}))}},{key:"readByte",value:function(t){var e=this;this.master.read(t,(function(t){e.twi.completeRead(t)}))}}]),t}(),cn=i(29182);function dn(t){return t.parityEnabled?t.parityOdd?cn.A.Odd:cn.A.Even:cn.A.None}var hn=new WeakMap,vn=function(){function t(e,i,n){(0,r.Z)(this,t),(0,s.Z)(this,"net",void 0),(0,s.Z)(this,"signals",void 0),(0,U.Z)(this,hn,{writable:!0,value:void 0}),(0,s.Z)(this,"usartIndex",void 0),(0,s.Z)(this,"gated",void 0),(0,s.Z)(this,"runner",void 0),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"config",void 0),this.runner=e,this.name=i,this.config=n,this.net=this.config.net,this.signals=this.config.signals,this.usartIndex=0,this.gated=!1}return(0,a.Z)(t,[{key:"attach",value:function(t){var e=this,i=this.config,n=this.runner,r=i.port,a=i.pin,s=i.signals;(0,N.Z)(this,hn,t),r.addListener((function(){e.gated||(t.state=function(t){switch(t){case Qi.tS.High:return X.J.High;case Qi.tS.Low:return X.J.Low;case Qi.tS.Input:return X.J.HighZ;case Qi.tS.InputPullUp:return X.J.PullUp}}(r.pinState(a)))})),r.setPin(a,t.value),t.onValueChange((function(t){r.setPin(a,t)}));var o=!0,u=!1,l=void 0;try{for(var c,d=this,h=function(){var i=c.value;if("usart"===i.type&&"RX"===i.signal){var r=new x.g(d.runner,t);d.usartIndex=i.bus;var a=n.usart[i.bus],s=a.onConfigurationChange;a.onConfigurationChange=function(){r.baudRate=a.baudRate,r.bits=a.bitsPerChar,r.parity=dn(a),r.stopBits=a.stopBits,e.gated=a.rxEnable,a.rxEnable&&(t.state=X.J.PullUp),null===s||void 0===s||s()},r.subscribe((function(t){a.writeByte(t[0],!0)}))}if("usart"===i.type&&"TX"===i.signal){var o=new P.x(d.runner,t);t.state=X.J.HighZ;var u=!1;d.usartIndex=i.bus;var l=n.usart[i.bus],h=l.onConfigurationChange;l.onConfigurationChange=function(){o.baudRate=l.baudRate,o.bits=l.bitsPerChar,o.parity=dn(l),o.stopBits=l.stopBits,e.gated=l.txEnable,l.txEnable&&!u&&(t.state=X.J.PullUp),u=l.txEnable,null===h||void 0===h||h()},l.onByteTransmit=function(t){o.transmit(t)}}},v=(null!==s&&void 0!==s?s:[])[Symbol.iterator]();!(o=(c=v.next()).done);o=!0)h()}catch(p){u=!0,l=p}finally{try{o||null==v.return||v.return()}finally{if(u)throw l}}var f=n.analogPins.indexOf(this.name);f>=0&&(n.adcPins[f]=t.node.analogPort)}},{key:"netPin",get:function(){return(0,E.Z)(this,hn)}},{key:"peripheralInfo",value:function(){var t,e=!0,i=!1,n=void 0;try{for(var r,a=(null!==(t=this.signals)&&void 0!==t?t:[])[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;if("i2c"===s.type&&this.runner.i2cEnabled())return{name:"I2C",pin:s.signal,index:s.bus};if("spi"===s.type&&this.runner.spiEnabled())return{name:"SPI",pin:s.signal,index:s.bus};if("usart"===s.type&&this.runner.uartEnabled(s.bus,"RX"===s.signal?"rx":"tx"))return{name:"UART",pin:s.signal,index:s.bus}}}catch(o){i=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}return 0!==(~this.config.port.overrideMask&1<<this.config.pin)?{name:"PWM"}:null}},{key:"outputEnable",get:function(){var t=this.config.port.pinState(this.config.pin);return t===Qi.tS.Low||t===Qi.tS.High}}]),t}(),fn=i(16905),pn=function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"master",void 0),(0,s.Z)(this,"initialized",void 0),(0,s.Z)(this,"spiPins",void 0),(0,s.Z)(this,"onTransfer",void 0),(0,s.Z)(this,"transferComplete",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"spi",void 0),(0,s.Z)(this,"avrPins",void 0),this.clock=e,this.spi=i,this.avrPins=n,this.initialized=!1,this.spiPins={mosi:new X.U(new an.Y(this.clock),"$dummy:$mosi"),miso:new X.U(new an.Y(this.clock),"$dummy:$miso"),clk:new X.U(new an.Y(this.clock),"$dummy:$clk")},this.onTransfer=function(t){if(!a.initialized){var e,i,n,r=null===(e=a.avrPins.mosi)||void 0===e?void 0:e.netPin,s=null===(i=a.avrPins.miso)||void 0===i?void 0:i.netPin,o=null===(n=a.avrPins.sck)||void 0===n?void 0:n.netPin;r&&(a.spiPins.mosi=r),s&&(a.spiPins.miso=s),o&&(a.spiPins.clk=o)}var u=1e9/a.spi.spiFrequency/2;return a.master.mode=a.spi.spiMode,a.master.transmit(t,a.transferComplete,u),0},this.transferComplete=function(t){a.spi.completeTransfer(t)},this.master=new fn.v(e,this.spiPins),i.onByte=this.onTransfer};function gn(t){return 36864===(65039&t)||37376===(65039&t)||37902===(65038&t)||37900===(65038&t)}function yn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i+n+(1&t.data[95]),a=255&r;t.data[(496&e)>>4]=a;var s=192&t.data[95];s|=a?0:2,s|=128&a?4:0,s|=(a^n)&(i^a)&128?8:0,s|=s>>2&1^s>>3&1?16:0,s|=256&r?1:0,s|=1&(i&n|n&~a|~a&i)?32:0,t.data[95]=s,t.cycles++,t.pc++}function mn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i+n&255;t.data[(496&e)>>4]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(r^n)&(r^i)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=i+n&256?1:0,a|=1&(i&n|n&~r|~r&i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function wn(t,e){var i=2*((48&e)>>4)+24,n=t.dataView.getUint16(i,!0),r=n+(15&e|(192&e)>>2)&65535;t.dataView.setUint16(i,r,!0);var a=224&t.data[95];a|=r?0:2,a|=32768&r?4:0,a|=~n&r&32768?8:0,a|=a>>2&1^a>>3&1?16:0,a|=~r&n&32768?1:0,t.data[95]=a,t.cycles++,t.cycles++,t.pc++}function kn(t,e){var i=t.data[(496&e)>>4]&t.data[15&e|(512&e)>>5];t.data[(496&e)>>4]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function Zn(t,e){var i=t.data[16+((240&e)>>4)]&(15&e|(3840&e)>>4);t.data[16+((240&e)>>4)]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function bn(t,e){var i=t.data[(496&e)>>4],n=i>>>1|128&i;t.data[(496&e)>>4]=n;var r=224&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=1&i,r|=r>>2&1^1&r?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function Cn(t,e){t.data[95]&=~(1<<((112&e)>>4)),t.cycles++,t.pc++}function _n(t,e){var i=7&e,n=(496&e)>>4;t.data[n]=~(1<<i)&t.data[n]|(t.data[95]>>6&1)<<i,t.cycles++,t.pc++}function Sn(t,e){t.data[95]&1<<(7&e)||(t.pc=t.pc+(((504&e)>>3)-(512&e?64:0)),t.cycles++),t.cycles++,t.pc++}function xn(t,e){t.data[95]&1<<(7&e)&&(t.pc=t.pc+(((504&e)>>3)-(512&e?64:0)),t.cycles++),t.cycles++,t.pc++}function Pn(t,e){t.data[95]|=1<<((112&e)>>4),t.cycles++,t.pc++}function In(t,e){var i=t.data[(496&e)>>4],n=7&e;t.data[95]=191&t.data[95]|(i>>n&1?64:0),t.cycles++,t.pc++}function Dn(t,e){var i=t.progMem[t.pc+1]|(1&e)<<16|(496&e)<<13,n=t.pc+2,r=t.dataView.getUint16(93,!0),a=t.pc22Bits;t.data[r]=255&n,t.data[r-1]=n>>8&255,a&&(t.data[r-2]=n>>16&255),t.dataView.setUint16(93,r-(a?3:2),!0),t.pc=i-1,t.cycles+=a?4:3,t.cycles++,t.pc++}function An(t,e){var i=248&e,n=7&e,r=t.readData(32+(i>>3)),a=1<<n;t.writeData(32+(i>>3),r&~a,a),t.cycles++,t.pc++}function Rn(t,e){var i=(496&e)>>4,n=255-t.data[i];t.data[i]=n;var r=225&t.data[95]|1;r|=n?0:2,r|=128&n?4:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function Bn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i-n,a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=0!==((i^n)&(i^r)&128)?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function Tn(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=t.data[95],a=i-n-(1&r);r=192&r|(!a&&r>>1&1?2:0)|(n+(1&r)>i?1:0),r|=128&a?4:0,r|=(i^n)&(i^a)&128?8:0,r|=r>>2&1^r>>3&1?16:0,r|=1&(~i&n|n&a|a&~i)?32:0,t.data[95]=r,t.cycles++,t.pc++}function En(t,e){var i=t.data[16+((240&e)>>4)],n=15&e|(3840&e)>>4,r=i-n,a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(i^n)&(i^r)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function Un(t,e){if(t.data[(496&e)>>4]===t.data[15&e|(512&e)>>5]){var i=gn(t.progMem[t.pc+1])?2:1;t.pc+=i,t.cycles+=i}t.cycles++,t.pc++}function Nn(t,e){var i=t.data[(496&e)>>4],n=i-1;t.data[(496&e)>>4]=n;var r=225&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=128===i?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function On(t,e){var i=t.pc+1,n=t.dataView.getUint16(93,!0),r=t.data[92];t.data[n]=255&i,t.data[n-1]=i>>8&255,t.data[n-2]=i>>16&255,t.dataView.setUint16(93,n-3,!0),t.pc=(r<<16|t.dataView.getUint16(30,!0))-1,t.cycles+=3,t.cycles++,t.pc++}function Mn(t,e){var i=t.data[92];t.pc=(i<<16|t.dataView.getUint16(30,!0))-1,t.cycles++,t.cycles++,t.pc++}function Ln(t,e){var i=t.data[91];t.data[0]=t.progBytes[i<<16|t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function Vn(t,e){var i=t.data[91];t.data[(496&e)>>4]=t.progBytes[i<<16|t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function Fn(t,e){var i=t.data[91],n=t.dataView.getUint16(30,!0);t.data[(496&e)>>4]=t.progBytes[i<<16|n],t.dataView.setUint16(30,n+1,!0),65535===n&&(t.data[91]=(i+1)%(t.progBytes.length>>16)),t.cycles+=2,t.cycles++,t.pc++}function Jn(t,e){var i=t.data[(496&e)>>4]^t.data[15&e|(512&e)>>5];t.data[(496&e)>>4]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function Wn(t,e){var i=t.data[16+((112&e)>>4)],n=t.data[16+(7&e)],r=i*n<<1;t.dataView.setUint16(0,r,!0),t.data[95]=252&t.data[95]|(65535&r?0:2)|(i*n&32768?1:0),t.cycles++,t.cycles++,t.pc++}function Hn(t,e){var i=t.dataView.getInt8(16+((112&e)>>4)),n=t.dataView.getInt8(16+(7&e)),r=i*n<<1;t.dataView.setInt16(0,r,!0),t.data[95]=252&t.data[95]|(65535&r?0:2)|(i*n&32768?1:0),t.cycles++,t.cycles++,t.pc++}function Kn(t,e){var i=t.dataView.getInt8(16+((112&e)>>4)),n=t.data[16+(7&e)],r=i*n<<1;t.dataView.setInt16(0,r,!0),t.data[95]=252&t.data[95]|(65535&r?2:0)|(i*n&32768?1:0),t.cycles++,t.cycles++,t.pc++}function qn(t,e){var i=t.pc+1,n=t.dataView.getUint16(93,!0),r=t.pc22Bits;t.data[n]=255&i,t.data[n-1]=i>>8&255,r&&(t.data[n-2]=i>>16&255),t.dataView.setUint16(93,n-(r?3:2),!0),t.pc=t.dataView.getUint16(30,!0)-1,t.cycles+=r?3:2,t.cycles++,t.pc++}function Gn(t,e){t.pc=t.dataView.getUint16(30,!0)-1,t.cycles++,t.cycles++,t.pc++}function zn(t,e){var i=t.readData(32+(15&e|(1536&e)>>5));t.data[(496&e)>>4]=i,t.cycles++,t.pc++}function Xn(t,e){var i=t.data[(496&e)>>4],n=i+1&255;t.data[(496&e)>>4]=n;var r=225&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=127===i?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function jn(t,e){t.pc=(t.progMem[t.pc+1]|(1&e)<<16|(496&e)<<13)-1,t.cycles+=2,t.cycles++,t.pc++}function Qn(t,e){var i=(496&e)>>4,n=t.data[i],r=t.readData(t.dataView.getUint16(30,!0));t.writeData(t.dataView.getUint16(30,!0),r&255-n),t.data[i]=r,t.cycles++,t.pc++}function $n(t,e){var i=(496&e)>>4,n=t.data[i],r=t.readData(t.dataView.getUint16(30,!0));t.writeData(t.dataView.getUint16(30,!0),r|n),t.data[i]=r,t.cycles++,t.pc++}function Yn(t,e){var i=t.data[(496&e)>>4],n=t.readData(t.dataView.getUint16(30,!0));t.writeData(t.dataView.getUint16(30,!0),i^n),t.data[(496&e)>>4]=n,t.cycles++,t.pc++}function tr(t,e){t.data[16+((240&e)>>4)]=15&e|(3840&e)>>4,t.cycles++,t.pc++}function er(t,e){t.cycles++;var i=t.readData(t.progMem[t.pc+1]);t.data[(496&e)>>4]=i,t.pc++,t.cycles++,t.pc++}function ir(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(26,!0)),t.cycles++,t.pc++}function nr(t,e){var i=t.dataView.getUint16(26,!0);t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.dataView.setUint16(26,i+1,!0),t.cycles++,t.pc++}function rr(t,e){var i=t.dataView.getUint16(26,!0)-1;t.dataView.setUint16(26,i,!0),t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.cycles++,t.pc++}function ar(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(28,!0)),t.cycles++,t.pc++}function sr(t,e){var i=t.dataView.getUint16(28,!0);t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.dataView.setUint16(28,i+1,!0),t.cycles++,t.pc++}function or(t,e){var i=t.dataView.getUint16(28,!0)-1;t.dataView.setUint16(28,i,!0),t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.cycles++,t.pc++}function ur(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(28,!0)+(7&e|(3072&e)>>7|(8192&e)>>8)),t.cycles++,t.pc++}function lr(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(30,!0)),t.cycles++,t.pc++}function cr(t,e){var i=t.dataView.getUint16(30,!0);t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.dataView.setUint16(30,i+1,!0),t.cycles++,t.pc++}function dr(t,e){var i=t.dataView.getUint16(30,!0)-1;t.dataView.setUint16(30,i,!0),t.cycles++,t.data[(496&e)>>4]=t.readData(i),t.cycles++,t.pc++}function hr(t,e){t.cycles++,t.data[(496&e)>>4]=t.readData(t.dataView.getUint16(30,!0)+(7&e|(3072&e)>>7|(8192&e)>>8)),t.cycles++,t.pc++}function vr(t,e){t.data[0]=t.progBytes[t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function fr(t,e){t.data[(496&e)>>4]=t.progBytes[t.dataView.getUint16(30,!0)],t.cycles+=2,t.cycles++,t.pc++}function pr(t,e){var i=t.dataView.getUint16(30,!0);t.data[(496&e)>>4]=t.progBytes[i],t.dataView.setUint16(30,i+1,!0),t.cycles+=2,t.cycles++,t.pc++}function gr(t,e){var i=t.data[(496&e)>>4],n=i>>>1;t.data[(496&e)>>4]=n;var r=224&t.data[95];r|=n?0:2,r|=1&i,r|=r>>2&1^1&r?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function yr(t,e){t.data[(496&e)>>4]=t.data[15&e|(512&e)>>5],t.cycles++,t.pc++}function mr(t,e){var i=2*(15&e),n=2*((240&e)>>4);t.data[n]=t.data[i],t.data[n+1]=t.data[i+1],t.cycles++,t.pc++}function wr(t,e){var i=t.data[(496&e)>>4]*t.data[15&e|(512&e)>>5];t.dataView.setUint16(0,i,!0),t.data[95]=252&t.data[95]|(65535&i?0:2)|(32768&i?1:0),t.cycles++,t.cycles++,t.pc++}function kr(t,e){var i=t.dataView.getInt8(16+((240&e)>>4))*t.dataView.getInt8(16+(15&e));t.dataView.setInt16(0,i,!0),t.data[95]=252&t.data[95]|(65535&i?0:2)|(32768&i?1:0),t.cycles++,t.cycles++,t.pc++}function Zr(t,e){var i=t.dataView.getInt8(16+((112&e)>>4))*t.data[16+(7&e)];t.dataView.setInt16(0,i,!0),t.data[95]=252&t.data[95]|(65535&i?0:2)|(32768&i?1:0),t.cycles++,t.cycles++,t.pc++}function br(t,e){var i=(496&e)>>4,n=t.data[i],r=0-n;t.data[i]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=128===r?8:0,a|=a>>2&1^a>>3&1?16:0,a|=r?1:0,a|=1&(r|n)?32:0,t.data[95]=a,t.cycles++,t.pc++}function Cr(t,e){t.cycles++,t.pc++}function _r(t,e){var i=t.data[(496&e)>>4]|t.data[15&e|(512&e)>>5];t.data[(496&e)>>4]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function Sr(t,e){var i=t.data[16+((240&e)>>4)]|15&e|(3840&e)>>4;t.data[16+((240&e)>>4)]=i;var n=225&t.data[95];n|=i?0:2,n|=128&i?4:0,n|=n>>2&1^n>>3&1?16:0,t.data[95]=n,t.cycles++,t.pc++}function xr(t,e){t.writeData(32+(15&e|(1536&e)>>5),t.data[(496&e)>>4]),t.cycles++,t.pc++}function Pr(t,e){var i=t.dataView.getUint16(93,!0)+1;t.dataView.setUint16(93,i,!0),t.data[(496&e)>>4]=t.data[i],t.cycles++,t.cycles++,t.pc++}function Ir(t,e){var i=t.dataView.getUint16(93,!0);t.data[i]=t.data[(496&e)>>4],t.dataView.setUint16(93,i-1,!0),t.cycles++,t.cycles++,t.pc++}function Dr(t,e){var i=(2047&e)-(2048&e?2048:0),n=t.pc+1,r=t.dataView.getUint16(93,!0),a=t.pc22Bits;t.data[r]=255&n,t.data[r-1]=n>>8&255,a&&(t.data[r-2]=n>>16&255),t.dataView.setUint16(93,r-(a?3:2),!0),t.pc+=i,t.cycles+=a?3:2,t.cycles++,t.pc++}function Ar(t,e){var i=t.pc22Bits,n=t.dataView.getUint16(93,!0)+(i?3:2);t.dataView.setUint16(93,n,!0),t.pc=(t.data[n-1]<<8)+t.data[n]-1,i&&(t.pc|=t.data[n-2]<<16),t.cycles+=i?4:3,t.cycles++,t.pc++}function Rr(t,e){var i=t.pc22Bits,n=t.dataView.getUint16(93,!0)+(i?3:2);t.dataView.setUint16(93,n,!0),t.pc=(t.data[n-1]<<8)+t.data[n]-1,i&&(t.pc|=t.data[n-2]<<16),t.cycles+=i?4:3,t.data[95]|=128,t.cycles++,t.pc++}function Br(t,e){t.pc=t.pc+((2047&e)-(2048&e?2048:0)),t.cycles++,t.cycles++,t.pc++}function Tr(t,e){var i=t.data[(496&e)>>4],n=i>>>1|(1&t.data[95])<<7;t.data[(496&e)>>4]=n;var r=224&t.data[95];r|=n?0:2,r|=128&n?4:0,r|=1&i?1:0,r|=r>>2&1^1&r?8:0,r|=r>>2&1^r>>3&1?16:0,t.data[95]=r,t.cycles++,t.pc++}function Er(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=t.data[95],a=i-n-(1&r);t.data[(496&e)>>4]=a,r=192&r|(!a&&r>>1&1?2:0)|(n+(1&r)>i?1:0),r|=128&a?4:0,r|=(i^n)&(i^a)&128?8:0,r|=r>>2&1^r>>3&1?16:0,r|=1&(~i&n|n&a|a&~i)?32:0,t.data[95]=r,t.cycles++,t.pc++}function Ur(t,e){var i=t.data[16+((240&e)>>4)],n=15&e|(3840&e)>>4,r=t.data[95],a=i-n-(1&r);t.data[16+((240&e)>>4)]=a,r=192&r|(!a&&r>>1&1?2:0)|(n+(1&r)>i?1:0),r|=128&a?4:0,r|=(i^n)&(i^a)&128?8:0,r|=r>>2&1^r>>3&1?16:0,r|=1&(~i&n|n&a|a&~i)?32:0,t.data[95]=r,t.cycles++,t.pc++}function Nr(t,e){var i=32+((248&e)>>3),n=1<<(7&e);t.writeData(i,t.readData(i)|n,n),t.cycles++,t.cycles++,t.pc++}function Or(t,e){if(!(t.readData(32+((248&e)>>3))&1<<(7&e))){var i=gn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Mr(t,e){if(t.readData(32+((248&e)>>3))&1<<(7&e)){var i=gn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Lr(t,e){var i=2*((48&e)>>4)+24,n=t.dataView.getUint16(i,!0),r=15&e|(192&e)>>2,a=n-r;t.dataView.setUint16(i,a,!0);var s=192&t.data[95];s|=a?0:2,s|=32768&a?4:0,s|=n&~a&32768?8:0,s|=s>>2&1^s>>3&1?16:0,s|=r>n?1:0,s|=1&(~n&r|r&a|a&~n)?32:0,t.data[95]=s,t.cycles++,t.cycles++,t.pc++}function Vr(t,e){if(!(t.data[(496&e)>>4]&1<<(7&e))){var i=gn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Fr(t,e){if(t.data[(496&e)>>4]&1<<(7&e)){var i=gn(t.progMem[t.pc+1])?2:1;t.cycles+=i,t.pc+=i}t.cycles++,t.pc++}function Jr(t,e){t.cycles++,t.pc++}function Wr(t,e){t.cycles++,t.pc++}function Hr(t,e){t.cycles++,t.pc++}function Kr(t,e){var i=t.data[(496&e)>>4],n=t.progMem[t.pc+1];t.writeData(n,i),t.pc++,t.cycles++,t.cycles++,t.pc++}function qr(t,e){t.writeData(t.dataView.getUint16(26,!0),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function Gr(t,e){var i=t.dataView.getUint16(26,!0);t.writeData(i,t.data[(496&e)>>4]),t.dataView.setUint16(26,i+1,!0),t.cycles++,t.cycles++,t.pc++}function zr(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(26,!0)-1;t.dataView.setUint16(26,n,!0),t.writeData(n,i),t.cycles++,t.cycles++,t.pc++}function Xr(t,e){t.writeData(t.dataView.getUint16(28,!0),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function jr(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(28,!0);t.writeData(n,i),t.dataView.setUint16(28,n+1,!0),t.cycles++,t.cycles++,t.pc++}function Qr(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(28,!0)-1;t.dataView.setUint16(28,n,!0),t.writeData(n,i),t.cycles++,t.cycles++,t.pc++}function $r(t,e){t.writeData(t.dataView.getUint16(28,!0)+(7&e|(3072&e)>>7|(8192&e)>>8),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function Yr(t,e){t.writeData(t.dataView.getUint16(30,!0),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function ta(t,e){var i=t.dataView.getUint16(30,!0);t.writeData(i,t.data[(496&e)>>4]),t.dataView.setUint16(30,i+1,!0),t.cycles++,t.cycles++,t.pc++}function ea(t,e){var i=t.data[(496&e)>>4],n=t.dataView.getUint16(30,!0)-1;t.dataView.setUint16(30,n,!0),t.writeData(n,i),t.cycles++,t.cycles++,t.pc++}function ia(t,e){t.writeData(t.dataView.getUint16(30,!0)+(7&e|(3072&e)>>7|(8192&e)>>8),t.data[(496&e)>>4]),t.cycles++,t.cycles++,t.pc++}function na(t,e){var i=t.data[(496&e)>>4],n=t.data[15&e|(512&e)>>5],r=i-n;t.data[(496&e)>>4]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(i^n)&(i^r)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function ra(t,e){var i=t.data[16+((240&e)>>4)],n=15&e|(3840&e)>>4,r=i-n;t.data[16+((240&e)>>4)]=r;var a=192&t.data[95];a|=r?0:2,a|=128&r?4:0,a|=(i^n)&(i^r)&128?8:0,a|=a>>2&1^a>>3&1?16:0,a|=n>i?1:0,a|=1&(~i&n|n&r|r&~i)?32:0,t.data[95]=a,t.cycles++,t.pc++}function aa(t,e){var i=(496&e)>>4,n=t.data[i];t.data[i]=(15&n)<<4|(240&n)>>>4,t.cycles++,t.pc++}function sa(t,e){t.onWatchdogReset(),t.cycles++,t.pc++}function oa(t,e){var i=(496&e)>>4,n=t.data[i],r=t.data[t.dataView.getUint16(30,!0)];t.data[t.dataView.getUint16(30,!0)]=n,t.data[i]=r,t.cycles++,t.pc++}var ua=[{pattern:"0001 11rd dddd rrrr",fn:yn,idx:1},{pattern:"0000 11rd dddd rrrr",fn:mn,idx:2},{pattern:"1001 0110 KKdd KKKK",fn:wn,idx:3},{pattern:"0010 00rd dddd rrrr",fn:kn,idx:4},{pattern:"0111 KKKK dddd KKKK",fn:Zn,idx:5},{pattern:"1001 010d dddd 0101",fn:bn,idx:6},{pattern:"1001 0100 1sss 1000",fn:Cn,idx:7},{pattern:"1111 100d dddd 0bbb",fn:_n,idx:8},{pattern:"1111 01kk kkkk ksss",fn:Sn,idx:9},{pattern:"1111 00kk kkkk ksss",fn:xn,idx:10},{pattern:"1001 0100 0sss 1000",fn:Pn,idx:11},{pattern:"1111 101d dddd 0bbb",fn:In,idx:12},{pattern:"1001 010k kkkk 111k kkkk kkkk kkkk kkkk",fn:Dn,idx:13},{pattern:"1001 1000 AAAA Abbb",fn:An,idx:14},{pattern:"1001 010d dddd 0000",fn:Rn,idx:15},{pattern:"0001 01rd dddd rrrr",fn:Bn,idx:16},{pattern:"0000 01rd dddd rrrr",fn:Tn,idx:17},{pattern:"0011 KKKK dddd KKKK",fn:En,idx:18},{pattern:"0001 00rd dddd rrrr",fn:Un,idx:19},{pattern:"1001 010d dddd 1010",fn:Nn,idx:20},{pattern:"1001 0101 0001 1001",fn:On,idx:21},{pattern:"1001 0100 0001 1001",fn:Mn,idx:22},{pattern:"1001 0101 1101 1000",fn:Ln,idx:23},{pattern:"1001 000d dddd 0110",fn:Vn,idx:24},{pattern:"1001 000d dddd 0111",fn:Fn,idx:25},{pattern:"0010 01rd dddd rrrr",fn:Jn,idx:26},{pattern:"0000 0011 0ddd 1rrr",fn:Wn,idx:27},{pattern:"0000 0011 1ddd 0rrr",fn:Hn,idx:28},{pattern:"0000 0011 1ddd 1rrr",fn:Kn,idx:29},{pattern:"1001 0101 0000 1001",fn:qn,idx:30},{pattern:"1001 0100 0000 1001",fn:Gn,idx:31},{pattern:"1011 0AAd dddd AAAA",fn:zn,idx:32},{pattern:"1001 010d dddd 0011",fn:Xn,idx:33},{pattern:"1001 010k kkkk 110k kkkk kkkk kkkk kkkk",fn:jn,idx:34},{pattern:"1001 001r rrrr 0110",fn:Qn,idx:35},{pattern:"1001 001r rrrr 0101",fn:$n,idx:36},{pattern:"1001 001r rrrr 0111",fn:Yn,idx:37},{pattern:"1110 KKKK dddd KKKK",fn:tr,idx:38},{pattern:"1001 000d dddd 0000 kkkk kkkk kkkk kkkk",fn:er,idx:39},{pattern:"1001 000d dddd 1100",fn:ir,idx:40},{pattern:"1001 000d dddd 1101",fn:nr,idx:41},{pattern:"1001 000d dddd 1110",fn:rr,idx:42},{pattern:"1000 000d dddd 1000",fn:ar,idx:43},{pattern:"1001 000d dddd 1001",fn:sr,idx:44},{pattern:"1001 000d dddd 1010",fn:or,idx:45},{pattern:"10q0 qq0d dddd 1qqq",fn:ur,idx:46},{pattern:"1000 000d dddd 0000",fn:lr,idx:47},{pattern:"1001 000d dddd 0001",fn:cr,idx:48},{pattern:"1001 000d dddd 0010",fn:dr,idx:49},{pattern:"10q0 qq0d dddd 0qqq",fn:hr,idx:50},{pattern:"1001 0101 1100 1000",fn:vr,idx:51},{pattern:"1001 000d dddd 0100",fn:fr,idx:52},{pattern:"1001 000d dddd 0101",fn:pr,idx:53},{pattern:"1001 010d dddd 0110",fn:gr,idx:54},{pattern:"0010 11rd dddd rrrr",fn:yr,idx:55},{pattern:"0000 0001 dddd rrrr",fn:mr,idx:56},{pattern:"1001 11rd dddd rrrr",fn:wr,idx:57},{pattern:"0000 0010 dddd rrrr",fn:kr,idx:58},{pattern:"0000 0011 0ddd 0rrr",fn:Zr,idx:59},{pattern:"1001 010d dddd 0001",fn:br,idx:60},{pattern:"0000 0000 0000 0000",fn:Cr,idx:61},{pattern:"0010 10rd dddd rrrr",fn:_r,idx:62},{pattern:"0110 KKKK dddd KKKK",fn:Sr,idx:63},{pattern:"1011 1AAr rrrr AAAA",fn:xr,idx:64},{pattern:"1001 000d dddd 1111",fn:Pr,idx:65},{pattern:"1001 001d dddd 1111",fn:Ir,idx:66},{pattern:"1101 kkkk kkkk kkkk",fn:Dr,idx:67},{pattern:"1001 0101 0000 1000",fn:Ar,idx:68},{pattern:"1001 0101 0001 1000",fn:Rr,idx:69},{pattern:"1100 kkkk kkkk kkkk",fn:Br,idx:70},{pattern:"1001 010d dddd 0111",fn:Tr,idx:71},{pattern:"0000 10rd dddd rrrr",fn:Er,idx:72},{pattern:"0100 KKKK dddd KKKK",fn:Ur,idx:73},{pattern:"1001 1010 AAAA Abbb",fn:Nr,idx:74},{pattern:"1001 1001 AAAA Abbb",fn:Or,idx:75},{pattern:"1001 1011 AAAA Abbb",fn:Mr,idx:76},{pattern:"1001 0111 KKdd KKKK",fn:Lr,idx:77},{pattern:"1111 110r rrrr 0bbb",fn:Vr,idx:78},{pattern:"1111 111r rrrr 0bbb",fn:Fr,idx:79},{pattern:"1001 0101 1000 1000",fn:Jr,idx:80},{pattern:"1001 0101 1110 1000",fn:Wr,idx:81},{pattern:"1001 0101 1111 1000",fn:Hr,idx:82},{pattern:"1001 001d dddd 0000 kkkk kkkk kkkk kkkk",fn:Kr,idx:83},{pattern:"1001 001r rrrr 1100",fn:qr,idx:84},{pattern:"1001 001r rrrr 1101",fn:Gr,idx:85},{pattern:"1001 001r rrrr 1110",fn:zr,idx:86},{pattern:"1000 001r rrrr 1000",fn:Xr,idx:87},{pattern:"1001 001r rrrr 1001",fn:jr,idx:88},{pattern:"1001 001r rrrr 1010",fn:Qr,idx:89},{pattern:"10q0 qq1r rrrr 1qqq",fn:$r,idx:90},{pattern:"1000 001r rrrr 0000",fn:Yr,idx:91},{pattern:"1001 001r rrrr 0001",fn:ta,idx:92},{pattern:"1001 001r rrrr 0010",fn:ea,idx:93},{pattern:"10q0 qq1r rrrr 0qqq",fn:ia,idx:94},{pattern:"0001 10rd dddd rrrr",fn:na,idx:95},{pattern:"0101 KKKK dddd KKKK",fn:ra,idx:96},{pattern:"1001 010d dddd 0010",fn:aa,idx:97},{pattern:"1001 0101 1010 1000",fn:sa,idx:98},{pattern:"1001 001r rrrr 0100",fn:oa,idx:99}];function la(t){var e,i,n,r,a,s,o,u,l,c,d,v,f,p,g,y;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:e=1,i=!0,n=!1,r=void 0;try{for(a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0)"0"!==(o=s.value)&&"1"!==o&&(e*=2)}catch(m){n=!0,r=m}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}u=0,h.label=1;case 1:if(!(u<e))return[3,4];l=0,c=0,d=!0,v=!1,f=void 0;try{for(p=t[Symbol.iterator]();!(d=(g=p.next()).done);d=!0)y=g.value,c*=2,"1"===y?c++:"0"!==y&&(c+=u&1<<l?1:0,l++)}catch(m){v=!0,f=m}finally{try{d||null==p.return||p.return()}finally{if(v)throw f}}return[4,c];case 2:h.sent(),h.label=3;case 3:return u++,[3,1];case 4:return[2]}}))}var ca=new WeakMap;function da(t){var e=ca.get(t)||0;e<10&&console.warn("Invalid opcode ".concat(t.progMem[t.pc].toString(16)," at 0x").concat((2*t.pc).toString(16))),10===++e&&console.warn("Too many warnings; reporting disabled"),ca.set(t,e),t.cycles++,t.pc++}for(var ha={},va=0;va<65536;va++)ha[va]=da;var fa=!0,pa=!1,ga=void 0;try{for(var ya,ma=ua[Symbol.iterator]();!(fa=(ya=ma.next()).done);fa=!0){var wa=ya.value,ka=wa.pattern,Za=wa.fn,ba=!0,Ca=!1,_a=void 0;try{for(var Sa,xa=la(ka.replace(/ /g,"").substr(0,16))[Symbol.iterator]();!(ba=(Sa=xa.next()).done);ba=!0){var Pa=Sa.value;ha[Pa]=Za}}catch(Xs){Ca=!0,_a=Xs}finally{try{ba||null==xa.return||xa.return()}finally{if(Ca)throw _a}}}}catch(Xs){pa=!0,ga=Xs}finally{try{fa||null==ma.return||ma.return()}finally{if(pa)throw ga}}function Ia(t){var e=t.progMem[t.pc];ha[e](t,e),t.pc&=t.progMem.length-1}var Da=38296,Aa=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"progMemView",void 0),(0,s.Z)(this,"breakpoints",void 0),(0,s.Z)(this,"cpu",void 0),(0,s.Z)(this,"eeprom",void 0),this.cpu=e,this.eeprom=i,this.progMemView=new DataView(this.cpu.progMem.buffer),this.breakpoints=new Map}return(0,a.Z)(t,[{key:"getMemory",value:function(t){return 8388608&t?this.cpu.dataView:this.progMemView}},{key:"PC",get:function(){return 2*this.cpu.pc}},{key:"SP",get:function(){return 8388608|this.cpu.SP}},{key:"registerCount",get:function(){return 34}},{key:"readUint8",value:function(t){return t>=8454144&&t<=8519680?this.eeprom.readMemory(t-8454144):this.getMemory(t).getUint8(1048575&t)}},{key:"readUint16",value:function(t){return t>=8454144&&t<=8519680?this.eeprom.readMemory(t-8454144)|this.eeprom.readMemory(t-8454144+1)<<8:this.getMemory(t).getUint16(1048575&t,!0)}},{key:"readUint32",value:function(t){return t>=8454144&&t<=8519680?this.eeprom.readMemory(t-8454144)|this.eeprom.readMemory(t-8454144+1)<<8|this.eeprom.readMemory(t-8454144+2)<<16|this.eeprom.readMemory(t-8454144+3)<<24:this.getMemory(t).getUint32(1048575&t,!0)}},{key:"readRegister",value:function(t){if(t<32)return this.cpu.data[t];switch(t){case 32:return 255&this.cpu.SP;case 33:return this.cpu.SP>>8}return console.warn("AVR.readRegister(".concat(t,"): unknown register")),0}},{key:"readDwarfRegister",value:function(t){return t<32&&t%2===0?this.readRegister(t)+(this.readRegister(t+1)<<8):this.readRegister(t)}},{key:"setBreakpoint",value:function(t){var e=t>>1,i=this.cpu.progMem[e];i!==Da&&(this.breakpoints.set(t,i),this.cpu.progMem[e]=Da)}},{key:"clearBreakpoint",value:function(t){var e=this.breakpoints.get(t);if(null!=e){var i=t>>1;this.cpu.progMem[i]=e,this.breakpoints.delete(t)}}},{key:"stepInstruction",value:function(){var t=this.cpu,e=t.pc,i=e<<1,n=this.breakpoints.get(i);null!=n&&(this.cpu.progMem[e]=n),Ia(t),t.tick(),null!=n&&(this.cpu.progMem[e]=Da)}},{key:"instructionSize",value:function(t){var e=this.cpu.progMem[t>>1];return 36864===(65039&e)||37376===(65039&e)||37902===(65038&e)||37900===(65038&e)?4:2}},{key:"isCallInstruction",value:function(t){var e=this.cpu.progMem[t>>1];return 37902===(65038&e)||38169===e||38153==e||53248===(61440&e)}},{key:"callAddressBefore",value:function(t){return 37902===(65038&this.cpu.progMem[t-4>>1])?t-4:(this.isCallInstruction(t-2)||console.warn("AVR.callAddressBefore: no call instruction found"),t-2)}}]),t}(),Ra={CLKPR:70},Ba={PIN:54,DDR:55,PORT:56,pinChange:{PCIE:5,PCICR:91,PCIFR:90,PCMSK:53,pinChangeInterrupt:2,mask:63,offset:0},externalInterrupts:[null,null,{EICR:85,EIMSK:91,EIFR:90,index:6,interrupt:1,iscOffset:0}]},Ta={bits:8,captureInterrupt:0,TCCRA:74,TCCRB:83,TCCRC:0,TCNT:82,OCRA:73,OCRB:72,OCRC:0,ICR:0,TIFR:88,TIMSK:89,ovfInterrupt:5,compAInterrupt:10,compBInterrupt:11,compCInterrupt:0,compPortA:Ba.PORT,compPinA:0,compPortB:Ba.PORT,compPinB:1,compPortC:0,compPinC:0,externalClockPort:Ba.PORT,externalClockPin:2,dividers:Qi.Jh.dividers,TOV:2,OCFA:16,OCFB:8,OCFC:0,TOIE:2,OCIEA:16,OCIEB:8,OCIEC:0},Ea={eepromReadyInterrupt:6,EECR:60,EEDR:61,EEARL:62,EEARH:63,eraseCycles:14400,writeCycles:14400},Ua={watchdogInterrupt:12,MCUSR:84,WDTCSR:65},Na=i(64295),Oa={ADCSRA:38,ADCSRB:35,ADMUX:39,ADCL:36,ADCH:37,DIDR0:52,adcInterrupt:8,muxInputMask:15,numChannels:4,muxChannels:{0:{type:Qi.hp.SingleEnded,channel:0},1:{type:Qi.hp.SingleEnded,channel:1},2:{type:Qi.hp.SingleEnded,channel:2},3:{type:Qi.hp.SingleEnded,channel:3},4:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:2,gain:1},5:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:2,gain:20},6:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:3,gain:1},7:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:3,gain:20},8:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:0,gain:1},9:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:0,gain:20},10:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:1,gain:1},11:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:1,gain:20},12:{type:Qi.hp.Constant,voltage:1.1},13:{type:Qi.hp.Constant,voltage:0},14:{type:Qi.hp.Constant,voltage:0},15:{type:Qi.hp.Temperature}},adcReferences:[Qi.yv.AVCC,Qi.yv.AREF,Qi.yv.Internal1V1,Qi.yv.Reserved,Qi.yv.AVCC,Qi.yv.AREF,Qi.yv.Internal2V56,Qi.yv.Internal2V56]},Ma=(0,l.Z)((0,u.Z)({},Qi.RH),{adcInterrupt:58,muxInputMask:63,numChannels:16,muxChannels:{0:{type:Qi.hp.SingleEnded,channel:0},1:{type:Qi.hp.SingleEnded,channel:1},2:{type:Qi.hp.SingleEnded,channel:2},3:{type:Qi.hp.SingleEnded,channel:3},4:{type:Qi.hp.SingleEnded,channel:4},5:{type:Qi.hp.SingleEnded,channel:5},6:{type:Qi.hp.SingleEnded,channel:6},7:{type:Qi.hp.SingleEnded,channel:7},8:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:0,gain:10},9:{type:Qi.hp.Differential,positiveChannel:1,negativeChannel:0,gain:10},10:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:0,gain:200},11:{type:Qi.hp.Differential,positiveChannel:1,negativeChannel:0,gain:200},12:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:2,gain:10},13:{type:Qi.hp.Differential,positiveChannel:3,negativeChannel:2,gain:10},14:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:2,gain:200},15:{type:Qi.hp.Differential,positiveChannel:3,negativeChannel:2,gain:200},16:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:1,gain:1},17:{type:Qi.hp.Differential,positiveChannel:1,negativeChannel:1,gain:1},18:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:1,gain:1},19:{type:Qi.hp.Differential,positiveChannel:3,negativeChannel:1,gain:1},20:{type:Qi.hp.Differential,positiveChannel:4,negativeChannel:1,gain:1},21:{type:Qi.hp.Differential,positiveChannel:5,negativeChannel:1,gain:1},22:{type:Qi.hp.Differential,positiveChannel:6,negativeChannel:1,gain:1},23:{type:Qi.hp.Differential,positiveChannel:7,negativeChannel:1,gain:1},24:{type:Qi.hp.Differential,positiveChannel:0,negativeChannel:2,gain:1},25:{type:Qi.hp.Differential,positiveChannel:1,negativeChannel:2,gain:1},26:{type:Qi.hp.Differential,positiveChannel:2,negativeChannel:2,gain:1},27:{type:Qi.hp.Differential,positiveChannel:3,negativeChannel:2,gain:1},28:{type:Qi.hp.Differential,positiveChannel:4,negativeChannel:2,gain:1},29:{type:Qi.hp.Differential,positiveChannel:5,negativeChannel:2,gain:1},30:{type:Qi.hp.Constant,voltage:1.1},31:{type:Qi.hp.Constant,voltage:0},32:{type:Qi.hp.SingleEnded,channel:8},33:{type:Qi.hp.SingleEnded,channel:9},34:{type:Qi.hp.SingleEnded,channel:10},35:{type:Qi.hp.SingleEnded,channel:11},36:{type:Qi.hp.SingleEnded,channel:12},37:{type:Qi.hp.SingleEnded,channel:13},38:{type:Qi.hp.SingleEnded,channel:14},39:{type:Qi.hp.SingleEnded,channel:15},40:{type:Qi.hp.Differential,positiveChannel:8,negativeChannel:8,gain:10},41:{type:Qi.hp.Differential,positiveChannel:9,negativeChannel:8,gain:10},42:{type:Qi.hp.Differential,positiveChannel:8,negativeChannel:8,gain:200},43:{type:Qi.hp.Differential,positiveChannel:9,negativeChannel:8,gain:200},44:{type:Qi.hp.Differential,positiveChannel:10,negativeChannel:10,gain:10},45:{type:Qi.hp.Differential,positiveChannel:11,negativeChannel:10,gain:10},46:{type:Qi.hp.Differential,positiveChannel:10,negativeChannel:10,gain:200},47:{type:Qi.hp.Differential,positiveChannel:11,negativeChannel:10,gain:200},48:{type:Qi.hp.Differential,positiveChannel:8,negativeChannel:9,gain:1},49:{type:Qi.hp.Differential,positiveChannel:9,negativeChannel:9,gain:1},50:{type:Qi.hp.Differential,positiveChannel:10,negativeChannel:9,gain:1},51:{type:Qi.hp.Differential,positiveChannel:11,negativeChannel:9,gain:1},52:{type:Qi.hp.Differential,positiveChannel:12,negativeChannel:9,gain:1},53:{type:Qi.hp.Differential,positiveChannel:13,negativeChannel:9,gain:1},54:{type:Qi.hp.Differential,positiveChannel:14,negativeChannel:9,gain:1},55:{type:Qi.hp.Differential,positiveChannel:15,negativeChannel:9,gain:1},56:{type:Qi.hp.Differential,positiveChannel:8,negativeChannel:10,gain:1},57:{type:Qi.hp.Differential,positiveChannel:9,negativeChannel:10,gain:1},58:{type:Qi.hp.Differential,positiveChannel:10,negativeChannel:10,gain:1},59:{type:Qi.hp.Differential,positiveChannel:11,negativeChannel:10,gain:1},60:{type:Qi.hp.Differential,positiveChannel:12,negativeChannel:10,gain:1},61:{type:Qi.hp.Differential,positiveChannel:13,negativeChannel:10,gain:1}},adcReferences:[Qi.yv.AREF,Qi.yv.AVCC,Qi.yv.Internal1V1,Qi.yv.Internal2V56]}),La={bits:16,dividers:Qi.OB.dividers,TOV:1,OCFA:2,OCFB:4,OCFC:8,TOIE:1,OCIEA:2,OCIEB:4,OCIEC:8},Va={ATmega328:{flash:32768,ram:2048,eeprom:1024,registerSpace:256,clockConfig:Qi.eP,eepromConfig:Qi.ts,watchdogConfig:Qi.s2,timers:[Qi.Jh,Qi.OB,Qi.Wv],usart:[Qi.kY],spi0Config:Qi.o9,twi0Config:Qi.mu,usi:!1,adcConfig:Qi.RH},ATmega2560:{flash:262144,ram:8192,eeprom:4096,registerSpace:512,clockConfig:Qi.eP,eepromConfig:(0,l.Z)((0,u.Z)({},Qi.ts),{eepromReadyInterrupt:60}),watchdogConfig:(0,l.Z)((0,u.Z)({},Qi.s2),{watchdogInterrupt:24}),timers:[(0,l.Z)((0,u.Z)({},Qi.Jh),{compAInterrupt:42,compBInterrupt:44,ovfInterrupt:46,compPortA:Qi.m4.PORT,compPinA:7,compPortB:Qi.KT.PORT,compPinB:5,externalClockPort:Qi.cS.PORT,externalClockPin:7}),(0,l.Z)((0,u.Z)({},Qi.OB,La),{captureInterrupt:32,compAInterrupt:34,compBInterrupt:36,compCInterrupt:38,ovfInterrupt:40,OCRC:140,compPortA:Qi.m4.PORT,compPinA:5,compPortB:Qi.m4.PORT,compPinB:6,compPortC:Qi.m4.PORT,compPinC:7,externalClockPort:Qi.cS.PORT,externalClockPin:6}),(0,l.Z)((0,u.Z)({},Qi.Wv),{compAInterrupt:26,compBInterrupt:28,ovfInterrupt:30,compPortA:Qi.m4.PORT,compPinA:4,compPortB:Qi.lb.PORT,compPinB:6}),(0,l.Z)((0,u.Z)({},La),{captureInterrupt:62,compAInterrupt:64,compBInterrupt:66,compCInterrupt:68,ovfInterrupt:70,TIFR:56,OCRA:152,OCRB:154,OCRC:156,ICR:150,TCNT:148,TCCRA:144,TCCRB:145,TCCRC:146,TIMSK:113,compPortA:Qi.bO.PORT,compPinA:3,compPortB:Qi.bO.PORT,compPinB:4,compPortC:Qi.bO.PORT,compPinC:5,externalClockPort:Qi.bO.PORT,externalClockPin:6}),(0,l.Z)((0,u.Z)({},La),{captureInterrupt:82,compAInterrupt:84,compBInterrupt:86,compCInterrupt:88,ovfInterrupt:90,TIFR:57,OCRA:168,OCRB:170,OCRC:172,ICR:166,TCNT:164,TCCRA:160,TCCRB:161,TCCRC:162,TIMSK:114,compPortA:Qi.lb.PORT,compPinA:3,compPortB:Qi.lb.PORT,compPinB:4,compPortC:Qi.lb.PORT,compPinC:5,externalClockPort:Qi.lb.PORT,externalClockPin:7}),(0,l.Z)((0,u.Z)({},La),{captureInterrupt:92,compAInterrupt:94,compBInterrupt:96,compCInterrupt:98,ovfInterrupt:100,TIFR:58,OCRA:296,OCRB:298,OCRC:300,ICR:294,TCNT:292,TCCRA:288,TCCRB:289,TCCRC:290,TIMSK:115,compPortA:Qi._R.PORT,compPinA:3,compPortB:Qi._R.PORT,compPinB:4,compPortC:Qi._R.PORT,compPinC:5,externalClockPort:Qi._R.PORT,externalClockPin:2})],spi0Config:(0,l.Z)((0,u.Z)({},Qi.o9),{spiInterrupt:48}),usart:[(0,l.Z)((0,u.Z)({},Qi.kY),{rxCompleteInterrupt:50,dataRegisterEmptyInterrupt:52,txCompleteInterrupt:54}),{rxCompleteInterrupt:72,dataRegisterEmptyInterrupt:74,txCompleteInterrupt:76,UCSRA:200,UCSRB:201,UCSRC:202,UBRRL:204,UBRRH:205,UDR:206},{rxCompleteInterrupt:102,dataRegisterEmptyInterrupt:104,txCompleteInterrupt:106,UCSRA:208,UCSRB:209,UCSRC:210,UBRRL:212,UBRRH:213,UDR:214},{rxCompleteInterrupt:108,dataRegisterEmptyInterrupt:110,txCompleteInterrupt:112,UCSRA:304,UCSRB:305,UCSRC:306,UBRRL:308,UBRRH:309,UDR:310}],twi0Config:(0,l.Z)((0,u.Z)({},Qi.mu),{twiInterrupt:78}),usi:!1,adcConfig:Ma},ATtiny25:{flash:2048,ram:128,eeprom:128,registerSpace:96,clockConfig:Ra,eepromConfig:Ea,watchdogConfig:Ua,timers:[Ta],usart:[],usi:!0,adcConfig:Oa},ATtiny45:{flash:4096,ram:256,eeprom:256,registerSpace:96,clockConfig:Ra,eepromConfig:Ea,watchdogConfig:Ua,timers:[Ta],usart:[],usi:!0,adcConfig:Oa},ATtiny85:{flash:8192,ram:512,eeprom:512,registerSpace:96,clockConfig:Ra,eepromConfig:Ea,watchdogConfig:Ua,usart:[],usi:!0,timers:[Ta],adcConfig:Oa}},Fa={name:"Arduino UNO R3",analogPins:["A0","A1","A2","A3","A4","A5","A6","A7"],mcu:Va.ATmega328,freqMHZ:16e6,createPins:function(t){var e=new Qi.wq(t,Qi.m4),i=new Qi.wq(t,Qi._d),n=new Qi.wq(t,Qi.cS);return{0:{port:n,pin:0,signals:[(0,Na.A_)("RX")]},1:{port:n,pin:1,signals:[(0,Na.A_)("TX")]},2:{port:n,pin:2},3:{port:n,pin:3},4:{port:n,pin:4},5:{port:n,pin:5},6:{port:n,pin:6},7:{port:n,pin:7},8:{port:e,pin:0},9:{port:e,pin:1},10:{port:e,pin:2,signals:[(0,Na.Q5)("SS")]},11:{port:e,pin:3,signals:[(0,Na.Q5)("MOSI")]},12:{port:e,pin:4,signals:[(0,Na.Q5)("MISO")]},13:{port:e,pin:5,signals:[(0,Na.Q5)("SCK")]},A0:{port:i,pin:0},A1:{port:i,pin:1},A2:{port:i,pin:2},A3:{port:i,pin:3},A4:{port:i,pin:4,signals:[(0,Na.ss)("SDA")]},A5:{port:i,pin:5,signals:[(0,Na.ss)("SCL")]}}}},Ja=i(96387),Wa=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"onEnable",void 0),(0,s.Z)(this,"onByte",(function(){})),(0,s.Z)(this,"fifo",new Ja.Q),(0,s.Z)(this,"tdcr",0),e.writeHooks[59]=function(t){var e,n;(i.tdcr=3&t,1&t)&&(null===(n=(e=i).onEnable)||void 0===n||n.call(e))},e.readHooks[59]=function(){return Math.min(i.fifo.available,15)<<4|i.tdcr},e.writeHooks[58]=function(t){i.onByte(t)},e.readHooks[58]=function(){var t,e;return 2&i.tdcr?null!==(t=i.fifo.peek())&&void 0!==t?t:0:null!==(e=i.fifo.next())&&void 0!==e?e:0}}return(0,a.Z)(t,[{key:"write",value:function(t){this.fifo.write(t)}}]),t}(),Ha=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"listeners",void 0),(0,s.Z)(this,"tinyDebug",void 0),this.tinyDebug=e,this.listeners=new Set,e.onByte=function(t){var e=new Uint8Array([t]),n=!0,r=!1,a=void 0;try{for(var s,o=i.listeners[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){(0,s.value)(e)}}catch(Xs){r=!0,a=Xs}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}}return(0,a.Z)(t,[{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"write",value:function(t){this.tinyDebug.write(t)}}]),t}(),Ka=38296,qa=function(){function t(){(0,r.Z)(this,t),(0,s.Z)(this,"sclFrequency",1e5)}return(0,a.Z)(t,[{key:"completeStart",value:function(){}},{key:"completeStop",value:function(){}},{key:"completeConnect",value:function(){}},{key:"completeWrite",value:function(){}},{key:"completeRead",value:function(){}}]),t}(),Ga=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fa,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Qi.rj(i.mcu.eeprom),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=this;(0,r.Z)(this,t),(0,s.Z)(this,"program",void 0),(0,s.Z)(this,"cpu",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"usart",void 0),(0,s.Z)(this,"twi",void 0),(0,s.Z)(this,"usi",void 0),(0,s.Z)(this,"eeprom",void 0),(0,s.Z)(this,"watchdog",void 0),(0,s.Z)(this,"i2c",void 0),(0,s.Z)(this,"spiMaster",void 0),(0,s.Z)(this,"timers",void 0),(0,s.Z)(this,"gpio",void 0),(0,s.Z)(this,"MHZ",void 0),(0,s.Z)(this,"pcMask",void 0),(0,s.Z)(this,"adcPins",void 0),(0,s.Z)(this,"scheduler",void 0),(0,s.Z)(this,"stopped",void 0),(0,s.Z)(this,"resetActive",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"debuggerTarget",void 0),(0,s.Z)(this,"pausePoints",void 0),(0,s.Z)(this,"hasPausePoints",void 0),(0,s.Z)(this,"analogPins",void 0),(0,s.Z)(this,"dumpRegistersOnBreak",void 0),(0,s.Z)(this,"defaultUartPins",void 0),(0,s.Z)(this,"serialInterface",void 0),(0,s.Z)(this,"onBreak",void 0),(0,s.Z)(this,"execute",void 0),(0,s.Z)(this,"board",void 0),(0,s.Z)(this,"eepromBackend",void 0),this.board=i,this.eepromBackend=n,this.program=new Uint16Array(this.board.mcu.flash/2),this.usart=[],this.timers=[],this.pcMask=this.program.length-1,this.adcPins=[null,null,null,null,null,null,null,null],this.stopped=!0,this.resetActive=!1,this.pausePoints={},this.hasPausePoints=!1,this.analogPins=this.board.analogPins,this.dumpRegistersOnBreak=!1,this.defaultUartPins={rx:"1",tx:"0"},this.execute=function(t){for(var e=o.cpu,i=o.hasPausePoints,n=o.pcMask,r=o.clock.frequency*(t/1e3),a=e.cycles+r;e.cycles<a;){var s,u,l=e.progMem[e.pc];if(o.resetActive?e.cycles++:ha[l](e,l),e.pc&=n,l===Ka)if(null===(u=(s=o).onBreak)||void 0===u?void 0:u.call(s))break;if(i){var c=o.pausePoints[e.pc];c&&c()}e.tick()}return!o.stopped};var u=i.mcu,l=u.clockConfig,c=u.eepromConfig,h=u.usart,v=u.spi0Config,f=u.twi0Config,p=u.timers,g=u.adcConfig,y=u.watchdogConfig,m=u.usi,w=a.firmwareBinary;this.program.fill(65535);var k=new Uint8Array(this.program.buffer);if(w){var Z=new Uint8Array(w),b=!0,C=!1,_=void 0;try{for(var S,x=new ji.aX(Z).program[Symbol.iterator]();!(b=(S=x.next()).done);b=!0){var P=S.value;P.type===ji.oB.LOAD&&P.paddr+P.filesz<k.length&&k.set(Z.subarray(P.offset,P.offset+P.filesz),P.paddr)}}catch(Xs){C=!0,_=Xs}finally{try{b||null==x.return||x.return()}finally{if(C)throw _}}}else(0,Yi.i)(e,k);this.cpu=new Qi.Z9(this.program,(a.ramSize||i.mcu.ram)+i.mcu.registerSpace),this.debuggerTarget=new Aa(this.cpu,n),this.MHZ=a.frequency||i.freqMHZ,this.clock=new Qi.y_(this.cpu,this.MHZ,l);var I=!0,D=!1,A=void 0;try{for(var R,B=p[Symbol.iterator]();!(I=(R=B.next()).done);I=!0){var T=R.value;this.timers.push(new Qi.OI(this.cpu,T))}}catch(Xs){D=!0,A=Xs}finally{try{I||null==B.return||B.return()}finally{if(D)throw A}}this.usart=h.map((function(t){return new Qi.cv(o.cpu,t,o.MHZ)})),this.twi=f?new Qi.YR(this.cpu,f,this.MHZ):new qa,this.eeprom=new Qi.qN(this.cpu,n,c),this.watchdog=new Qi.JK(this.cpu,y,this.clock);var E=v?new Qi.cX(this.cpu,v,this.MHZ):null,U=i.createPins(this.cpu),N=Object.keys(U).map((function(t){return new vn(o,t,U[t])}));this.pins=[new tn.E("GND",X.J.Low),new tn.E("5V",X.J.High),new tn.E("VIN",X.J.High),new tn.E("3.3V",X.J.High),new tn.E("VCC",X.J.High),new en("RESET",(function(t){if(o.resetActive=!t,!t){var e=o.cpu.nextClockEvent;o.cpu.reset(),o.cpu.nextClockEvent=e;var i=!0,n=!1,r=void 0;try{for(var a,s=o.cpu.gpioPorts[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;o.cpu.writeData(u.portConfig.DDR,0),o.cpu.writeData(u.portConfig.PORT,0)}}catch(Xs){n=!0,r=Xs}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}))].concat((0,d.Z)(N)),this.gpio=Array.from(new Set(Object.values(U).map((function(t){return t.port})))),this.usi=m?new Qi.ap(this.cpu,this.gpio[0],Ba.PIN,0,2):null,m&&(this.serialInterface=new Ha(new Wa(this.cpu)));var O=function(t,e){return N.find((function(i){var n;return null===(n=i.signals)||void 0===n?void 0:n.some((function(i){return i.type===t&&"signal"in i&&i.signal===e}))}))};this.i2c=new ln(this,this.twi,{scl:O("i2c","SCL"),sda:O("i2c","SDA")}),this.spiMaster=E?new pn(this,E,{mosi:O("spi","MOSI"),miso:O("spi","MISO"),sck:O("spi","SCK")}):null;var M=new Qi.Go(this.cpu,g);M.onADCRead=function(t){var e=0;switch(t.type){case Qi.hp.Constant:e=t.voltage;break;case Qi.hp.SingleEnded:var i,n;e=null!==(n=null===(i=o.adcPins[t.channel])||void 0===i?void 0:i.read())&&void 0!==n?n:0;break;case Qi.hp.Differential:var r,a;e=t.gain*(((null===(r=o.adcPins[t.positiveChannel])||void 0===r?void 0:r.read())||0)-((null===(a=o.adcPins[t.negativeChannel])||void 0===a?void 0:a.read())||0));break;case Qi.hp.Temperature:e=.378125}var s=e/M.referenceVoltage*1024,u=Math.min(Math.max(Math.floor(s),0),1023);o.cpu.addClockEvent((function(){return M.completeADCRead(u)}),M.sampleCycles)},ha[38296]=function(t){o.dumpRegistersOnBreak&&o.dumpRegisters(),t.pc++};var L=a.ramSize;L&&L>0&&L!==i.mcu.ram&&this.attachSPListener(i.mcu.ram+i.mcu.registerSpace-1,L+i.mcu.registerSpace-1),this.scheduler=new nn.B(this.execute)}return(0,a.Z)(t,[{key:"flash",get:function(){return this.cpu.progBytes}},{key:"singleStep",value:function(){var t=this.cpu;Ia(t),t.tick()}},{key:"runToBreak",value:function(t){for(var e=this.cpu,i=this.pcMask,n=0;n<t;n++){var r=e.progMem[e.pc];if(ha[r](e,r),e.pc&=i,r===Ka)return;e.tick()}}},{key:"start",value:function(){this.stopped&&(this.scheduler.start(),this.stopped=!1,this.debuggerTarget.stepInstruction())}},{key:"stop",value:function(){this.scheduler.stop(),this.stopped=!0}},{key:"cpuMillis",get:function(){return Math.floor(this.clock.timeMillis)}},{key:"cpuNanos",get:function(){return Math.floor(this.clock.timeNanos)}},{key:"running",get:function(){return!this.stopped}},{key:"setPausePoint",value:function(t,e){e?this.pausePoints[t/2]=e:delete this.pausePoints[t/2],this.hasPausePoints=Object.keys(this.pausePoints).length>0}},{key:"addEvent",value:function(t,e){this.cpu.addClockEvent(e,t/1e9*this.MHZ)}},{key:"clearEvent",value:function(t){this.cpu.clearClockEvent(t)}},{key:"createEvent",value:function(t){var e=this;return{schedule:function(i){e.clearEvent(t),e.addEvent(i,t)},unschedule:function(){e.clearEvent(t)}}}},{key:"gdbMessage",value:function(t,e){return function(t,e){var i=t.cpu,n=t.eeprom,r=t.forceUpdate;if(e.startsWith("qSupported"))return(0,rn.KC)("PacketSize=1000");if(e.startsWith("qAttached"))return(0,rn.KC)("0");if(e.startsWith("qfThreadInfo"))return(0,rn.KC)("m1");if(e.startsWith("qsThreadInfo"))return(0,rn.KC)("l");if("?"===e)return(0,rn.KC)("S05");if("qC"===e)return(0,rn.KC)("QC01");if(e.startsWith("H"))return(0,rn.KC)("OK");if("g"===e){var a=new Uint8Array(39),s=new DataView(a.buffer);if(i){for(var o=0;o<32;o++)a[o]=i.data[o]||0;a[32]=i.SREG||0,s.setUint16(33,i.SP,!0),s.setUint32(35,2*i.pc,!0)}return(0,rn.KC)((0,rn.NC)(a))}if(e.startsWith("G")){var u=(0,rn.H_)(e.substr(1)),l=new DataView(u.buffer);if(i&&u.length>=39){for(var d=0;d<32;d++)i.data[d]=u[d];return i.data[95]=u[32],i.SP=l.getUint16(33,!0),i.pc=l.getUint32(35,!0)/2,(0,rn.KC)("OK")}return(0,rn.KC)("E00")}if(e.startsWith("m")){var h=(0,c.Z)(e.substr(1).split(","),2),v=h[0],f=h[1],p=parseInt(v,16),g=parseInt(f,16);if(!g||g>=65536)return(0,rn.KC)("E05");var y=new Uint8Array(g);if(p>=8454144){y.fill(255);for(var m=65535&p,w=0;w<m+g;w++)y[w]=n.readMemory(m+w)}else if(p>=8388608){var k=1048575&p;if(y.fill(0),i)if(k<256)for(var Z=0;Z<g;Z++)y[Z]=i.readData(k+Z);else y.set(i.data.slice(k,k+g))}else y.fill(255),i&&y.set(i.progBytes.slice(p,p+g));return(0,rn.KC)((0,rn.NC)(y))}if(e.startsWith("M")){var b=(0,c.Z)(e.substr(1).split(/[,:]/),3),C=b[0],_=b[1],S=b[2],x=parseInt(C,16),P=parseInt(_,16),I=(0,rn.H_)(S).slice(0,P);if(i){if(x>=8454144)for(var D=65535&x,A=0;A<P;A++)n.eraseMemory(D+A),n.writeMemory(D+A,I[A]);else if(x>=8388608){var R=1048575&x,B=Math.min(I.length,i.data.length-R);if(B>0)if(R<256){for(var T=0;T<B;T++)i.writeData(R+T,I[T]);null===r||void 0===r||r()}else i.data.set(I.slice(0,B),R)}else{var E=Math.min(I.length,i.progBytes.length-x);E>0&&i.progBytes.set(I.slice(0,E),x)}return(0,rn.KC)("OK")}return(0,rn.KC)("E05")}return(0,rn.KC)("")}({cpu:this.cpu,eeprom:this.eepromBackend,forceUpdate:e},t)}},{key:"rewindInstruction",value:function(){this.cpu.pc--}},{key:"uartEnabled",value:function(t,e){return"tx"===e?this.usart[t].txEnable:this.usart[t].rxEnable}},{key:"i2cEnabled",value:function(){var t,e=null===(t=this.board.mcu.twi0Config)||void 0===t?void 0:t.TWCR;if(null==e)return!1;return 0!==(4&this.cpu.data[e])}},{key:"spiEnabled",value:function(){var t,e=null===(t=this.board.mcu.spi0Config)||void 0===t?void 0:t.SPCR;if(null==e)return!1;return 0!==(64&this.cpu.data[e])}},{key:"attachSPListener",value:function(t,e){var i=this.cpu;i.writeHooks[93]=function(n){var r=i.data[94]<<8|n;return delete i.writeHooks[93],r===t&&(i.SP=e),!1}}},{key:"dumpRegisters",value:function(){var t,e=this.cpu,i=Array.from(e.data.slice(0,32)).map($i.sA);console.group("MCU register dump:");for(var n=0;n<32;n+=8){for(var r,a="",s=[],o=0;o<8;o++){var u=n+o;a+="%cr".concat(u,"%c: ").concat(u<10?" ":"","%s   "),s.push("color: blue"),s.push("color: initial"),s.push(i[u])}(r=console).log.apply(r,[a].concat((0,d.Z)(s)))}console.log("%cPC%c: %s  %cSP%c: %s  %cX%c: %s   %cY%c: %s   %cZ%c: %s   %cSREG%c: %s (%cI%cT%cH%cS%cV%cN%cZ%cC%c)","color: purple","color: initial",(0,$i.Tf)(2*e.pc),"color: green","color: initial",(0,$i.Tf)(e.SP),"color: brown","color: initial",(0,$i.Tf)(e.data16[13]),"color: brown","color: initial",(0,$i.Tf)(e.data16[14]),"color: brown","color: initial",(0,$i.Tf)(e.data16[15]),"color: purple","color: initial",(t=e.SREG,[7,6,5,4,3,2,1,0].map((function(e){return t&1<<e?"1":"0"})).join("")),128&e.SREG?"font-weight:bold;color:green":"color: #ccc",64&e.SREG?"font-weight:bold;color:green":"color: #ccc",32&e.SREG?"font-weight:bold;color:green":"color: #ccc",16&e.SREG?"font-weight:bold;color:green":"color: #ccc",8&e.SREG?"font-weight:bold;color:green":"color: #ccc",4&e.SREG?"font-weight:bold;color:green":"color: #ccc",2&e.SREG?"font-weight:bold;color:green":"color: #ccc",1&e.SREG?"font-weight:bold;color:green":"color: #ccc","color:initial"),console.groupEnd()}}]),t}(),za={EICR:105,EIMSK:61,EIFR:60,index:0,iscOffset:0,interrupt:2},Xa=(0,l.Z)((0,u.Z)({},za),{index:1,iscOffset:2,interrupt:4}),ja=(0,l.Z)((0,u.Z)({},za),{index:2,iscOffset:4,interrupt:6}),Qa=(0,l.Z)((0,u.Z)({},za),{index:3,iscOffset:6,interrupt:8}),$a=(0,l.Z)((0,u.Z)({},za),{EICR:106,index:4,iscOffset:0,interrupt:10}),Ya=(0,l.Z)((0,u.Z)({},$a),{index:5,iscOffset:2,interrupt:12}),ts=(0,l.Z)((0,u.Z)({},$a),{index:6,iscOffset:4,interrupt:14}),es=(0,l.Z)((0,u.Z)({},$a),{index:7,iscOffset:6,interrupt:16}),is={PCIE:1,PCICR:104,PCIFR:59,PCMSK:108,pinChangeInterrupt:20},ns=(0,l.Z)((0,u.Z)({},Qi.m4),{pinChange:{PCIE:0,PCICR:104,PCIFR:59,PCMSK:107,pinChangeInterrupt:18,mask:255,offset:0},pinChangeIndices:[0,1,2,3,4,5,6,7],externalInterrupts:[]}),rs=(0,l.Z)((0,u.Z)({},Qi.cS),{externalInterrupts:[za,Xa,ja,Qa]}),as=(0,l.Z)((0,u.Z)({},Qi.bO),{pinChange:(0,l.Z)((0,u.Z)({},is),{mask:1,offset:0}),externalInterrupts:[null,null,null,null,$a,Ya,ts,es]}),ss=(0,l.Z)((0,u.Z)({},Qi.Oo),{pinChange:(0,l.Z)((0,u.Z)({},is),{mask:127,offset:1}),externalInterrupts:[]}),os=(0,l.Z)((0,u.Z)({},Qi.pW),{pinChange:{PCIE:2,PCICR:104,PCIFR:59,PCMSK:109,pinChangeInterrupt:22,mask:255,offset:0},pinChangeIndices:[0,1,2,3,4,5,6,7],externalInterrupts:[]}),us={name:"Arduino MEGA 2560",analogPins:["A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","A10","A11","A12","A13","A14","A15"],mcu:Va.ATmega2560,freqMHZ:16e6,createPins:function(t){var e=new Qi.wq(t,Qi.eY),i=new Qi.wq(t,ns),n=new Qi.wq(t,Qi._d),r=new Qi.wq(t,rs),a=new Qi.wq(t,as),s=new Qi.wq(t,Qi.tx),o=new Qi.wq(t,Qi.KT),u=new Qi.wq(t,Qi.lb),l=new Qi.wq(t,ss),c=new Qi.wq(t,os),d=new Qi.wq(t,Qi._R);return{0:{port:a,pin:0,signals:[(0,Na.A_)("RX",0)]},1:{port:a,pin:1,signals:[(0,Na.A_)("TX",0)]},2:{port:a,pin:4},3:{port:a,pin:5},4:{port:o,pin:5},5:{port:a,pin:3},6:{port:u,pin:3},7:{port:u,pin:4},8:{port:u,pin:5},9:{port:u,pin:6},10:{port:i,pin:4},11:{port:i,pin:5},12:{port:i,pin:6},13:{port:i,pin:7},14:{port:l,pin:1,signals:[(0,Na.A_)("TX",3)]},15:{port:l,pin:0,signals:[(0,Na.A_)("RX",3)]},16:{port:u,pin:1,signals:[(0,Na.A_)("TX",2)]},17:{port:u,pin:0,signals:[(0,Na.A_)("RX",2)]},18:{port:r,pin:3,signals:[(0,Na.A_)("TX",1)]},19:{port:r,pin:2,signals:[(0,Na.A_)("RX",1)]},20:{port:r,pin:1,signals:[(0,Na.ss)("SDA")]},21:{port:r,pin:0,signals:[(0,Na.ss)("SCL")]},22:{port:e,pin:0},23:{port:e,pin:1},24:{port:e,pin:2},25:{port:e,pin:3},26:{port:e,pin:4},27:{port:e,pin:5},28:{port:e,pin:6},29:{port:e,pin:7},30:{port:n,pin:7},31:{port:n,pin:6},32:{port:n,pin:5},33:{port:n,pin:4},34:{port:n,pin:3},35:{port:n,pin:2},36:{port:n,pin:1},37:{port:n,pin:0},38:{port:r,pin:7},39:{port:o,pin:2},40:{port:o,pin:1},41:{port:o,pin:0},42:{port:d,pin:7},43:{port:d,pin:6},44:{port:d,pin:5},45:{port:d,pin:4},46:{port:d,pin:3},47:{port:d,pin:2},48:{port:d,pin:1},49:{port:d,pin:0},50:{port:i,pin:3,signals:[(0,Na.Q5)("MISO")]},51:{port:i,pin:2,signals:[(0,Na.Q5)("MOSI")]},52:{port:i,pin:1,signals:[(0,Na.Q5)("SCK")]},53:{port:i,pin:0,signals:[(0,Na.Q5)("SS")]},A0:{port:s,pin:0},A1:{port:s,pin:1},A2:{port:s,pin:2},A3:{port:s,pin:3},A4:{port:s,pin:4},A5:{port:s,pin:5},A6:{port:s,pin:6},A7:{port:s,pin:7},A8:{port:c,pin:0},A9:{port:c,pin:1},A10:{port:c,pin:2},A11:{port:c,pin:3},A12:{port:c,pin:4},A13:{port:c,pin:5},A14:{port:c,pin:6},A15:{port:c,pin:7},SDA:{port:r,pin:1,signals:[(0,Na.ss)("SDA")],net:"20"},SCL:{port:r,pin:0,signals:[(0,Na.ss)("SCL")],net:"21"}}}},ls=(0,l.Z)((0,u.Z)({},Fa),{name:"Arduino Nano",createPins:function(t){var e=Fa.createPins(t);return e.A6=(0,l.Z)((0,u.Z)({},e.A5),{pin:6}),e.A7=(0,l.Z)((0,u.Z)({},e.A5),{pin:7}),e}}),cs={name:"ATtiny85",analogPins:["PB5","PB2","PB4","PB3"],mcu:Va.ATtiny85,freqMHZ:8e6,createPins:function(t){var e=new Qi.wq(t,Ba);return{PB0:{port:e,pin:0,signals:[(0,Na.ss)("SDA")]},PB1:{port:e,pin:1},PB2:{port:e,pin:2,signals:[(0,Na.ss)("SCL")]},PB3:{port:e,pin:3},PB4:{port:e,pin:4},PB5:{port:e,pin:5}}}},ds={"wokwi-arduino-mega":us,"wokwi-arduino-uno":Fa,"wokwi-arduino-nano":ls,"wokwi-attiny85":cs,"wokwi-franzininho":cs};var hs=function(){function t(){(0,r.Z)(this,t)}return(0,a.Z)(t,[{key:"subscribe",value:function(){return function(){return 0}}}]),t}(),vs=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"buffer",[]),(0,s.Z)(this,"unsubscriber",(function(){return 0})),(0,s.Z)(this,"listeners",new Set),this.switchTo(e)}return(0,a.Z)(t,[{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"switchTo",value:function(t){var e=this;this.unsubscriber(),this.unsubscriber=t.subscribe((function(t){var i;(i=e.buffer).push.apply(i,(0,d.Z)(t))}))}},{key:"update",value:function(){if(this.buffer.length){var t=new Uint8Array(this.buffer),e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(t)}}catch(Xs){i=!0,n=Xs}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}this.buffer=[]}}}]),t}(),fs=i(77432),ps=i(76136),gs=i(98004),ys=i(36221),ms='\n#include <stdint.h>\n#include <stdbool.h>\n\n#ifndef WOKWI_API_H\n#define WOKWI_API_H\n\nenum pin_value {\n  LOW = 0,\n  HIGH = 1\n};\n\nenum pin_mode {\n  INPUT = 0,\n  OUTPUT = 1,\n  INPUT_PULLUP = 2,\n  INPUT_PULLDOWN = 3,\n  ANALOG = 4,\n\n  OUTPUT_LOW = 16,\n  OUTPUT_HIGH = 17,\n};\n\nenum edge {\n  RISING = 1,\n  FALLING = 2,\n  BOTH = 3,\n};\n\nint __attribute__((export_name("__wokwi_api_version_1"))) __attribute__((weak)) __wokwi_api_version_1(void) { return 1; }\n\n#ifdef __cplusplus\nextern "C" {\n#endif\n\ntypedef int32_t pin_t;\n#define NO_PIN ((pin_t)-1)\n\ntypedef struct {\n  void *user_data;\n  uint32_t edge;\n  void (*pin_change)(void *user_data, pin_t pin, uint32_t value);\n} pin_watch_config_t;\n\nextern __attribute__((export_name("chipInit"))) void chip_init(void);\n\nextern __attribute__((import_name("pinInit"))) pin_t pin_init(const char *name, uint32_t mode);\n\nextern __attribute__((import_name("pinRead"))) uint32_t pin_read(pin_t pin);\nextern __attribute__((import_name("pinWrite"))) void pin_write(pin_t pin, uint32_t value);\nextern __attribute__((import_name("pinWatch"))) bool pin_watch(pin_t pin, const pin_watch_config_t *config);\nextern __attribute__((import_name("pinWatchStop"))) void pin_watch_stop(pin_t pin);\nextern __attribute__((import_name("pinMode"))) void pin_mode(pin_t pin, uint32_t value);\nextern __attribute__((import_name("pinADCRead"))) float pin_adc_read(pin_t pin);\nextern __attribute__((import_name("pinDACWrite"))) float pin_dac_write(pin_t pin, float voltage);\n\ntypedef uint32_t string_t;\n#define STRING_NULL 0\n\nextern __attribute__((import_name("stringGetLength"))) uint32_t string_get_length(string_t string);\nextern __attribute__((import_name("stringRead"))) uint32_t string_read(string_t string, char *buf, uint32_t buffer_size);\n\nextern __attribute__((import_name("attrInit"))) uint32_t attr_init(const char *name, uint32_t default_value);\nextern __attribute__((import_name("attrInitFloat"))) uint32_t attr_init_float(const char *name, float default_value);\nextern __attribute__((import_name("attrRead"))) uint32_t attr_read(uint32_t attr_id);\nextern __attribute__((import_name("attrReadFloat"))) float attr_read_float(uint32_t attr_id);\nextern __attribute__((import_name("attrStringInit"))) string_t attr_string_init(const char *name);\n\ntypedef struct {\n  void *user_data;\n  uint32_t address;\n  pin_t scl;\n  pin_t sda;\n  bool (*connect)(void *user_data, uint32_t address, bool connect);\n  uint8_t (*read)(void *user_data);\n  bool (*write)(void *user_data, uint8_t data);\n  void (*disconnect)(void *user_data);\n  uint32_t reserved[8];\n} i2c_config_t;\n\ntypedef uint32_t i2c_dev_t;\n\nextern __attribute__((import_name("i2cInit"))) i2c_dev_t i2c_init(const i2c_config_t *config);\n\ntypedef struct {\n  void *user_data;\n  pin_t rx;\n  pin_t tx;\n  uint32_t baud_rate;\n  void (*rx_data)(void *user_data, uint8_t byte);\n  void (*write_done)(void *user_data);\n  uint32_t reserved[8];\n} uart_config_t;\n\ntypedef uint32_t uart_dev_t;\n\nextern __attribute__((import_name("uartInit"))) uart_dev_t uart_init(const uart_config_t *config);\nextern __attribute__((import_name("uartWrite"))) bool uart_write(uart_dev_t uart, uint8_t *buffer, uint32_t count);\n\ntypedef struct {\n  void *user_data;\n  pin_t sck;\n  pin_t mosi;\n  pin_t miso;\n  uint32_t mode;\n  void (*done)(void *user_data, uint8_t *buffer, uint32_t count);\n  uint32_t reserved[8];\n} spi_config_t;\ntypedef uint32_t spi_dev_t;\n\nextern __attribute__((import_name("spiInit"))) spi_dev_t spi_init(const spi_config_t *spi_config);\nextern __attribute__((import_name("spiStart"))) void spi_start(const spi_dev_t spi, uint8_t *buffer, uint32_t count);\nextern __attribute__((import_name("spiStop"))) void spi_stop(const spi_dev_t spi);\n\ntypedef struct {\n  void *user_data;\n  void (*callback)(void *user_data);\n  uint32_t reserved[8];\n} timer_config_t;\n\ntypedef uint32_t timer_t;\n\nextern __attribute__((import_name("timerInit"))) timer_t timer_init(const timer_config_t *config);\nextern __attribute__((import_name("timerStart"))) void timer_start(const timer_t timer, uint32_t micros, bool repeat);\nextern __attribute__((import_name("timerStartNanos"))) void timer_start_ns_d(const timer_t timer, double nanos, bool repeat);\nstatic void timer_start_ns(const timer_t timer, uint64_t nanos, bool repeat) {\n  timer_start_ns_d(timer, (double)nanos, repeat);\n}\nextern __attribute__((import_name("timerStop"))) void timer_stop(const timer_t timer);\n\nextern __attribute__((import_name("getSimNanos"))) double get_sim_nanos_d(void);\n\nstatic uint64_t get_sim_nanos(void) {\n  return (uint64_t)get_sim_nanos_d();\n}\n\ntypedef uint32_t buffer_t;\nextern __attribute__((import_name("framebufferInit"))) buffer_t framebuffer_init(uint32_t *pixel_width, uint32_t *pixel_height);\nextern __attribute__((import_name("bufferRead"))) void buffer_read(buffer_t buffer, uint32_t offset, void *data, uint32_t data_len);\nextern __attribute__((import_name("bufferWrite"))) void buffer_write(buffer_t buffer, uint32_t offset, void *data, uint32_t data_len);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif /* WOKWI_API_H */\n',ws={c:{sourceName:"app.c",sourcePath:"/src/app.c",builder:"clang-wasm",extension:"c",wokwiH:!0},rust:{sourceName:"lib.rs",sourcePath:"/project/lib.rs",builder:"rust-wasm",extension:"rs",wokwiH:!1},verilog:{sourceName:"wokwi.v",sourcePath:"src/wokwi.v",builder:"verilog-cxxrtl",extension:"v",wokwiH:!0}};function ks(t,e,i,n,r){return Zs.apply(this,arguments)}function Zs(){return(Zs=(0,n.Z)((function(t,e,i,n,r){var a,s,u,l,c,v;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:return console.log("[".concat(t,"] \ud83d\udc1e Compiling custom chip...")),(0,o.Z)(e,Uint8Array)&&(e=(new TextDecoder).decode(e)),s=ws[n],[4,(0,Fi.b)([{name:s.sourceName,content:e}].concat((0,d.Z)(s.wokwiH?[{name:"wokwi-api.h",content:ms}]:[])),{builder:s.builder,buildType:"interactive"})];case 1:return!(u=h.sent()).hex||(null===(a=u.stderr)||void 0===a?void 0:a.startsWith("Error: Command failed: clang"))?(l=t.substring(5)+".chip.".concat(s.extension),c=u.stderr.split("\n").slice(1).join("\n").split(s.sourcePath).join("/sketch/"+l),null===r||void 0===r||r(c),console.error("Build failed:",c),[2]):(v=(0,fs.Xs)(u.hex),console.log("[".concat(t,"] \ud83c\udf55 Loading custom chip...")),[2,bs(t,v,i)])}}))}))).apply(this,arguments)}function bs(t,e,i,n){return Cs.apply(this,arguments)}function Cs(){return Cs=(0,n.Z)((function(t,e,i,n){var u,l,c,v,f,p;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:return[4,WebAssembly.compile(e)];case 1:return l=h.sent(),c=new WebAssembly.Memory({initial:2}),v=new gs.v(t,(function(){return c}),i),[4,WebAssembly.instantiate(l,{env:{memory:c,pinInit:v.pinInit.bind(v),pinMode:v.pinMode.bind(v),pinRead:v.pinRead.bind(v),pinWrite:v.pinWrite.bind(v),pinWatch:v.pinWatch.bind(v),pinWatchStop:v.pinWatchStop.bind(v),pinADCRead:v.pinADCRead.bind(v),pinDACWrite:v.pinDACWrite.bind(v),i2cInit:v.i2cInit.bind(v),uartInit:v.uartInit.bind(v),uartWrite:v.uartWrite.bind(v),spiInit:v.spiInit.bind(v),spiStart:v.spiStart.bind(v),spiStop:v.spiStop.bind(v),stringGetLength:v.stringGetLength.bind(v),stringRead:v.stringRead.bind(v),attrInit:v.attrInit.bind(v),attrRead:v.attrRead.bind(v),attrInitFloat:v.attrInitFloat.bind(v),attrReadFloat:v.attrReadFloat.bind(v),attrStringInit:v.attrStringInit.bind(v),getSimNanos:v.getSimNanos.bind(v),timerInit:v.timerInit.bind(v),timerStart:v.timerStart.bind(v),timerStartNanos:v.timerStartNanos.bind(v),timerStop:v.timerStop.bind(v),framebufferInit:v.framebufferInit.bind(v),bufferRead:v.bufferRead.bind(v),bufferWrite:v.bufferWrite.bind(v),debugPrint:function(e){var i=(0,ps.V)(c,e);null===n||void 0===n||n(i,1),console.log("[".concat(t,"] %c%s"),"color: green",i.replace(/\r?\n$/,""))},emscripten_notify_memory_growth:function(){}},wasi_snapshot_preview1:{fd_write:function(e,i,r,a){for(var s=[],o=0,u=new DataView(c.buffer),l=0;l<r;l++){var h,v=u.getUint32(i+8*l,!0),f=u.getUint32(i+8*l+4,!0);o+=f,(h=s).push.apply(h,(0,d.Z)(new Uint8Array(u.buffer,v,f)))}u.setUint32(a,o,!0);var p=(new TextDecoder).decode(new Uint8Array(s)).replace(/\r?\n$/,"");null===n||void 0===n||n(p,e),console.log("[".concat(t,"] %c%s"),"color: green",p)},fd_close:function(){},fd_seek:function(){},fd_fdstat_get:function(t,e){if(1===t||2===t){var i=new DataView(c.buffer);return i.setUint8(e,2),i.setUint32(e+8,0,!0),0}return-1},proc_exit:function(){}}})];case 2:return(f=h.sent()).exports.memory&&(0,o.Z)(f.exports.memory,WebAssembly.Memory)&&(c=f.exports.memory),v.instance=f,[2,(u=function(){function e(i,n,a,o){(0,r.Z)(this,e),(0,s.Z)(this,"buffer",new ys.l(new Uint8Array(v.framebufferWidth*v.framebufferHeight*4))),v.clock=i,v.pins=n,v.attrs=a,v.vars=o,v.buffer=this.buffer;try{var u,l;null===(l=(u=f.exports).chipInit)||void 0===l||l.call(u),console.log("[".concat(t,"] \ud83c\udf1f Custom chip instance created!"))}catch(Xs){console.error("[".concat(t,"] Custom chip instance creation failed:"),Xs)}}return(0,a.Z)(e,[{key:"update",value:function(){var t=this.buffer;return t.dirty?(t.dirty=!1,{value:{pixels:t.data}}):null}},{key:"reset",value:function(){}}]),e}(),(0,s.Z)(u,"pinNames",null!==(p=i.pins)&&void 0!==p?p:[]),u)]}}))})),Cs.apply(this,arguments)}var _s=i(95810),Ss=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"dbg",void 0),(0,s.Z)(this,"fileName",void 0),this.dbg=e,this.fileName=i}return(0,a.Z)(t,[{key:"findPC",value:function(t){var e=this;return this.dbg.lines.filter((function(i){return i.file.endsWith(e.fileName)&&i.line===t&&i.ns}))}},{key:"setBreakpoint",value:function(t){var e=this.findPC(t),i=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value.pc;this.dbg.setBreakpoint(o)}}catch(Xs){n=!0,r=Xs}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"removeBreakpoint",value:function(t){var e=this.findPC(t),i=!0,n=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value.pc;this.dbg.removeBreakpoint(o)}}catch(Xs){n=!0,r=Xs}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}]),t}();var xs=function(){function t(e,i){var n,a;(0,r.Z)(this,t),(0,s.Z)(this,"name",void 0),(0,s.Z)(this,"location",void 0),(0,s.Z)(this,"typeAttr",void 0),(0,s.Z)(this,"unit",void 0),(0,s.Z)(this,"die",void 0),this.unit=e,this.die=i,this.name=null===(n=i.attrs.find((function(t){return t.name===_s.Bp.DW_AT_name})))||void 0===n?void 0:n.value,this.location=null===(a=i.attrs.find((function(t){return t.name===_s.Bp.DW_AT_location})))||void 0===a?void 0:a.value,this.typeAttr=i.attrs.find((function(t){return t.name===_s.Bp.DW_AT_type}))}return(0,a.Z)(t,[{key:"type",get:function(){var t,e=null===(t=this.typeAttr)||void 0===t?void 0:t.value;return null!=e?this.unit.getType(e):void 0}},{key:"toJSON",value:function(){var t;return{name:this.name,type:null===(t=this.type)||void 0===t?void 0:t.name}}}]),t}(),Ps=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"unit",void 0),(0,s.Z)(this,"die",void 0),this.unit=e,this.die=i}return(0,a.Z)(t,[{key:"resolveObjectTypeName",value:function(t){var e=this.unit,i=e.dieAtOffset(e.toUnitOffset(t));if(i){if(i.tag===_s.Jf.DW_TAG_structure_type){var n=i.attrs.find((function(t){return t.name===_s.Bp.DW_AT_name}));if(n)return n.value}var r=i.attrs.find((function(t){return t.name===_s.Bp.DW_AT_type}));return r?this.resolveObjectTypeName(r.value):void 0}}},{key:"resolveName",value:function(t){var e=t.attrs.find((function(t){return t.name===_s.Bp.DW_AT_MIPS_linkage_name}));if(e)return function(t){if(!t.startsWith("_Z"))return t;for(var e=t.slice(2).split(".")[0],i=0,n=!1,r="",a="";i<e.length;)switch(e[i]){case"N":n=!0,i++;break;case"I":r+="<",i++;break;case"E":if(n)return n=!1,r;r+=">",i++;break;case"C":r+="::"+a,"I"===e[i+1]&&i++,i+=2;break;case"D":r+="::~"+a,i+=2;break;default:var s=/^\d*/.exec(e.substring(i));if(s){var o=parseInt(s[0],10);if(n&&r.length>0&&(r+="::"),r+=a=e.substring(i+s[0].length,i+s[0].length+o),i+=s[0].length+o,!n)return r}else i++}return r}(e.value);var i=t.attrs.find((function(t){return t.name===_s.Bp.DW_AT_name}));if(i){var n=t.attrs.find((function(t){return t.name===_s.Bp.DW_AT_object_pointer})),r="";if(n){var a=this.resolveObjectTypeName(n.value);a&&(r="".concat(a,"::"))}return r+i.value}var s=t.attrs.find((function(t){return t.name===_s.Bp.DW_AT_specification}));if(s){var o=this.unit,u=o.dieAtOffset(o.toUnitOffset(s.value));if(u)return this.resolveName(u)}}},{key:"name",get:function(){var t=this.resolveName(this.die);if(t)return t;var e=this.die.attrs.find((function(t){return t.name===_s.Bp.DW_AT_abstract_origin}));if(e){var i=this.unit,n=i.dieAtOffset(i.toUnitOffset(e.value));return n?this.resolveName(n):void 0}}},{key:"getLocals",value:function(){var t,e,i,n,r,a,s,o,u,l,c,d;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:e=(t=this).unit,i=t.die,n=!0,r=!1,a=void 0,h.label=1;case 1:h.trys.push([1,6,7,8]),s=e.dieChildren(i)[Symbol.iterator](),h.label=2;case 2:return(n=(o=s.next()).done)?[3,5]:(u=o.value).depth>0?[3,4]:(c=null===(l=u.attrs.find((function(t){return t.name===_s.Bp.DW_AT_location})))||void 0===l?void 0:l.value,u.tag!==_s.Jf.DW_TAG_variable&&u.tag!==_s.Jf.DW_TAG_formal_parameter||null==c?[3,4]:[4,new xs(e,u)]);case 3:h.sent(),h.label=4;case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return d=h.sent(),r=!0,a=d,[3,8];case 7:try{n||null==s.return||s.return()}finally{if(r)throw a}return[7];case 8:return[2]}}))}}]),t}(),Is=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"index",void 0),(0,s.Z)(this,"pc",void 0),(0,s.Z)(this,"returnPC",void 0),(0,s.Z)(this,"sp",void 0),(0,s.Z)(this,"regs",void 0),(0,s.Z)(this,"func",void 0),(0,s.Z)(this,"file",void 0),(0,s.Z)(this,"line",void 0),(0,s.Z)(this,"column",void 0),this.index=e.index,this.pc=e.pc,this.returnPC=e.returnPC,this.sp=e.sp,this.regs=e.regs,this.func=e.func,e.line&&(this.file=e.line.file,this.line=e.line.line,this.column=e.line.col)}return(0,a.Z)(t,[{key:"locals",value:function(){var t;return null===(t=this.func)||void 0===t?void 0:t.getLocals()}}]),t}(),Ds=function(){function t(e,i,n,a){(0,r.Z)(this,t),(0,s.Z)(this,"lines",void 0),(0,s.Z)(this,"dwarf",void 0),(0,s.Z)(this,"tempBreakpoints",void 0),(0,s.Z)(this,"disposers",void 0),(0,s.Z)(this,"stepOverContext",void 0),(0,s.Z)(this,"prevActiveLineFile",void 0),(0,s.Z)(this,"target",void 0),(0,s.Z)(this,"files",void 0),(0,s.Z)(this,"simulator",void 0),this.target=i,this.files=n,this.simulator=a,this.lines=[],this.tempBreakpoints=new Set,this.disposers=new Set,this.dwarf=new _s.X1(new _s.r2(e,new ji.aX(e).sections));var o=!0,u=!1,l=void 0;try{for(var c,d=this.dwarf.units[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value.lineNumberMachine();if(h){var v=!0,f=!1,p=void 0;try{for(var g,y=h.run()[Symbol.iterator]();!(v=(g=y.next()).done);v=!0){var m=g.value,w=h.files[m.file-1];w&&this.lines.push({file:w.dir+"/"+w.name,line:m.line,col:m.column,pc:m.address,ns:m.is_stmt,bb:m.basic_block,pe:m.prologue_end,eb:m.epilogue_begin,es:m.end_sequence})}}catch(Xs){f=!0,p=Xs}finally{try{v||null==y.return||y.return()}finally{if(f)throw p}}}}}catch(Xs){u=!0,l=Xs}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}var k=n.find((function(t){return"sketch"===(0,Ji.r5)(t.name)})),Z=!0,b=!1,C=void 0;try{for(var _,S=this.files[Symbol.iterator]();!(Z=(_=S.next()).done);Z=!0){var x=_.value,P=x.debugger,I=x.name===(null===k||void 0===k?void 0:k.name)?"sketch.ino":x.name,D=new Ss(this,I),A=!0,R=!1,B=void 0;try{for(var T,E=P.breakpoints[Symbol.iterator]();!(A=(T=E.next()).done);A=!0){var U=T.value;D.setBreakpoint(U.lineNumber)}}catch(Xs){R=!0,B=Xs}finally{try{A||null==E.return||E.return()}finally{if(R)throw B}}this.disposers.add(P.addDebugger(D))}}catch(Xs){b=!0,C=Xs}finally{try{Z||null==S.return||S.return()}finally{if(b)throw C}}}return(0,a.Z)(t,[{key:"getFileName",value:function(t,e){var i=t.lineNumberMachine();if(i){var n=i.files[e-1];return n?'"'.concat(n.dir,"/").concat(n.name,'"'):null}return null}},{key:"evaluateLocation",value:function(t,e){var i=this,n=null;if(t&&(0,o.Z)(t,Uint8Array)&&(n=t),"number"===typeof t){var r=!0,a=!1,s=void 0;try{for(var u,l=this.dwarf.readDebugLoc(t)[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var c=u.value;if(null!=e&&c.start<=e&&c.end>e){n=c.expr;break}}}catch(Xs){a=!0,s=Xs}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}}if(!n)return null;var d=new _s.HC(new _s._R(n),{addressSize:4,readUint8:function(t){return i.target.readUint8(t)},readUint32:function(t){return i.target.readUint32(t)},readRegister:function(t){return i.target.readDwarfRegister(t)},readFrameBase:function(){throw new Error("readFrameBase not implemented!")}}).evaluate();return d||null}},{key:"evaluateVariable",value:function(t,e){var i,n,r=null;try{r=this.evaluateLocation(t.location,e)}catch(Xs){console.warn(Xs)}if(!r)return null;if("String"===(null===(i=t.type)||void 0===i?void 0:i.name)&&"number"===typeof r){for(var a,s=this.target.readUint16(8388608|r),o=this.target.readUint16(8388608|r+4),u=new Uint8Array(o>1024?1024:o),l=0;l<u.length;l++)u[l]=this.target.readUint8(8388608|s+l);return(a=String).fromCharCode.apply(a,(0,d.Z)(u))}"number"===typeof r?n=new Uint8Array(new Uint32Array([this.target.readUint32(r)]).buffer):(r.length>4&&console.warn("Implicit value is too long"),n=r);var c=new DataView(n.buffer),h=t.type;if(!h)return null;for(;h.underlyingType&&"undefined"!==typeof h.underlyingType.encoding;)h=h.underlyingType;var v=h.byteSize,f=h.encoding;switch(f){case _s.G5.DW_ATE_address:return c.getUint16(0,!0);case _s.G5.DW_ATE_boolean:return 0!==c.getUint8(0);case _s.G5.DW_ATE_float:switch(v){case 4:return c.getFloat32(0,!0);case 8:return c.getFloat64(0,!0);default:console.warn("Unsupported float byte size",v)}break;case _s.G5.DW_ATE_signed:switch(v){case 1:return c.getInt8(0);case 2:return c.getInt16(0,!0);case 4:return c.getInt32(0,!0);default:console.warn("Unsupported byte size",v)}break;case _s.G5.DW_ATE_signed_char:return c.getInt8(0);case _s.G5.DW_ATE_unsigned:switch(v){case 1:return c.getUint8(0);case 2:return c.getUint16(0,!0);case 4:return c.getUint32(0,!0);default:console.warn("Unsupported byte size",v)}break;case _s.G5.DW_ATE_unsigned_char:return c.getUint8(0);default:f&&console.warn("Unsupported encoding",_s.G5[f])}return null}},{key:"getGlobals",value:function(){var t,e,i,n,r,a,s,o,u,l,c,d,v;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:t=!0,e=!1,i=void 0,h.label=1;case 1:h.trys.push([1,12,13,14]),n=this.dwarf.units[Symbol.iterator](),h.label=2;case 2:if(t=(r=n.next()).done)return[3,11];a=r.value,s=!0,o=!1,u=void 0,h.label=3;case 3:h.trys.push([3,8,9,10]),l=a.dieIterator()[Symbol.iterator](),h.label=4;case 4:return(s=(c=l.next()).done)?[3,7]:(d=c.value).depth>1||d.tag!==_s.Jf.DW_TAG_variable?[3,6]:[4,new xs(a,d)];case 5:h.sent(),h.label=6;case 6:return s=!0,[3,4];case 7:return[3,10];case 8:return v=h.sent(),o=!0,u=v,[3,10];case 9:try{s||null==l.return||l.return()}finally{if(o)throw u}return[7];case 10:return t=!0,[3,2];case 11:return[3,14];case 12:return v=h.sent(),e=!0,i=v,[3,14];case 13:try{t||null==n.return||n.return()}finally{if(e)throw i}return[7];case 14:return[2]}}))}},{key:"findFunction",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.dwarf.units[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value,o=!0,u=!1,l=void 0;try{for(var c,d=s.dieIterator()[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;if(h.tag===_s.Jf.DW_TAG_subprogram){var v=h.attrs.find((function(t){return t.name===_s.Bp.DW_AT_low_pc})),f=h.attrs.find((function(t){return t.name===_s.Bp.DW_AT_high_pc}));if(v&&f){var p=v.value,g=f.value;if(t>=p&&t<g)return new Ps(s,h)}}}}catch(Xs){u=!0,l=Xs}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}}}catch(Xs){i=!0,n=Xs}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"findLine",value:function(t){var e=null,i=!0,n=!1,r=void 0;try{for(var a,s=this.lines[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=a.value;if(o.pc>t)return e&&!e.es?e:null;e=o}}catch(Xs){n=!0,r=Xs}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"setBreakpoint",value:function(t){this.target.setBreakpoint(t)}},{key:"removeBreakpoint",value:function(t){this.target.clearBreakpoint(t)}},{key:"setTemporaryBreakpoint",value:function(t){this.tempBreakpoints.add(t),this.target.setBreakpoint(t)}},{key:"nextInstruction",value:function(){var t=this.target;if(t.isCallInstruction(t.PC)){var e=t.PC+t.instructionSize(t.PC);this.setTemporaryBreakpoint(e),this.simulator.resume(),this.stepOverContext&&(this.stepOverContext.breakPC=e)}else t.stepInstruction()}},{key:"backtrace",value:function(){var t,e,i,n,r,a,s,o,u,l,c,d,v,f,p,g,y,m;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:t=this,e=new _s.SV(this.dwarf.debugFrame),i=new _s.yy(e,this.target),n=new Array(this.target.registerCount).fill(0).map((function(e,i){return t.target.readRegister(i)})),r=0,a=!0,s=!1,o=void 0,h.label=1;case 1:h.trys.push([1,6,7,8]),u=i.unwind(this.target.PC,this.target.SP,n)[Symbol.iterator](),h.label=2;case 2:return(a=(l=u.next()).done)?[3,5]:(c=l.value,d=c.sp,v=c.regs,f=c.pc,r>0&&(f=this.target.callAddressBefore(f)),g=null!==(p=this.findLine(f))&&void 0!==p?p:void 0,y=this.findFunction(f),[4,new Is({index:r,pc:f,returnPC:c.pc,sp:d,regs:v,line:g,func:y})]);case 3:h.sent(),r++,h.label=4;case 4:return a=!0,[3,2];case 5:return[3,8];case 6:return m=h.sent(),s=!0,o=m,[3,8];case 7:try{a||null==u.return||u.return()}finally{if(s)throw o}return[7];case 8:return[2]}}))}},{key:"updateActiveLine",value:function(t){var e,i=t.file.endsWith("/sketch.ino")?this.files.find((function(t){return"sketch"===(0,Ji.r5)(t.name)})):this.files.find((function(i){return t.file.endsWith(null!==(e=i.debuggerName)&&void 0!==e?e:i.name)}));this.prevActiveLineFile&&(this.prevActiveLineFile.debugger.setActiveLine(0),this.prevActiveLineFile=void 0),i&&(i.debugger.setActiveLine(t.line),this.prevActiveLineFile=i)}},{key:"stepInto",value:function(){var t=this.findLine(this.target.PC);if(!t)return console.warn("No line info for PC",this.target.PC.toString(16)),void this.target.stepInstruction();for(;;){this.target.stepInstruction();var e=this.findLine(this.target.PC);if((null===e||void 0===e?void 0:e.line)!==t.line||(null===e||void 0===e?void 0:e.file)!==t.file){e&&this.updateActiveLine(e);break}}}},{key:"stepOver",value:function(){var t=this.findLine(this.target.PC);if(!t)return console.warn("No line info for PC",this.target.PC.toString(16)),void this.nextInstruction();this.stepOverContext={startLine:t,breakPC:-1},this.stepOverNext(t)}},{key:"stepOverNext",value:function(t){for(;this.simulator.paused;){var e=this.findLine(this.target.PC);if((null===e||void 0===e?void 0:e.line)!==t.line||(null===e||void 0===e?void 0:e.file)!==t.file)return void(this.stepOverContext=void 0);this.nextInstruction()}return!1}},{key:"stepOut",value:function(){var t=this.backtrace();t.next();var e=t.next();if(e.done)console.warn("Can't step out of the outermost frame");else{var i=e.value.returnPC;this.setTemporaryBreakpoint(i),this.simulator.resume()}}},{key:"onBreak",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.tempBreakpoints[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a=n.value;this.target.clearBreakpoint(a)}}catch(Xs){e=!0,i=Xs}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}if(this.tempBreakpoints.clear(),this.stepOverContext){var s=this.stepOverContext,o=s.breakPC,u=s.startLine;o===this.target.PC?this.stepOverNext(u):this.stepOverContext=void 0}var l=this.findLine(this.target.PC);l&&this.updateActiveLine(l)}},{key:"onResume",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.files[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.debugger.setActiveLine(0)}}catch(Xs){e=!0,i=Xs}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"dispose",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.files[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.debugger.activeLine=0}}catch(Xs){e=!0,i=Xs}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}var a=!0,s=!1,o=void 0;try{for(var u,l=this.disposers[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){(0,u.value)()}}catch(Xs){s=!0,o=Xs}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}}}]),t}(),As=i(67044),Rs=i(42051),Bs=function(){function t(){var e=this;(0,r.Z)(this,t),(0,s.Z)(this,"pins",[]),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"flash",new Uint8Array(0)),(0,s.Z)(this,"scheduler",void 0),(0,s.Z)(this,"stopped",!0),(0,s.Z)(this,"onBreak",void 0),(0,s.Z)(this,"onDebuggerBreakpoint",void 0),(0,s.Z)(this,"flashProgAddress",0),(0,s.Z)(this,"execute",(function(t){for(var i=e.clock,n=i.cpu.cycles+e.clock.frequency*(t/1e3);i.cpu.cycles<n&&!e.stopped;)i.skipToNextEvent(n),i.tick();return!e.stopped})),this.clock=new Rs.$,this.scheduler=new nn.B(this.execute.bind(this))}return(0,a.Z)(t,[{key:"start",value:function(){var t=this;return(0,n.Z)((function(){return(0,h.__generator)(this,(function(e){return t.stopped&&(t.scheduler.start(),t.stopped=!1),[2]}))}))()}},{key:"stop",value:function(){this.scheduler.stop(),this.stopped=!0}},{key:"singleStep",value:function(){}},{key:"runToBreak",value:function(){}},{key:"cpuMillis",get:function(){return this.clock.nanos/1e6}},{key:"cpuNanos",get:function(){return this.clock.nanos}},{key:"running",get:function(){return!this.stopped}},{key:"addEvent",value:function(t,e){this.clock.addEvent(t,e)}},{key:"createEvent",value:function(t){return this.clock.createEvent(t)}},{key:"gdbMessage",value:function(){return null}},{key:"rewindInstruction",value:function(){}}]),t}(),Ts=i(60286),Es=function(){function t(){(0,r.Z)(this,t)}return(0,a.Z)(t,[{key:"write",value:function(){}}]),t}(),Us=i(41725),Ns=function(){function t(e,i,n,a){(0,r.Z)(this,t),(0,s.Z)(this,"partId",void 0),(0,s.Z)(this,"pinNames",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"clock",void 0),this.partId=e,this.pinNames=i,this.pins=n,this.clock=a}return(0,a.Z)(t,[{key:"get",value:function(t){this.pinNames.includes(t)||console.warn('Part "'.concat(this.partId,'" requested undefined pin: "').concat(t,'"'));var e=(0,Us.r4)(this.partId,t),i=this.pins.get(e);return i||new X.U(new an.Y(this.clock),e)}},{key:"getIfAttached",value:function(t){return this.attached(t)?this.get(t):null}},{key:"attached",value:function(t){var e=(0,Us.r4)(this.partId,t);return this.pinNames.includes(t)&&this.pins.has(e)}}]),t}(),Os=i(57954),Ms=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"nodes",void 0),(0,s.Z)(this,"pins",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.nodes=new Map,this.pins=new Map}return(0,a.Z)(t,[{key:"clear",value:function(){this.nodes.clear(),this.pins.clear()}},{key:"getOrCreatePin",value:function(t){var e=this.pins.get(t);if(!e){var i=new an.Y(this.clock);this.nodes.set(t,i),e=new X.U(i,t),this.pins.set(t,e)}return e}}]),t}(),Ls="$mcu",Vs=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"controllers",void 0),(0,s.Z)(this,"mcuId",void 0),(0,s.Z)(this,"rx",void 0),(0,s.Z)(this,"tx",void 0),(0,s.Z)(this,"netlist",void 0),(0,s.Z)(this,"mcuPinToBoardPin",void 0),(0,s.Z)(this,"netPinToMCUPin",void 0),(0,s.Z)(this,"mcu",void 0),(0,s.Z)(this,"chipControllers",void 0),this.mcu=e,this.chipControllers=i,this.controllers=[],this.mcuId=Ls,this.rx=new hs,this.tx=new Es,this.netlist=new Ms(this.mcu),this.mcuPinToBoardPin=new Map,this.netPinToMCUPin=new Map}return(0,a.Z)(t,[{key:"attach",value:function(t){var e,i;this.netlist.clear();var n,r=(0,d.Z)(t.connections),a=null!==(n=null===(e=t.findMCU())||void 0===e?void 0:e.id)&&void 0!==n?n:Ls,s=!0,o=!1,u=void 0;try{for(var l,c=this.mcu.pins[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var h=l.value;h.net&&h.net!==h.name&&r.push(Ts.aG.create(["".concat(a,":").concat(h.name),"".concat(a,":").concat(h.net),""]))}}catch(Xs){o=!0,u=Xs}finally{try{s||null==c.return||c.return()}finally{if(o)throw u}}var f=null===(i=t.board)||void 0===i?void 0:i.pins,p=!0,g=!1,y=void 0;try{for(var m,w=(null!==f&&void 0!==f?f:[])[Symbol.iterator]();!(p=(m=w.next()).done);p=!0){var k=m.value;"string"!==typeof k.target||k.target.includes(":")||r.push(Ts.aG.create(["".concat(a,":").concat(k.name),"".concat(a,":_mcu$").concat(k.target),""]))}}catch(Xs){g=!0,y=Xs}finally{try{p||null==w.return||w.return()}finally{if(g)throw y}}var Z=(0,Us.XP)(r),b=!0,C=!1,_=void 0;try{for(var S,x=new Set(Z.values())[Symbol.iterator]();!(b=(S=x.next()).done);b=!0){var P=S.value.pins,I=new an.Y(this.mcu),D=!0,A=!1,R=void 0;try{for(var B,T=P[Symbol.iterator]();!(D=(B=T.next()).done);D=!0){var E=B.value;this.netlist.nodes.set(E,I),this.netlist.pins.set(E,new X.U(I,E))}}catch(Xs){A=!0,R=Xs}finally{try{D||null==T.return||T.return()}finally{if(A)throw R}}}}catch(Xs){C=!0,_=Xs}finally{try{b||null==x.return||x.return()}finally{if(C)throw _}}this.mcuPinToBoardPin.clear(),this.netPinToMCUPin.clear();var U=!0,N=!1,O=void 0;try{for(var M,L=this,V=function(){var t=M.value,e=L.netlist.getOrCreatePin((0,Us.r4)(a,t.name));if("target"in t){var i=L.mcu.pins.find((function(e){return e.name===t.target}));if(i)i.attach(e),L.mcuPinToBoardPin.set(i.name,t.name),L.netPinToMCUPin.set((0,Us.r4)(a,t.name),i);else if("string"!==typeof t.target&&"power"===t.target.type){new tn.E(t.name,t.target.voltage?X.J.High:X.J.Low).attach(e)}}else L.netPinToMCUPin.set((0,Us.r4)(a,t.name),t),t.attach(e)},F=(f||this.mcu.pins)[Symbol.iterator]();!(U=(M=F.next()).done);U=!0)V()}catch(Xs){N=!0,O=Xs}finally{try{U||null==F.return||F.return()}finally{if(N)throw O}}var J=this.chipControllers,W=this.netlist.pins,H=!0,K=!1,q=void 0;try{for(var G,z=this,j=function(){var t,e=G.value,i=null!==(t=Bi[e.type])&&void 0!==t?t:J[e.type];if(i){var n={initFloat:function(t,i){e.setFloatVar(t,(0,Os.R)(e.attrs.get(t),i))},readFloat:function(t){return e.readFloatVar(t,0)},autorun:v.EH},r=new i(z.mcu,new Ns(e.id,i.pinNames,W,z.mcu),e.attrs,n,J);z.controllers.push([e,r])}},Q=t.parts[Symbol.iterator]();!(H=(G=Q.next()).done);H=!0)j()}catch(Xs){K=!0,q=Xs}finally{try{H||null==Q.return||Q.return()}finally{if(K)throw q}}this.mcuId=a,this.createSerialMonitor()}},{key:"initSimulation",value:function(t,e){var i=this;return(0,n.Z)((function(){var n;return(0,h.__generator)(this,(function(r){switch(r.label){case 0:return n=i.controllers.map((function(i){var n,r=(0,c.Z)(i,2)[1];return null===(n=r.init)||void 0===n?void 0:n.call(r,{files:t,wifi:e})})),[4,Promise.all(n)];case 1:return r.sent(),[2]}}))}))()}},{key:"createSerialMonitor",value:function(){var t,e,i,n=this.mcu,r=this.mcuPinToBoardPin,a=this.netlist.pins,s=this.mcu.defaultUartPins,u=new Ns("$serialMonitor",["RX","TX"],a,n),l=u.getIfAttached("RX"),c=u.getIfAttached("TX"),d=function(e){return null!==(t=e&&r.get(e))&&void 0!==t?t:e},h=null!==(e=d(null===s||void 0===s?void 0:s.rx))&&void 0!==e?e:"$_RX",v=null!==(i=d(null===s||void 0===s?void 0:s.tx))&&void 0!==i?i:"$_TX",f=new Ns(this.mcuId,[h,v],a,n);l?this.rx=new x.g(n,l):n.serialInterface?this.rx=n.serialInterface:this.rx=new x.g(n,f.get(h)),(0,o.Z)(this.rx,x.g)&&(this.rx.autoBaudRate=!0),c?this.tx=new P.x(n,c):n.serialInterface?this.tx=n.serialInterface:this.tx=new P.x(n,f.get(v)),(0,o.Z)(this.tx,P.x)&&(this.tx.autoBaudRate=!0)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[],i=!0,n=!1,r=void 0;try{for(var a,s=this.controllers[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o=(0,c.Z)(a.value,2),u=o[0],l=o[1],d=l.update(t);d&&e.push({id:u.id,update:d})}}catch(Xs){n=!0,r=Xs}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}return e}},{key:"dispatchEvent",value:function(t,e){var i=!0,n=!1,r=void 0;try{for(var a,s=this.controllers[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var o,u=(0,c.Z)(a.value,2),l=u[0],d=u[1];if(l.id===t)null===(o=d.onEvent)||void 0===o||o.call(d,e)}}catch(Xs){n=!0,r=Xs}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"pause",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.controllers[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a,s=(0,c.Z)(n.value,2)[1];null===(a=s.pause)||void 0===a||a.call(s)}}catch(Xs){e=!0,i=Xs}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"resume",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.controllers[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a,s=(0,c.Z)(n.value,2)[1];null===(a=s.resume)||void 0===a||a.call(s)}}catch(Xs){e=!0,i=Xs}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}}},{key:"reset",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.controllers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,c.Z)(r.value,2)[1].reset(t)}}catch(Xs){i=!0,n=Xs}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"findPin",value:function(t){return this.netlist.pins.get(t)}},{key:"queryPin",value:function(t,e){var i,n=this.netPinToMCUPin.get((0,Us.r4)(t,e));if(!n||(0,o.Z)(n,tn.E)||(0,o.Z)(n,en))return null;var r=null===(i=n.peripheralInfo)||void 0===i?void 0:i.call(n),a=this.netlist.getOrCreatePin((0,Us.r4)(this.mcuId,e)).state;return{mode:null!=r?"peripheral":"gpio",signalInfo:null!==r&&void 0!==r?r:void 0,outputEnable:n.outputEnable,state:a}}},{key:"serialRx",get:function(){return this.rx}},{key:"serialTx",get:function(){return this.tx}}]),t}(),Fs=i(24723);function Js(t,e){for(var i=t.toString();i.length<e;)i="0"+i;return i}function Ws(t){var e=Math.floor(1e3*t)%1e3,i=Math.floor(t%60),n=Math.floor(t/60);return"".concat(Js(n,2),":").concat(Js(i,2),".").concat(Js(e,3))}var Hs,Ks=i(21706);function qs(t){return Gs.apply(this,arguments)}function Gs(){return Gs=(0,n.Z)((function(t){return(0,h.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t()];case 1:return[2,[e.sent(),null]];case 2:return[2,[null,e.sent()]];case 3:return[2]}}))})),Gs.apply(this,arguments)}!function(t){t[t.Stopped=0]="Stopped",t[t.Running=1]="Running",t[t.Paused=2]="Paused"}(Hs||(Hs={}));var zs=function(){function t(e){var i=this;(0,r.Z)(this,t),(0,s.Z)(this,"abortController",void 0),(0,s.Z)(this,"simulationController",void 0),(0,s.Z)(this,"lastOptions",void 0),(0,s.Z)(this,"bufferedSerialRx",void 0),(0,s.Z)(this,"boardRegistry",void 0),(0,s.Z)(this,"debuggerStore",void 0),(0,s.Z)(this,"mcu",void 0),(0,s.Z)(this,"building",void 0),(0,s.Z)(this,"buildTime",void 0),(0,s.Z)(this,"buildStartTime",void 0),(0,s.Z)(this,"paused",void 0),(0,s.Z)(this,"restarting",void 0),(0,s.Z)(this,"breakpoint",void 0),(0,s.Z)(this,"debugging",void 0),(0,s.Z)(this,"buildResult",void 0),(0,s.Z)(this,"showPioDebugger",void 0),(0,s.Z)(this,"showSDCardDownload",void 0),(0,s.Z)(this,"sdCardDownloadSkipped",void 0),(0,s.Z)(this,"serialMontiorDisabled",void 0),(0,s.Z)(this,"lastUpdate",void 0),(0,s.Z)(this,"debuggerSourceFiles",void 0),(0,s.Z)(this,"lastUpdatedNanos",void 0),(0,s.Z)(this,"debugger",void 0),(0,s.Z)(this,"wifiManager",void 0),(0,s.Z)(this,"partValues",void 0),(0,s.Z)(this,"overrideHex",void 0),(0,s.Z)(this,"wifiGateway",void 0),(0,s.Z)(this,"localLibraryDirectory",void 0),(0,s.Z)(this,"speedElement",void 0),(0,s.Z)(this,"timeElement",void 0),(0,s.Z)(this,"onChipOutput",void 0),(0,s.Z)(this,"onBuildFailure",void 0),(0,s.Z)(this,"serial",void 0),this.serial=e,this.abortController=null,this.simulationController=null,this.lastOptions=null,this.bufferedSerialRx=new vs(new hs),this.boardRegistry=new Ni,this.debuggerStore=new Oi,this.mcu=null,this.building=!1,this.buildTime=0,this.buildStartTime=null,this.paused=!1,this.restarting=!1,this.breakpoint=!1,this.debugging=!1,this.buildResult=null,this.showPioDebugger=!1,this.showSDCardDownload=!1,this.sdCardDownloadSkipped=!1,this.serialMontiorDisabled=!1,this.lastUpdate={},this.debuggerSourceFiles=[],this.lastUpdatedNanos=-1,this.partValues={},this.speedElement=null,this.timeElement=null,this.onChipOutput=function(){},this.onBuildFailure=function(t){console.log(t),alert("Build failed!")},(0,v.rC)(this),this.bufferedSerialRx.subscribe((function(t){if(!i.serialMontiorDisabled){var e=!0,n=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var o=a.value;i.serial.appendSerial(o)}}catch(Xs){n=!0,r=Xs}finally{try{e||null==s.return||s.return()}finally{if(n)throw r}}}})),window.addEventListener("visibilitychange",(function(){var t,e;i.paused||(document.hidden?null===(t=i.simulationController)||void 0===t||t.pause():null===(e=i.simulationController)||void 0===e||e.resume())}))}return(0,a.Z)(t,[{key:"running",get:function(){return!!this.mcu}},{key:"status",get:function(){return this.running?this.paused?Hs.Paused:Hs.Running:Hs.Stopped}},{key:"reportGCCErrors",value:function(t,e){if(this.lastOptions){var i=(0,f.G_)(this.lastOptions.files);(0,f.oL)(i)===Li.IK&&i.setGCCErrors(t,e)}}},{key:"build",value:function(t,e){var i=this;return(0,n.Z)((function(){var n,r,a,s,o,d,v,f,p,y,m,w,k,Z,b,C,_,S,x,P,I;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:return i.lastOptions=t,a=t.diagram,s=t.files,o=t.listing,d=t.debug,v=t.elf,f=a.findMCU(),y=parseInt(null!==(p=null===f||void 0===f?void 0:f.attrs.get("__fakeRamSize"))&&void 0!==p?p:"0",10),w=(0,Tt.Z)(null!==(m=null===f||void 0===f?void 0:f.attrs.get("frequency"))&&void 0!==m?m:"0"),Z=null!==(k=null===f||void 0===f?void 0:f.attrs.get("env"))&&void 0!==k?k:"",(C=(0,g.nr)(null!==(b=null===f||void 0===f?void 0:f.type)&&void 0!==b?b:"",Z))?(_=(0,l.Z)((0,u.Z)({elf:v,listing:o,debug:d},y&&{ramSize:y},w&&{cpuFreq:w}),{symbols:C.startsWith("esp32")}),[4,qs((function(){return(0,Fi.b)(s,{abortSignal:e,board:C,builder:null===f||void 0===f?void 0:f.attrs.get("builder"),options:_,userId:t.userId,machineId:t.machineId,localLibraryDirectory:i.localLibraryDirectory,projectId:t.projectId,tempProjectId:t.tempProjectId,buildType:t.thumbnail?"thumbnail":"interactive"})}))]):[2,{hex:{hex:""},hexError:"No microcontroller found in project"}];case 1:return S=c.Z.apply(void 0,[h.sent(),2]),x=S[0],P=S[1],(null===x||void 0===x||null===(n=x.stderr)||void 0===n?void 0:n.includes("Error during build"))&&(x.hex=""),i.reportGCCErrors((null===x||void 0===x?void 0:x.stderr)||"",(null!==(I=null===x||void 0===x||null===(r=x.hex)||void 0===r?void 0:r.length)&&void 0!==I?I:0)>0),[2,{hex:x,hexError:P}]}}))}))()}},{key:"loadPrebuiltHex",value:function(t){return{hex:{hex:t,stderr:"",stdout:""},hexError:null}}},{key:"skipSDCardDownload",value:function(){this.sdCardDownloadSkipped=!0}},{key:"ensureSDCardFiles",value:function(t){var e=this;return(0,n.Z)((function(){var i;return(0,h.__generator)(this,(function(n){switch(n.label){case 0:return(i=t.filter((function(t){return t.downloading})).map((function(t){return(0,v.gx)((function(){return!t.downloading}))}))).length?(e.showSDCardDownload=!0,e.sdCardDownloadSkipped=!1,[4,Promise.race([Promise.all(i),(0,v.gx)((function(){return e.sdCardDownloadSkipped}))])]):[3,2];case 1:n.sent(),(0,v.z)((function(){e.showSDCardDownload=!1})),n.label=2;case 2:return[2,t.filter((function(t){return t.buffer})).map((function(t){return{name:t.name.substring(Li.ir.length),content:new Uint8Array(t.buffer)}}))]}}))}))()}},{key:"getRuntime",value:function(t,e,i){var n,r=null===e||void 0===e?void 0:e.split("-"),a=null===r||void 0===r?void 0:r[0],s=null===r||void 0===r?void 0:r.slice(1).join("-"),o=t.environments[a];if(!o)return null;switch(a){case"kaluma":var c,d,h=null!==(d=null===(c=i.find((function(t){return"code.js"===t.name})))||void 0===c?void 0:c.content)&&void 0!==d?d:"none";o.fs&&(o=(0,l.Z)((0,u.Z)({},o),{fs:(0,l.Z)((0,u.Z)({},o.fs),{overlays:[{offset:1048576,data:(new TextEncoder).encode(h+"\0")}]})}));break;case"circuitpython":o.fs||(o=(0,l.Z)((0,u.Z)({},o),{fs:{type:"fat",flashOffset:2097152,blockSize:512,numBlocks:1024}}))}return o.firmware&&o.defaultVersion?{firmwareURL:o.firmware.replace("$VERSION",s||o.defaultVersion),type:null!==(n=o.type)&&void 0!==n?n:"binary",fs:o.fs}:null}},{key:"loadCustomBoards",value:function(t){var e=this;return(0,n.Z)((function(){return(0,h.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.boardRegistry.loadBoards(t.parts.map((function(t){return t.type})).filter((function(t){return t.startsWith("board-")})).map((function(t){return t.replace(/^board-/,"")})))];case 1:return i.sent(),[2]}}))}))()}},{key:"startBuildTimer",value:function(){var t=this;this.buildStartTime&&(this.buildTime=(new Date).getTime()-this.buildStartTime.getTime(),setTimeout((function(){return t.startBuildTimer()}),100))}},{key:"start",value:function(t){var e=this;return(0,n.Z)((function(){var i,n,r,a,s,c,d,v,f,p,g,y,m,w,k,Z,b,C,_;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:t.debug&&(t=(0,l.Z)((0,u.Z)({},t),{elf:!0})),e.lastOptions=t,i=null,h.label=1;case 1:return h.trys.push([1,,12,13]),null===(n=e.abortController)||void 0===n||n.abort(),e.debugging=!!t.debug,e.building=!0,e.buildStartTime=new Date,e.abortController=new AbortController,i=e.abortController,c=e.abortController.signal,e.mcu&&e.stop(),e.startBuildTimer(),[4,e.loadCustomBoards(t.diagram)];case 2:return h.sent(),d=t.diagram.board,v=t.files.find((function(t){return"main.py"===t.name}))?"micropython":"",p=d?e.getRuntime(d,null!==(f=null===(r=t.diagram.findMCU())||void 0===r?void 0:r.attrs.get("env"))&&void 0!==f?f:v,t.files):void 0,g=p&&"plotter"!==(null===(a=t.diagram.serialMonitor)||void 0===a?void 0:a.display)?"terminal":null===(s=t.diagram.serialMonitor)||void 0===s?void 0:s.display,e.serial.init((0,Vi.m)(g)),e.showPioDebugger=!1,d?[3,4]:[4,e.loadHex("",t.diagram,!0,(new AbortController).signal,t.files,void 0,void 0,void 0,t.chips)];case 3:return[2,h.sent()];case 4:return[4,e.ensureSDCardFiles(null!==(y=t.sdCardFiles)&&void 0!==y?y:[])];case 5:return fi.files=h.sent(),p?[2,e.startRuntime(p,t,c)]:(w=null!==(m=t.sideHex)&&void 0!==m?m:e.overrideHex,(0,o.Z)(w,ArrayBuffer)?[4,e.loadHex("",t.diagram,!t.autoPause,c,t.files,w,void 0,void 0,t.chips)]:[3,7]);case 6:return[2,h.sent()];case 7:return w?(C=e.loadPrebuiltHex(w),[3,10]):[3,8];case 8:return[4,e.build(t,c)];case 9:C=h.sent(),h.label=10;case 10:return Z=(k=C).hex,b=k.hexError,c.aborted?(console.log("Build aborted"),[2]):(e.buildResult=Z,b?(console.error(b),alert("Build server failure: "+b),[2]):(null===Z||void 0===Z?void 0:Z.hex)?[4,e.loadHex(Z.hex,t.diagram,!t.autoPause,c,t.files,void 0,void 0,void 0,t.chips)]:(e.onBuildFailure(null!==(_=null===Z||void 0===Z?void 0:Z.stderr)&&void 0!==_?_:"Unknown build error"),[2]));case 11:return h.sent(),[3,13];case 12:return i&&e.abortController===i&&(e.building=!1,e.buildStartTime=null,e.abortController=null),[7];case 13:return[2]}}))}))()}},{key:"startRuntime",value:function(t,e,i){var r=this;return(0,n.Z)((function(){var n,a,s,o,u,l,c,v,f,p;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:return h.trys.push([0,,12,13]),[4,fetch(t.firmwareURL)];case 1:return a=h.sent(),i.aborted?[2]:"hex"!==t.type?[3,3]:[4,a.text()];case 2:return o=h.sent(),[3,4];case 3:o="",h.label=4;case 4:return s=o,"binary"!==t.type?[3,6]:[4,a.arrayBuffer()];case 5:return l=h.sent(),[3,7];case 6:l=void 0,h.label=7;case 7:return u=l,i.aborted?[2]:(c=null===(n=e.files.find((function(t){return"requirements.txt"===t.name})))||void 0===n?void 0:n.content)?[4,zi(c)]:[3,9];case 8:return p=h.sent(),[3,10];case 9:p=[],h.label=10;case 10:return f=d.Z.apply(void 0,[p]).concat((0,d.Z)(e.files),(0,d.Z)(null!==(v=e.binaryFiles)&&void 0!==v?v:[])),[4,r.loadHex(s,e.diagram,!0,i,f,u,t.fs,t.firmwareURL,e.chips)];case 11:return h.sent(),[3,13];case 12:return r.building=!1,[7];case 13:return[2]}}))}))()}},{key:"createMCURunner",value:function(t,e,r,a,s,o){var u=this;return(0,n.Z)((function(){var n,l,c,d,v,f,p,g,y,m,w,k,Z,b,C,_,S;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:switch(u.wifiManager=void 0,l=(null===(n=u.buildResult)||void 0===n?void 0:n.hex)===e?u.buildResult.symbols:void 0,t){case"esp32":case"esp32-c3":case"esp32-c6":case"esp32-s2":case"esp32-s3":return[3,1];case"rp2040":return[3,6];case"avr":return[3,8];case"stm32f103c8":case"stm32l432kc":return[3,9];case null:return[3,11]}return[3,12];case 1:return c=null===r||void 0===r?void 0:r.attrs.get("firmwareOffset"),d=null===r||void 0===r?void 0:r.attrs.get("flashSize"),f=null!==(v=null===r||void 0===r?void 0:r.attrs.get("psramSize"))&&void 0!==v?v:"4",p="1"===(null===r||void 0===r?void 0:r.attrs.get("fullBoot")),[4,Promise.all([i.e(2206),i.e(9937),i.e(8559)]).then(i.bind(i,68559))];case 2:return g=new(h.sent().ESPRunner)(e,{firmwareBinary:s,firmwareOffset:c?parseInt(c):void 0,flashSizeMB:d?parseInt(d,10):void 0,psramSizeMB:f?parseInt(f,10):void 0,fullBoot:p,chip:t,symbols:l,partitionsCsv:(0,Ji.LR)(null===a||void 0===a?void 0:a.find((function(t){return"partitions.csv"===t.name}))),noCyclesOpt:"disable"===(null===r||void 0===r?void 0:r.attrs.get("__timingOptimizations")),badgeApp:null===r||void 0===r?void 0:r.attrs.get("badgeApp"),idlePC:"https://wokwi.github.io/firmware-assets/circuitpython/adafruit-circuitpython-franzininho_wifi_wroom-en_US-7.0.0.bin"===o?1074402670:0}),u.wifiManager=g.wifi,[4,g.loadBootrom()];case 3:return h.sent(),"1"!==(null===r||void 0===r?void 0:r.attrs.get("fastTLS"))?[3,5]:[4,g.patchTLS()];case 4:h.sent(),h.label=5;case 5:return[2,g];case 6:return[4,Promise.all([i.e(3101),i.e(3368),i.e(8107)]).then(i.bind(i,53368))];case 7:return[2,new(h.sent().RPRunner)(e,{showPIODebugger:function(){u.togglePIODebugger(!0)},firmwareBinary:s,python:!!o&&!(null===(y=null===r||void 0===r?void 0:r.attrs.get("env"))||void 0===y?void 0:y.startsWith("kaluma-")),patchCircuitPython:null!==(w=null===(m=null===r||void 0===r?void 0:r.attrs.get("env"))||void 0===m?void 0:m.startsWith("circuitpython-"))&&void 0!==w&&w,readonlyFlash:"1"===(null===r||void 0===r?void 0:r.attrs.get("__readonlyFlash"))})];case 8:return Z=parseInt(null!==(k=null===r||void 0===r?void 0:r.attrs.get("__fakeRamSize"))&&void 0!==k?k:"0",10),C=(0,Tt.Z)(null!==(b=null===r||void 0===r?void 0:r.attrs.get("frequency"))&&void 0!==b?b:"0"),S=function(t){var e;return null!==(e=ds[t])&&void 0!==e?e:Fa}(null!==(_=null===r||void 0===r?void 0:r.type)&&void 0!==_?_:""),[2,new Ga(e,S,void 0,{ramSize:Z,frequency:C,firmwareBinary:s})];case 9:return[4,Promise.all([i.e(1311),i.e(5068),i.e(7690),i.e(6723)]).then(i.bind(i,36723))];case 10:return[2,new(h.sent().STM32Runner)(e,{chip:t})];case 11:return[2,new Bs];case 12:return[2]}}))}))()}},{key:"loadChips",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this;return(0,n.Z)((function(){var a,s,o,u,l,v,f,p,g,y,m,w,k,Z,b,C,_,S,x,P,I;return(0,h.__generator)(this,(function(D){switch(D.label){case 0:s={},o=!1,u=function(){var t=(0,n.Z)((function(t,e){var i,n,a;return(0,h.__generator)(this,(function(o){switch(o.label){case 0:return i="".concat(Ti,"/").concat(encodeURIComponent(e)),[4,fetch(i+"/chip.json")];case 1:return[4,o.sent().json()];case 2:return n=o.sent(),[4,fetch(i+"/chip.wasm")];case 3:return[4,o.sent().arrayBuffer()];case 4:return a=o.sent(),[4,bs(t,new Uint8Array(a),n,(function(e){r.onChipOutput(t,e)}))];case 5:return s[t]=o.sent(),[2]}}))}));return function(e,i){return t.apply(this,arguments)}}(),l=[],v=!0,f=!1,p=void 0;try{for(g=Object.entries(i)[Symbol.iterator]();!(v=(y=g.next()).done);v=!0)m=(0,c.Z)(y.value,2),w=m[0],k=m[1],l.push(u(w,k))}catch(P){f=!0,p=P}finally{try{v||null==g.return||g.return()}finally{if(f)throw p}}Z=!0,b=!1,C=void 0,D.label=1;case 1:D.trys.push([1,6,7,8]),_=function(){var t,e;return(0,h.__generator)(this,(function(i){switch(i.label){case 0:return t=x.value,[4,bs(e="chip-"+t.name,new Uint8Array(t.binary),t.json,(function(t){r.onChipOutput(e,t)}))];case 1:return s[e]=i.sent(),[2]}}))},S=e[Symbol.iterator](),D.label=2;case 2:return(Z=(x=S.next()).done)?[3,5]:[5,(0,h.__values)(_())];case 3:D.sent(),D.label=4;case 4:return Z=!0,[3,2];case 5:return[3,8];case 6:return P=D.sent(),b=!0,C=P,[3,8];case 7:try{Z||null==S.return||S.return()}finally{if(b)throw C}return[7];case 8:return I=function(){var e=(0,n.Z)((function(e){var i,n,a,u,l,c,d,v,f;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:return n=e.name.split(".")[0],a=n+".chip.json",u="chip-"+n,c=null!==(l=null===(i=t.find((function(t){return t.name===a})))||void 0===i?void 0:i.content)&&void 0!==l?l:"",v=null!==(d=(0,Ks.C)("string"===typeof c?c:(new TextDecoder).decode(c)))&&void 0!==d?d:{},[4,ks(u,e.content,v,e.name.endsWith(".rs")?"rust":e.name.endsWith(".v")?"verilog":"c",(function(t){o=!0,r.reportGCCErrors(t,!1),r.onBuildFailure(t)}))];case 1:return(f=h.sent())&&(s[u]=f),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),(a=l).push.apply(a,(0,d.Z)(null===t||void 0===t?void 0:t.filter((function(t){return"chip"===(0,Ji.r5)(t.name)})).map(I))),[4,Promise.all(l)];case 9:return D.sent(),[2,o?null:s]}}))}))()}},{key:"loadHex",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,l=arguments.length>7?arguments[7]:void 0,v=arguments.length>8?arguments[8]:void 0,f=this;return(0,n.Z)((function(){var n,p,g,y,m,w,k,Z,b,C,_,S,x,P,I,D,A,R,B,T,E,U,N,O,M,L,V,F,J,W,H,K,q;return(0,h.__generator)(this,(function(h){switch(h.label){case 0:w=e.findMCU(),k=(0,u.Z)({},e.dependencies.toJSON()),Z=!0,b=!1,C=void 0;try{for(_=e.parts[Symbol.iterator]();!(Z=(S=_.next()).done);Z=!0){x=S.value,P=!0,I=!1,D=void 0;try{for(A=f.boardRegistry.getBoardChips(x.type)[Symbol.iterator]();!(P=(R=A.next()).done);P=!0)B=R.value,k[B.type]=B.type}catch(Xs){I=!0,D=Xs}finally{try{P||null==A.return||A.return()}finally{if(I)throw D}}}}catch(Xs){b=!0,C=Xs}finally{try{Z||null==_.return||_.return()}finally{if(b)throw C}}return a?[4,f.loadChips(a,v,k)]:[3,2];case 1:return E=h.sent(),[3,3];case 2:E={},h.label=3;case 3:return(T=E)?(U=0,N=0,O=function(){var t=(new Date).getTime(),e=L.cpuMillis;if(f.speedElement&&t-U>500){var i=(e-N)/(t-U);N=e,U=t,f.speedElement.textContent="".concat(Math.floor(100*i).toFixed(0),"%")}f.timeElement&&(f.timeElement.textContent=Ws(e/1e3))},[4,f.createMCURunner(null!==(M=null===(n=e.board)||void 0===n?void 0:n.mcuType)&&void 0!==M?M:null,t,w,a,s,l)]):[2];case 4:return(L=h.sent()).scheduler.afterRun=O,(null===r||void 0===r?void 0:r.aborted)?[2]:((null===(p=f.buildResult)||void 0===p?void 0:p.hex)===t&&f.buildResult.elf&&f.debugging&&L.debuggerTarget&&(F=(null!==a&&void 0!==a?a:[]).filter((function(t){return Li.d$.is(t)})),f.debuggerSourceFiles=null!==(J=null===(V=f.buildResult.debugSources)||void 0===V?void 0:V.map((function(t){var e,i=(0,c.Z)(t,2),n=i[0],r=i[1];return{name:null!==(e=n.split("/").pop())&&void 0!==e?e:n,debuggerName:n,content:r,debugger:new Mi.r,readonly:!0}})))&&void 0!==J?J:[],f.debugger=new Ds((0,fs.Xs)(f.buildResult.elf),L.debuggerTarget,(0,d.Z)(F).concat((0,d.Z)(f.debuggerSourceFiles)),f)),a&&o?(null===(W=L.adjustFSConfig)||void 0===W||W.call(L,o),[4,(0,As.z)(L.flash,o,a)]):[3,6]);case 5:if(h.sent(),null===r||void 0===r?void 0:r.aborted)return[2];h.label=6;case 6:return(H=new Vs(L,T)).attach(e),f.wifiManager||(f.wifiManager=new Fs.c(L)),f.wifiManager.setCredentials({user:null!==(K=null===(g=f.lastOptions)||void 0===g?void 0:g.userId)&&void 0!==K?K:"",project:null!==(q=null===(y=f.lastOptions)||void 0===y?void 0:y.projectId)&&void 0!==q?q:""}),f.wifiGateway&&f.wifiManager.setGateway(f.wifiGateway),[4,H.initSimulation(null!==a&&void 0!==a?a:[],f.wifiManager)];case 7:return h.sent(),f.simulationController=H,f.lastUpdatedNanos=-1,f.bufferedSerialRx.switchTo(H.serialRx),f.serialMontiorDisabled="never"===(null===(m=e.serialMonitor)||void 0===m?void 0:m.display),L.onBreak=function(){return!!f.debugging&&(L.rewindInstruction(),f.breakpoint=!0,f.pause(),!0)},L.onDebuggerBreakpoint=function(){f.pause()},f.mcu=L,f.breakpoint=!1,i?f.resume():f.paused=!0,f.restarting=!1,f.update(),[2]}}))}))()}},{key:"update",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this,n=this,r=n.simulationController,a=n.mcu;if(r&&a){if(a.cpuNanos!==this.lastUpdatedNanos){var s={};this.bufferedSerialRx.update();var o=!0,u=!1,l=void 0;try{for(var c,d=r.update(e)[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value,v=h.id,f=h.update;s[v]=f.value}}catch(Xs){u=!0,l=Xs}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}this.lastUpdate=s,this.lastUpdatedNanos=a.cpuNanos,Object.assign(this.partValues,s)}(null===(t=this.mcu)||void 0===t?void 0:t.running)&&requestAnimationFrame((function(){return i.update()}))}}},{key:"dispatchEvent",value:function(t,e){var i;null===(i=this.simulationController)||void 0===i||i.dispatchEvent(t,e)}},{key:"pause",value:function(){var t,e,i;this.update(!0),null===(t=this.mcu)||void 0===t||t.stop(),null===(e=this.debugger)||void 0===e||e.onBreak(),this.updateDebugger(),null===(i=this.simulationController)||void 0===i||i.pause(),this.paused=!0}},{key:"resume",value:function(){var t,e,i;this.paused=!1,this.breakpoint=!1,null===(t=this.debugger)||void 0===t||t.onResume(),null===(e=this.mcu)||void 0===e||e.start(),null===(i=this.simulationController)||void 0===i||i.resume(),this.update()}},{key:"stop",value:function(){var t,e,i;null===(t=this.simulationController)||void 0===t||t.reset(!0),this.update(),this.debuggerSourceFiles=[],null===(e=this.debugger)||void 0===e||e.dispose(),null===(i=this.mcu)||void 0===i||i.stop(),this.mcu=null,this.paused=!1,this.simulationController=null,this.partValues={},this.speedElement&&(this.speedElement.textContent="0%")}},{key:"abortBuild",value:function(){var t;null===(t=this.abortController)||void 0===t||t.abort()}},{key:"feedSerial",value:function(t){var e;null===(e=this.simulationController)||void 0===e||e.serialTx.write((new TextEncoder).encode(t))}},{key:"feedSerialBytes",value:function(t){var e;null===(e=this.simulationController)||void 0===e||e.serialTx.write(t)}},{key:"serialControl",value:function(t){var e,i;null===(e=this.mcu)||void 0===e||null===(i=e.setSerialControlPins)||void 0===i||i.call(e,t)}},{key:"findPin",value:function(t){var e;return null===(e=this.simulationController)||void 0===e?void 0:e.findPin(t)}},{key:"togglePIODebugger",value:function(t){this.showPioDebugger=t}},{key:"singleStep",value:function(){var t,e;this.breakpoint=!1,null===(t=this.mcu)||void 0===t||null===(e=t.singleStep)||void 0===e||e.call(t),this.update(!0)}},{key:"forceUpdate",value:function(){this.lastUpdatedNanos=-1,this.update(!0)}},{key:"queryPin",value:function(t,e){var i,n;return null!==(n=null===(i=this.simulationController)||void 0===i?void 0:i.queryPin(t,e))&&void 0!==n?n:null}},{key:"lastUpdateNanos",get:function(){return this.lastUpdatedNanos}},{key:"closeProject",value:function(){this.stop(),this.serial.clearSerial(),this.serial.hideSerial()}},{key:"gdbMessage",value:function(t){var e,i=this;if("c"===t||t.startsWith("vCont;c"))return this.paused&&this.resume(),null;if("s"===t)return this.singleStep(),(0,rn.KC)("S05");if(t.startsWith("vFile:"))return this.gdbFileMessage(t);if(t.startsWith("qRcmd,")){var n=this.gdbMonitor((0,rn.nX)(t.split(",")[1]));if(n)return n}return null===(e=this.mcu)||void 0===e?void 0:e.gdbMessage(t,(function(){i.paused&&i.forceUpdate()}))}},{key:"gdbMonitor",value:function(t){var e,i=null!==(e=t.split(" ")[1])&&void 0!==e?e:"";switch(t){case"reset":case"reset debug":case"reset halt":case"reset init":return this.lastOptions?(console.log("Restarting simulation..."),this.restarting=!0,this.start((0,u.Z)((0,l.Z)((0,u.Z)({},this.lastOptions),{autoPause:""!==i}),"debug"===i?{elf:!0,debug:!0}:{})),(0,rn.KC)("O"+(0,rn.Nc)("Restarting simulation...\n"))+(0,rn.KC)("OK")):(0,rn.KC)("")}}},{key:"gdbFileMessage",value:function(t){var e=(0,c.Z)(t.split(":"),3),i=e[1],n=e[2];switch(i){case"open":var r=n.split(",");if("sketch.elf"===(0,rn.nX)(r[0]))return(0,rn.KC)("F 1");break;case"pread":var a=n.split(",").map((function(t){return parseInt(t,16)})),s=(0,c.Z)(a,3),o=s[0],u=s[1],l=s[2];if(1===o){var d,h=null===(d=this.buildResult)||void 0===d?void 0:d.elf;if(!h)return(0,rn.KC)("F 0;");var v=h.substr(l,u);return(0,rn.KC)("F ".concat(v.length.toString(16),";").concat(v))}return(0,rn.KC)("F -1");case"close":return"1"===n?(0,rn.KC)("F 0"):(0,rn.KC)("F -1")}return(0,rn.KC)("")}},{key:"tempRunner",get:function(){return this.mcu}},{key:"serialRx",get:function(){return this.bufferedSerialRx}},{key:"wifi",get:function(){return this.wifiManager}},{key:"debuggerFiles",get:function(){return this.debuggerSourceFiles.filter((function(t){return t.debugger.activeLine>0}))}},{key:"stepInto",value:function(){var t;null===(t=this.debugger)||void 0===t||t.stepInto(),this.updateDebugger()}},{key:"stepOver",value:function(){var t;null===(t=this.debugger)||void 0===t||t.stepOver(),this.updateDebugger()}},{key:"stepOut",value:function(){var t;null===(t=this.debugger)||void 0===t||t.stepOut(),this.updateDebugger()}},{key:"updateDebugger",value:function(){this.debugger&&this.debuggerStore.update(this.debugger)}}]),t}();(0,h.__decorate)([v.LO],zs.prototype,"mcu",void 0),(0,h.__decorate)([v.LO],zs.prototype,"building",void 0),(0,h.__decorate)([v.LO],zs.prototype,"buildTime",void 0),(0,h.__decorate)([v.LO],zs.prototype,"paused",void 0),(0,h.__decorate)([v.LO],zs.prototype,"restarting",void 0),(0,h.__decorate)([v.LO],zs.prototype,"breakpoint",void 0),(0,h.__decorate)([v.LO],zs.prototype,"debugging",void 0),(0,h.__decorate)([v.LO],zs.prototype,"buildResult",void 0),(0,h.__decorate)([v.LO],zs.prototype,"showPioDebugger",void 0),(0,h.__decorate)([v.LO],zs.prototype,"showSDCardDownload",void 0),(0,h.__decorate)([v.LO],zs.prototype,"sdCardDownloadSkipped",void 0),(0,h.__decorate)([v.LO],zs.prototype,"serialMontiorDisabled",void 0),(0,h.__decorate)([v.LO],zs.prototype,"lastUpdate",void 0),(0,h.__decorate)([v.LO],zs.prototype,"debuggerSourceFiles",void 0),(0,h.__decorate)([v.LO],zs.prototype,"partValues",void 0),(0,h.__decorate)([v.Fl],zs.prototype,"running",null),(0,h.__decorate)([v.Fl],zs.prototype,"status",null),(0,h.__decorate)([v.aD],zs.prototype,"start",null),(0,h.__decorate)([v.aD],zs.prototype,"startRuntime",null),(0,h.__decorate)([v.aD],zs.prototype,"loadHex",null),(0,h.__decorate)([v.aD],zs.prototype,"update",null),(0,h.__decorate)([v.aD],zs.prototype,"togglePIODebugger",null)},21831:function(t,e,i){i.d(e,{V:function(){return u},m:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(68949);function o(t){switch(t){case"never":case"always":case"auto":case"plotter":case"terminal":return t;default:return"auto"}}var u=function(){function t(){(0,n.Z)(this,t),(0,a.Z)(this,"show",!1),(0,a.Z)(this,"terminalMode",!1),(0,a.Z)(this,"showPlotter",!1),(0,a.Z)(this,"textBuffer",""),(0,a.Z)(this,"lines",[]),(0,a.Z)(this,"bytesBuffer",[]),(0,a.Z)(this,"serialUTF8Sequence",[]),(0,a.Z)(this,"listener",void 0),(0,s.ky)(this,{serialUTF8Sequence:!1})}return(0,r.Z)(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";this.show="always"===t||"plotter"===t,this.showPlotter="plotter"===t,this.terminalMode="terminal"===t,this.clearSerial()}},{key:"hideSerial",value:function(){this.show=!1}},{key:"clearSerial",value:function(){this.lines=[],this.textBuffer="",this.serialUTF8Sequence=[],this.bytesBuffer=[]}},{key:"appendSerial",value:function(t){var e;if(this.show=!0,this.terminalMode)return this.bytesBuffer.push(t),void(null===(e=this.listener)||void 0===e||e.call(this));if(t>127&&this.serialUTF8Sequence.push(t),this.serialUTF8Sequence.length>1){var i=new TextDecoder("utf-8",{fatal:!0});try{var n=i.decode(new Uint8Array(this.serialUTF8Sequence));return this.textBuffer=this.textBuffer.slice(0,-(this.serialUTF8Sequence.length-1))+n,void(this.serialUTF8Sequence=[])}catch(a){}}if(this.textBuffer+=String.fromCharCode(t),this.textBuffer.endsWith("\n")){var r=this.textBuffer.substr(0,this.textBuffer.length-1);console.log("[Serial] %c%s","color: blue",r),this.lines.push(r),this.textBuffer=""}}},{key:"togglePlotter",value:function(){this.showPlotter=!this.showPlotter}}]),t}()},17920:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{P:function(){return cacheKey},a:function(){return hashCacheKey}});var _swc_helpers_src_async_to_generator_mjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(47568),_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(29815),_swc_helpers_src_ts_generator_mjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20414),sortByName=function(t,e){return t.name<e.name?-1:t.name>e.name?1:0};function cacheKey(t){var e=t.builder,i=t.board,n=t.sketch,r=t.files,a=t.options,s=(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)(r).sort(sortByName);return JSON.stringify([["version",1],["builder",e],["board",i],["file","sketch.ino",n.trim()]].concat((0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)((null===a||void 0===a?void 0:a.elf)?["option","elf"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)((null===a||void 0===a?void 0:a.listing)?["option","listing"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)((null===a||void 0===a?void 0:a.debug)?["option","debug"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)((null===a||void 0===a?void 0:a.symbols)?["option","symbols"]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)((null===a||void 0===a?void 0:a.ramSize)?["option","ramSize",a.ramSize]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)((null===a||void 0===a?void 0:a.cpuFreq)?["option","cpuFreq",a.cpuFreq]:[]),(0,_swc_helpers_src_to_consumable_array_mjs__WEBPACK_IMPORTED_MODULE_0__.Z)(s.map((function(t){return["file",t.name,t.content.trim()]})))))}function hashCacheKey(t){return _hashCacheKey.apply(this,arguments)}function _hashCacheKey(){return _hashCacheKey=(0,_swc_helpers_src_async_to_generator_mjs__WEBPACK_IMPORTED_MODULE_1__.Z)((function(key){var encoder,hashBuffer,hashArray,err;return(0,_swc_helpers_src_ts_generator_mjs__WEBPACK_IMPORTED_MODULE_2__.__generator)(this,(function(_state){switch(_state.label){case 0:if("undefined"===typeof crypto)return[3,5];_state.label=1;case 1:return _state.trys.push([1,3,,4]),encoder=new TextEncoder,[4,crypto.subtle.digest("sha-256",encoder.encode(key))];case 2:return hashBuffer=_state.sent(),hashArray=Array.from(new Uint8Array(hashBuffer)),[2,hashArray.map((function(t){return t.toString(16).padStart(2,"0")})).join("")];case 3:return err=_state.sent(),console.warn("Hash generation failed",err),[2,null];case 4:return[3,6];case 5:return[2,eval("require")("crypto").createHash("sha256").update(key).digest("hex")];case 6:return[2]}}))})),_hashCacheKey.apply(this,arguments)}},74372:function(t,e,i){i.d(e,{I:function(){return b},b:function(){return _}});var n=i(47568),r=i(26042),a=i(69396),s=i(29815),o=i(20414),u=i(51438),l=i(52951),c=i(14924),d="/_cache/hexi/",h=function(){function t(){(0,u.Z)(this,t),(0,c.Z)(this,"cache",void 0),this.cache=caches.open("hexi-cache")}return(0,l.Z)(t,[{key:"put",value:function(t,e){var i=this;return(0,n.Z)((function(){var n,r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,i.cache];case 1:return n=a.sent(),86400,[4,n.put(d+t,new Response(JSON.stringify(e),{headers:{"content-type":"application/json","cache-control":"public, max-age=".concat(2592e3)}}))];case 2:return a.sent(),[3,4];case 3:return r=a.sent(),console.warn(r),[2];case 4:return[2]}}))}))()}},{key:"get",value:function(t){var e=this;return(0,n.Z)((function(){var i,n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,e.cache];case 1:return[4,r.sent().match(d+t)];case 2:return(i=r.sent())?[4,i.json()]:[3,4];case 3:return[2,r.sent()];case 4:return[3,6];case 5:return n=r.sent(),console.warn(n),[3,6];case 6:return[2,null]}}))}))()}},{key:"clear",value:function(){return(0,n.Z)((function(){return(0,o.__generator)(this,(function(t){throw new Error("Method not implemented.")}))}))()}}]),t}(),v=i(17920),f=i(28715),p=i(23115),g=i(84104);function y(t,e){return m.apply(this,arguments)}function m(){return m=(0,n.Z)((function(t,e){var i,r,a,u,l,c,d,h,v,y,m,w,k,Z;return(0,o.__generator)(this,(function(b){switch(b.label){case 0:if(!e)return[2,[]];i=[],r=!0,a=!1,u=void 0,b.label=1;case 1:b.trys.push([1,7,8,9]),l=(0,p.h)(null!==t&&void 0!==t?t:"")[Symbol.iterator](),b.label=2;case 2:return(r=(c=l.next()).done)?[3,6]:(d=c.value,v=d.replace(/\s/g,"_"),[4,e.getDirectoryHandle(v).catch((function(){return null}))]);case 3:return(y=b.sent())?(w=(m=(h=i).push).apply,k=[h],[4,(0,f.Jj)(y,function(){var t=(0,n.Z)((function(t){var i,n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return["header","source","libraries","sketch"].includes((0,g.r5)(t.name))||"library.properties"===t.name?[4,e.resolve(t)]:[2];case 1:return(i=r.sent())&&"examples"!==i[1]?(n={name:"libraries/".concat(i.join("/"))},[4,t.getFile()]):[2];case 2:return[4,r.sent().text()];case 3:return[2,(n.content=r.sent(),n)]}}))}));return function(e){return t.apply(this,arguments)}}())]):[3,5];case 4:w.apply(m,k.concat(s.Z.apply(void 0,[b.sent()]))),b.label=5;case 5:return r=!0,[3,2];case 6:return[3,9];case 7:return Z=b.sent(),a=!0,u=Z,[3,9];case 8:try{r||null==l.return||l.return()}finally{if(a)throw u}return[7];case 9:return[2,i]}}))})),m.apply(this,arguments)}var w={name:"_wokwi_mbed_speedup_patch.cpp",content:'namespace{\nextern "C" void rtos_attach_idle_hook(void*ptr);\nstatic void idle() {asm("wfe");}\nclass M{public:M();};\nM::M(){rtos_attach_idle_hook((void*)idle);}\nstatic class M __attribute__((used)) c;\n}'},k=function(){function t(){(0,u.Z)(this,t),(0,c.Z)(this,"cache",new Map)}return(0,l.Z)(t,[{key:"put",value:function(t,e){this.cache.set(t,e)}},{key:"get",value:function(t){var e;return null!==(e=this.cache.get(t))&&void 0!==e?e:null}},{key:"clear",value:function(){this.cache.clear()}}]),t}(),Z=i(83454).env.HEXI_URL||"https://wokwi.com",b="undefined"!==typeof localStorage&&"1"===localStorage.getItem("__browserCache")?new h:new k;function C(){return"undefined"!==typeof localStorage&&localStorage.getItem("__hexi")||Z}function _(t,e){return S.apply(this,arguments)}function S(){return(S=(0,n.Z)((function(t,e){var i,n,u,l,c,d,h,f,p,m,k,Z,_,S,x,P,I,D,A,R,B,T;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return i=t.find((function(t){return"sketch"===(0,g.r5)(t.name)})),n=t.find((function(t){return"libraries"===(0,g.r5)(t.name)})),u=["header","source","libraries","sketch","rust-manifest"],h=(d=(0,s.Z)(t.filter((function(t){return u.includes((0,g.r5)(t.name))&&t!==i})))).concat,[4,y(null!==(l=null===n||void 0===n?void 0:n.content)&&void 0!==l?l:"",e.localLibraryDirectory)];case 1:return c=h.apply(d,[s.Z.apply(void 0,[o.sent()])]),f=(null===i||void 0===i?void 0:i.content)||"",p=e.builder,"pipico"!==(k=null!==(m=e.board)&&void 0!==m?m:"uno")||p||c.push(w),Z=e.cache||b,[4,(0,v.a)((0,v.P)({builder:null!==p&&void 0!==p?p:"",board:k,sketch:f,files:c,options:e.options}))];case 2:return _=o.sent(),(x=_)?[4,Z.get(_)]:[3,4];case 3:x=o.sent(),o.label=4;case 4:return(S=x)?[2,Promise.resolve(S)]:(A={sketch:f,files:c,board:k,options:e.options,builder:p,infra:e.machineId&&"private:".concat(e.machineId),projectId:null!==(I=null!==(P=e.projectId)&&void 0!==P?P:e.tempProjectId)&&void 0!==I?I:"unknown",w:{b:e.buildType,p:null!==(D=e.projectId)&&void 0!==D?D:"undefined"!==typeof location?location.pathname:void 0,u:e.userId}},[4,fetch(C()+"/build",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(A),signal:e.abortSignal})]);case 5:if(502===(R=o.sent()).status)throw new Error("Project compilation takes too long. Please remove some libraries and try again, or contact support@wokwi.com for a dedicated private build server.");return T=[{}],[4,R.json()];case 6:return B=a.Z.apply(void 0,[r.Z.apply(void 0,T.concat(o.sent())),{cacheKey:_}]),_?[4,Z.put(_,B)]:[3,8];case 7:o.sent(),o.label=8;case 8:return[2,B]}}))}))).apply(this,arguments)}},23115:function(t,e,i){i.d(e,{h:function(){return r},i:function(){return a}});var n=i(20414);function r(t){var e,i,r,a,s,o,u,l;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:e=!0,i=!1,r=void 0,n.label=1;case 1:n.trys.push([1,6,7,8]),a=t.split("\n")[Symbol.iterator](),n.label=2;case 2:return(e=(s=a.next()).done)?[3,5]:(o=s.value,(u=o.trim()).length&&"#"!==u[0]?[4,u]:[3,4]);case 3:n.sent(),n.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return l=n.sent(),i=!0,r=l,[3,8];case 7:try{e||null==a.return||a.return()}finally{if(i)throw r}return[7];case 8:return[2]}}))}var a={"Adafruit_NeoPixel.h":"Adafruit NeoPixel","Adafruit_GFX.h":"Adafruit GFX Library","DHT.h":"DHT sensor library","DHT_U.h":"DHT sensor library","FastLED.h":"FastLED","Key.h":"Keypad","Keypad.h":"Keypad","LiquidCrystal.h":"LiquidCrystal","LiquidCrystal_I2C.h":"LiquidCrystal I2C","MD_Parola.h":"MD_Parola","RTClib.h":"RTClib","SD.h":"SD","Servo.h":"Servo","SevSeg.h":"SevSeg","U8glib.h":"U8glib"}},64295:function(t,e,i){i.d(e,{A_:function(){return s},PC:function(){return n},Q5:function(){return a},Vk:function(){return o},hH:function(){return u},ss:function(){return r}});var n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:"analog",channel:t}},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"i2c",signal:t,bus:e}},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"spi",signal:t,bus:e}},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{type:"usart",signal:t,bus:e}},o={type:"power",signal:"GND"},u=function(t){return{type:"power",signal:"VCC",voltage:t}}},96387:function(t,e,i){i.d(e,{Q:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(29815),o=function(){function t(){(0,n.Z)(this,t),(0,a.Z)(this,"fifo",[]),(0,a.Z)(this,"fifoIndex",0)}return(0,r.Z)(t,[{key:"peek",value:function(){return this.fifoIndex<this.fifo.length?this.fifo[this.fifoIndex]:null}},{key:"available",get:function(){return this.fifo.length-this.fifoIndex}},{key:"next",value:function(){if(this.fifoIndex<this.fifo.length){var t=this.fifo[this.fifoIndex++];return this.fifoIndex>=256&&(this.fifo.splice(0,256),this.fifoIndex-=256),t}return null}},{key:"write",value:function(t){var e;(e=this.fifo).push.apply(e,(0,s.Z)(t))}},{key:"writeByte",value:function(t){this.fifo.push(t)}}]),t}()},57954:function(t,e,i){function n(t,e){if(null==t)return e;var i=parseFloat(t);return isNaN(i)?e:i}i.d(e,{R:function(){return n}})},11113:function(t,e,i){i.d(e,{Cb:function(){return u},al:function(){return d},bf:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(29815),o=64,u=32,l=["R1","G1","B1","R2","G2","B2"],c=["A","B","C","D","E"],d=function(){function t(e,i){var r=this;(0,n.Z)(this,t),(0,a.Z)(this,"pixels",new Uint32Array(u*o)),(0,a.Z)(this,"input",l.map((function(){return new Uint8Array(o/8)}))),(0,a.Z)(this,"buffer",l.map((function(){return new Uint8Array(o/8)}))),(0,a.Z)(this,"address",0),(0,a.Z)(this,"updated",!1),(0,a.Z)(this,"copy",(function(){r.updated=!0;for(var t=r.buffer,e=r.address*o,i=(u/2+r.address)*o,n=0;n<o;n++){var a=n>>3,s=7&n,l=t[0][a]&1<<s?255:0,c=t[1][a]&1<<s?255:0,d=t[2][a]&1<<s?255:0,h=t[3][a]&1<<s?255:0,v=t[4][a]&1<<s?255:0,f=t[5][a]&1<<s?255:0;r.pixels[e+o-1-n]=l<<16|c<<8|d,r.pixels[i+o-1-n]=h<<16|v<<8|f}}));var s=l.map((function(t){return i.get(t)})),d=c.map((function(t){return i.get(t)})),h=i.get("OE");d.forEach((function(t,e){var i=1<<e;r.address|=t.value?i:0,t.onValueChange((function(t){t?r.address|=i:r.address&=~i,h.value||r.copy()}))}));var v=function(t,e){for(var i=e?1:0,n=0;n<t.length;n++){var r=t[n]<<1|i;i=128&t[n]?1:0,t[n]=r}},f=this.input,p=this.buffer;i.get("CLK").onValueChange((function(t){t&&(v(f[0],s[0].value),v(f[1],s[1].value),v(f[2],s[2].value),v(f[3],s[3].value),v(f[4],s[4].value),v(f[5],s[5].value))})),i.get("OE").onValueChange((function(t){t||r.copy()})),i.get("LAT").onValueChange((function(t){t&&(p[0].set(f[0]),p[1].set(f[1]),p[2].set(f[2]),p[3].set(f[3]),p[4].set(f[4]),p[5].set(f[5]),h.value||r.copy())}))}return(0,r.Z)(t,[{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{pixels:this.pixels}}):null}},{key:"reset",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,r=this.input[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){n.value.fill(0)}}catch(c){e=!0,i=c}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}var a=!0,s=!1,o=void 0;try{for(var u,l=this.buffer[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){u.value.fill(0)}}catch(c){s=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}this.pixels.fill(0)}}]),t}();(0,a.Z)(d,"pinNames",(0,s.Z)(l).concat((0,s.Z)(c),["CLK","LAT","OE","GND"]))},29399:function(t,e,i){i.d(e,{j:function(){return l},s:function(){return n}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(37405);!function(t){t.load="load"}(n||(n={}));var u=Math.round(1e8),l=function(){function t(e,i,n,a){var l=this;(0,r.Z)(this,t),(0,s.Z)(this,"outValue",void 0),(0,s.Z)(this,"bitIndex",void 0),(0,s.Z)(this,"lastChange",void 0),(0,s.Z)(this,"channel",void 0),(0,s.Z)(this,"gain",void 0),(0,s.Z)(this,"nextSampleTime",void 0),(0,s.Z)(this,"sck",void 0),(0,s.Z)(this,"dt",void 0),(0,s.Z)(this,"acquireSample",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"vars",void 0),this.clock=e,this.vars=a,this.outValue=0,this.bitIndex=0,this.lastChange=0,this.channel=0,this.gain=128,this.nextSampleTime=0,this.acquireSample=function(){var t=l.clock;t.cpuNanos<=l.nextSampleTime?l.sck.value||(l.nextSampleTime+=u,t.addEvent(u,l.acquireSample),l.outValue=l.read(),l.bitIndex=0,l.dt.setState(o.J.Low)):l.clock.addEvent(l.clock.cpuNanos-u,l.acquireSample)},this.sck=i.get("SCK"),this.dt=i.get("DT"),this.sck.setState(o.J.PullUp),this.dt.setState(o.J.High),this.sck.onValueChange((function(t){var i=l.lastChange,n=l.bitIndex;if(t){if(n<24){var r=l.outValue&1<<23-n;l.dt.setState(r?o.J.High:o.J.Low)}else l.dt.setState(o.J.High),l.updateGain(),l.nextSampleTime=e.cpuNanos+u;l.bitIndex++}else e.cpuNanos-i>6e4&&(l.nextSampleTime=e.cpuNanos+u,e.addEvent(u,l.acquireSample));l.lastChange=e.cpuNanos}))}return(0,a.Z)(t,[{key:"updateGain",value:function(){switch(this.bitIndex){case 24:this.channel=0,this.gain=128;break;case 25:this.channel=1,this.gain=32;break;default:this.channel=0,this.gain=64}}},{key:"read",value:function(){return 1==this.channel?0:3.28125*this.vars.readFloat(n.load)*this.gain}},{key:"update",value:function(){return null}},{key:"reset",value:function(){this.lastChange=0,this.nextSampleTime=0}}]),t}();(0,s.Z)(l,"pinNames",["GND","DT","SCK","VCC"])},11551:function(t,e,i){i.d(e,{_:function(){return g},g:function(){return h}});var n=i(51438),r=i(95315),a=i(70222),s=i(88409),o=i(52951),u=i(14924),l=i(8371),c=i(42191),d=i(13918);var h,v=-32768,f=32767;!function(t){t.temperature="temperature",t.accelX="accelX",t.accelY="accelY",t.accelZ="accelZ",t.rotationX="rotationX",t.rotationY="rotationY",t.rotationZ="rotationZ"}(h||(h={}));var p=new WeakMap,g=function(){function t(e,i,o,l){var v=this;(0,n.Z)(this,t),(0,u.Z)(this,"registers",void 0),(0,u.Z)(this,"addr",void 0),(0,u.Z)(this,"updated",void 0),(0,u.Z)(this,"ledOn",void 0),(0,a.Z)(this,p,{writable:!0,value:void 0}),(0,u.Z)(this,"clock",void 0),(0,u.Z)(this,"vars",void 0),this.clock=e,this.vars=l,this.registers=new Uint8Array(118),this.addr=0,this.updated=!1,this.ledOn=!1,(0,s.Z)(this,p,!1);var f=i.get("AD0"),g=new d.A({scl:i.get("SCL"),sda:i.get("SDA")});(0,c.u)(g,104,[f]),function(t,e,i){var n=null,r=function(){var r=t.driven&&e.driven&&t.value&&!e.value;n!==r&&i(n=r)};r(),t.onValueChange(r),e.onValueChange(r)}(i.get("VCC"),i.get("GND"),(function(t){v.ledOn=t,v.updated=!0})),this.reset();var y=function(){v.setAcceleration(l.readFloat(h.accelX),l.readFloat(h.accelY),l.readFloat(h.accelZ))},m=function(){v.setRotation(l.readFloat(h.rotationX),l.readFloat(h.rotationY),l.readFloat(h.rotationZ))};l.autorun(y),l.autorun(m),l.autorun((function(){v.setTemperature(l.readFloat(h.temperature))})),g.onConnect=function(){return(0,s.Z)(v,p,!0),!0},g.onReadByte=function(){var t=v.registers[v.addr];return v.addr=(v.addr+1)%118,t},g.onWriteByte=function(t){if((0,r.Z)(v,p))return v.addr=t,(0,s.Z)(v,p,!1),!0;var e=!0,i=!1,n=v.addr;switch(n){case 107:v.registers[107]=127&t;break;case 55:case 56:i=!0;break;default:n>=13&&n<=52||n>=99&&n<=116?(i=!0,e=!0):e=!1}return i&&(v.registers[n]=t),28===n?y():27===n&&m(),v.addr=(v.addr+1)%118,e}}return(0,o.Z)(t,[{key:"setTemperature",value:function(t){var e=Math.round(340*(t-36.53));this.registers[65]=e>>8&255,this.registers[66]=255&e}},{key:"setAcceleration",value:function(t,e,i){var n=[16384,8192,4096,2048][this.registers[28]>>3&3],r=0|(0,l.u)(n*t,v,f),a=0|(0,l.u)(n*e,v,f),s=0|(0,l.u)(n*i,v,f);this.registers[59]=r>>8&255,this.registers[60]=255&r,this.registers[61]=a>>8&255,this.registers[62]=255&a,this.registers[63]=s>>8&255,this.registers[64]=255&s}},{key:"setRotation",value:function(t,e,i){var n=[131,65.5,32.8,16.4][this.registers[27]>>3&3],r=0|(0,l.u)(n*t,v,f),a=0|(0,l.u)(n*e,v,f),s=0|(0,l.u)(n*i,v,f);this.registers[67]=r>>8&255,this.registers[68]=255&r,this.registers[69]=a>>8&255,this.registers[70]=255&a,this.registers[71]=s>>8&255,this.registers[72]=255&s}},{key:"update",value:function(){return this.updated?(this.updated=!1,{value:{ledOn:this.ledOn}}):null}},{key:"reset",value:function(){var t=this.vars;this.registers.fill(0),this.registers[107]=64,this.registers[117]=104,this.addr=0,t.initFloat(h.accelX,0),t.initFloat(h.accelY,0),t.initFloat(h.accelZ,1),t.initFloat(h.rotationX,0),t.initFloat(h.rotationY,0),t.initFloat(h.rotationZ,0),t.initFloat(h.temperature,24)}}]),t}();(0,u.Z)(g,"pinNames",["VCC","GND","SCL","SDA","AD0","INT"])},41812:function(t,e,i){i.d(e,{W:function(){return u},l:function(){return l}});var n=i(51438),r=i(52951),a=i(14924),s=i(37405),o=i(57954),u=500,l=function(){function t(e,i,r){(0,n.Z)(this,t),(0,a.Z)(this,"lux",void 0),(0,a.Z)(this,"gamma",void 0),(0,a.Z)(this,"c",void 0),(0,a.Z)(this,"threshold",void 0),(0,a.Z)(this,"ledOut",!1),(0,a.Z)(this,"updated",!0),(0,a.Z)(this,"analogOut",void 0),(0,a.Z)(this,"digitalOut",void 0),this.digitalOut=i.get("DO"),this.analogOut=i.get("AO"),this.lux=(0,o.R)(r.get("lux"),u),this.gamma=(0,o.R)(r.get("gamma"),.7),this.threshold=(0,o.R)(r.get("threshold"),2.5);var s=(0,o.R)(r.get("rl10"),50);this.c=Math.log10(1e3*s)+this.gamma,this.luxUpdated()}return(0,r.Z)(t,[{key:"onEvent",value:function(t){this.lux=t.lux,this.luxUpdated()}},{key:"luxUpdated",value:function(){var t=this,e=t.gamma,i=t.c,n=t.lux,r=Math.pow(10,i)/Math.pow(Math.max(n,.001),e),a=r/(1e4+r)*5;this.analogOut.node.analogPort.write(a);var o=a>this.threshold;this.digitalOut.setState(o?s.J.High:s.J.Low),this.ledOut!==!o&&(this.ledOut=!o,this.updated=!0)}},{key:"update",value:function(){return this.updated?{value:{ledOn:!0,ledDigitalOut:this.ledOut}}:null}},{key:"reset",value:function(){}}]),t}();(0,a.Z)(l,"pinNames",["VCC","GND","DO","AO"])},98004:function(t,e,i){i.d(e,{v:function(){return C},O:function(){return b}});var n,r,a=i(51438),s=i(52951),o=i(14924),u=i(82670),l=i(56498),c=i(76136),d=i(13918),h=i(13291),v=i(35154),f=i(80450),p=i(28467),g=function(){function t(e,i,n){(0,a.Z)(this,t),(0,o.Z)(this,"vars",void 0),(0,o.Z)(this,"name",void 0),(0,o.Z)(this,"defaultValue",void 0),this.vars=e,this.name=i,this.defaultValue=n}return(0,s.Z)(t,[{key:"readFloat",value:function(){var t;return null!==(t=this.vars.readFloat(this.name))&&void 0!==t?t:this.defaultValue}}]),t}(),y=i(36221),m=i(37405);!function(t){t[t.INPUT=0]="INPUT",t[t.OUTPUT=1]="OUTPUT",t[t.INPUT_PULLUP=2]="INPUT_PULLUP",t[t.INPUT_PULLDOWN=3]="INPUT_PULLDOWN",t[t.ANALOG=4]="ANALOG",t[t.OUTPUT_LOW=16]="OUTPUT_LOW",t[t.OUTPUT_HIGH=17]="OUTPUT_HIGH"}(n||(n={})),function(t){t[t.NONE=0]="NONE",t[t.RISING=1]="RISING",t[t.FALLING=2]="FALLING",t[t.BOTH=3]="BOTH"}(r||(r={}));var w=function(){function t(e,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.INPUT,u=this;(0,a.Z)(this,t),(0,o.Z)(this,"_mode",void 0),(0,o.Z)(this,"_value",void 0),(0,o.Z)(this,"_edge",void 0),(0,o.Z)(this,"_dacValue",void 0),(0,o.Z)(this,"callback",void 0),(0,o.Z)(this,"listener",void 0),(0,o.Z)(this,"name",void 0),(0,o.Z)(this,"pin",void 0),this.name=e,this.pin=i,this._mode=n.INPUT,this._value=!1,this._edge=0,this._dacValue=NaN,this.callback=function(){},this.listener=function(t){(t&&u._edge&r.RISING||!t&&u._edge&r.FALLING)&&u.callback(t?1:0)},this.mode=s}return(0,s.Z)(t,[{key:"mode",get:function(){return this._mode},set:function(t){t!==n.OUTPUT_HIGH&&t!==n.OUTPUT_LOW||(this._value=t===n.OUTPUT_HIGH,t=n.OUTPUT),t!==n.ANALOG||isNaN(this._dacValue)||this.pin.node.analogPort.write(this._dacValue),this._mode=t,this.pin.state=this.outputState}},{key:"analogMode",get:function(){return this.mode===n.ANALOG}},{key:"value",get:function(){return this._value},set:function(t){this._value=t,this.pin.state=this.outputState}},{key:"edge",get:function(){return this._edge},set:function(t){t&&this.pin.onValueChange(this.listener),this._edge=t}},{key:"dacWrite",value:function(t){this._dacValue=t,this.analogMode&&this.pin.node.analogPort.write(this._dacValue)}},{key:"outputState",get:function(){switch(this._mode){case n.INPUT:return m.J.HighZ;case n.INPUT_PULLUP:return m.J.PullUp;case n.INPUT_PULLDOWN:return m.J.PullDown;default:return this._value?m.J.High:m.J.Low}}}]),t}(),k=function(){function t(e,i,n){var r=this;(0,a.Z)(this,t),(0,o.Z)(this,"bufferPtr",void 0),(0,o.Z)(this,"bufferLen",void 0),(0,o.Z)(this,"bufferIndex",void 0),(0,o.Z)(this,"memory",void 0),(0,o.Z)(this,"spi",void 0),(0,o.Z)(this,"spiConfig",void 0),this.memory=e,this.spi=i,this.spiConfig=n,this.bufferPtr=0,this.bufferLen=0,this.bufferIndex=0,i.onTransmit=function(t){return r.next(t)}}return(0,s.Z)(t,[{key:"start",value:function(t,e){this.bufferPtr=t,this.bufferLen=e,this.bufferIndex=0,this.spi.sendByte(new Uint8Array(this.memory.buffer)[t]),this.spi.paused?this.spi.paused=!1:this.spi.enable()}},{key:"stop",value:function(){this.spi.disable(),this.spiConfig.doneCallback(this.spiConfig.userData,this.bufferPtr,this.bufferIndex)}},{key:"next",value:function(t){var e=this.bufferPtr,i=new Uint8Array(this.memory.buffer);i[e+this.bufferIndex]=t,this.bufferIndex++,this.bufferIndex===this.bufferLen?(this.spi.paused=!0,this.spiConfig.doneCallback(this.spiConfig.userData,this.bufferPtr,this.bufferIndex)):this.spi.sendByte(i[e+this.bufferIndex])}}]),t}(),Z=!1;function b(){Z=!0}var C=function(){function t(e,i,n){var r,s,u,l;(0,a.Z)(this,t),(0,o.Z)(this,"clock",void 0),(0,o.Z)(this,"instance",void 0),(0,o.Z)(this,"pins",void 0),(0,o.Z)(this,"attrs",void 0),(0,o.Z)(this,"vars",void 0),(0,o.Z)(this,"buffer",void 0),(0,o.Z)(this,"attrList",void 0),(0,o.Z)(this,"stringList",void 0),(0,o.Z)(this,"pinList",void 0),(0,o.Z)(this,"timers",void 0),(0,o.Z)(this,"timerRepeat",void 0),(0,o.Z)(this,"uartDevices",void 0),(0,o.Z)(this,"spiDevices",void 0),(0,o.Z)(this,"buffers",void 0),(0,o.Z)(this,"framebufferWidth",void 0),(0,o.Z)(this,"framebufferHeight",void 0),(0,o.Z)(this,"name",void 0),(0,o.Z)(this,"memory",void 0),this.name=e,this.memory=i,this.attrs=new Map,this.buffer=new y.l(new Uint8Array(0)),this.attrList=[],this.stringList=[""],this.pinList=[],this.timers=[],this.timerRepeat=[],this.uartDevices=[],this.spiDevices=[],this.buffers=[],this.framebufferWidth=Math.floor(null!==(u=null===(r=n.display)||void 0===r?void 0:r.width)&&void 0!==u?u:0),this.framebufferHeight=Math.floor(null!==(l=null===(s=n.display)||void 0===s?void 0:s.height)&&void 0!==l?l:0)}return(0,s.Z)(t,[{key:"callbackPtr",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0},r=this.instance,a=null!==(e=null===r||void 0===r?void 0:r.exports.__indirect_function_table)&&void 0!==e?e:null===r||void 0===r?void 0:r.exports.table;return t&&(0,u.Z)(a,WebAssembly.Table)&&null!==(i=a.get(t))&&void 0!==i?i:n}},{key:"traceLog",value:function(t,e,i){console.log("[".concat(this.name,"] ").concat(t,"(").concat(e.join(", "),")").concat(i?" -> ".concat(i):""))}},{key:"traceEvent",value:function(t,e){console.log("[".concat(this.name,"] event ").concat(t,"(").concat(e.join(", "),")"))}},{key:"i2cInit",value:function(t){var e=new p.B(new Uint8Array(this.memory().buffer,t)),i=e.readUint32(),n=e.readUint32(),r=e.readUint32(),a=e.readUint32(),s=this.callbackPtr(e.readUint32(),(function(){return 0})),o=this.callbackPtr(e.readUint32(),(function(){return 0})),u=this.callbackPtr(e.readUint32()),l=this.callbackPtr(e.readUint32()),c=new d.A({scl:this.pinList[r].pin,sda:this.pinList[a].pin},n);c.onConnect=function(t,e){return s(i,t,!e)},c.onReadByte=function(){return o(i)},c.onWriteByte=function(t){return u(i,t)},c.onDisconnect=function(){return l(i)}}},{key:"uartInit",value:function(t){var e=new p.B(new Uint8Array(this.memory().buffer,t)),i=e.readUint32(),n=e.readUint32(),r=e.readUint32(),a=e.readUint32(),s=this.callbackPtr(e.readUint32(),(function(){return 0})),o=this.callbackPtr(e.readUint32(),(function(){return 0}));if(this.clock){var u={};if(n>=0)new v.g(this.clock,this.pinList[n].pin,a).subscribe((function(t){var e=!0,n=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var u=a.value;s(i,u)}}catch(l){n=!0,r=l}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}));return r>=0&&(u.encoder=new f.x(this.clock,this.pinList[r].pin,a),u.encoder.onTxComplete=function(){o(i)}),this.uartDevices.push(u),this.uartDevices.length-1}console.warn("uartInit() called at invalid time")}},{key:"uartWrite",value:function(t,e,i){var n=this.uartDevices[t];if(!n||!n.encoder)return console.warn("uart_write_buf() called with invalid uart_dev_t pointer: 0x".concat((0,l.MS)(t))),!1;if(i<1)return console.warn("uart_write_buf() called with invalid buffer size"),!1;if(n.encoder.isBusy)return!1;var r=new Uint8Array(this.memory().buffer).slice(e,e+i);return n.encoder.write(r),!0}},{key:"spiInit",value:function(t){var e=new p.B(new Uint8Array(this.memory().buffer,t)),i={userData:e.readUint32(),sck:e.readInt32(),mosi:e.readInt32(),miso:e.readInt32(),mode:e.readUint32(),doneCallback:this.callbackPtr(e.readUint32(),(function(){return 0}))},n=this.spiDevices,r=i.sck,a=i.mosi,s=i.miso,o=i.mode,u=new h.g({clk:this.pinList[r].pin,mosi:a>=0?this.pinList[a].pin:void 0,miso:s>=0?this.pinList[s].pin:void 0},0===o||1===o||2===o||3===o?o:0),l=n.length;return n.push(new k(this.memory(),u,i)),l}},{key:"spiStart",value:function(t,e,i){return t<0||t>=this.spiDevices.length?(console.warn("spi_start() called with invalid SPI interface: ".concat(t)),-1):(this.spiDevices[t].start(e,i),0)}},{key:"spiStop",value:function(t){return t<0||t>=this.spiDevices.length?(console.warn("spi_stop() called with invalid SPI interface: ".concat(t)),-1):(this.spiDevices[t].stop(),0)}},{key:"pinInit",value:function(t,e){var i,r,a=this.pinList,s=(0,c.V)(this.memory(),t,256),o=null===(i=this.pins)||void 0===i?void 0:i.get(s);Z&&this.traceLog("pin_init",[s,null!==(r=n[e])&&void 0!==r?r:e.toString()]);return o?(a.push(new w(s,o,e)),a.length-1):-1}},{key:"pinMode",value:function(t,e){if(t<0||t>=this.pinList.length)console.warn("pin_mode() called with invalid pin: ".concat(t));else{var i,r=this.pinList[t];if(Z)this.traceLog("pin_mode",[r.name,null!==(i=n[e])&&void 0!==i?i:e.toString()]);r.mode=e}}},{key:"pinRead",value:function(t){if(t<0||t>=this.pinList.length)return console.warn("pin_read() called with invalid pin: ".concat(t)),0;var e=this.pinList[t];return Z&&this.traceLog("pin_read",[e.name],e.pin.value?"1":"0"),e.pin.value?1:0}},{key:"pinWrite",value:function(t,e){if(t<0||t>=this.pinList.length)console.warn("pin_write() called with invalid pin: ".concat(t));else{var i=this.pinList[t];Z&&this.traceLog("pin_write",[i.name,e?"1":"0"]),i.value=0!==e}}},{key:"pinWatch",value:function(t,e){var i=this,n=new p.B(new Uint8Array(this.memory().buffer,e)),a={userData:n.readUint32(),edge:n.readUint32(),pinChange:this.callbackPtr(n.readUint32(),(function(){return 0}))};if(!(t<0||t>=this.pinList.length)){var s,o=this.pinList[t];if(Z)this.traceLog("pin_watch",[o.name,null!==(s=r[a.edge])&&void 0!==s?s:a.edge.toString()],o.edge?"false":"true");return!o.edge&&(o.edge=a.edge,o.callback=function(e){Z&&i.traceEvent("pin_chage",[o.name,e?"1":"0"]),a.pinChange(a.userData,t,e)},!0)}console.warn("pin_watch() called with invalid pin: ".concat(t))}},{key:"pinWatchStop",value:function(t){if(t<0||t>=this.pinList.length)console.warn("pin_watch() called with invalid pin: ".concat(t));else{var e=this.pinList[t];Z&&this.traceLog("pin_watch_stop",[e.name]),e.edge=0}}},{key:"pinADCRead",value:function(t){if(t<0||t>=this.pinList.length)return console.warn("pin_adc_read() called with invalid pin: ".concat(t)),NaN;var e=this.pinList[t];if(!e.analogMode)return console.warn("pin_adc_read() called for pin ".concat(t,", which is not in ANALOG mode. Returning NaN.")),NaN;var i=e.pin.node.analogPort.read();return Z&&this.traceLog("pin_adc_read",[e.name],i.toString()),i}},{key:"pinDACWrite",value:function(t,e){if(!(t<0||t>=this.pinList.length)){var i=this.pinList[t];return Z&&this.traceLog("pin_dac_write",[i.name,e.toString()]),this.pinList[t].dacWrite(e)}console.warn("pin_dac_write() called with invalid pin: ".concat(t))}},{key:"attrInit",value:function(t,e){var i=this.attrList,n=(0,c.V)(this.memory(),t,256),r=this.attrs.get(n),a=r?parseFloat(r):e;return this.vars?(this.vars.initFloat(n,isNaN(a)?e:a),i.push(new g(this.vars,n,e)),i.length-1):-1}},{key:"attrRead",value:function(t){var e=this.attrList;return t<e.length?e[t].readFloat():(console.warn("attr_read() called with invalid value: ".concat(t)),0)}},{key:"attrStringInit",value:function(t){var e=(0,c.V)(this.memory(),t,256),i=this.attrs.get(e);return i?(this.stringList.push(i),this.stringList.length-1):0}},{key:"attrInitFloat",value:function(t,e){return this.attrInit(t,e)}},{key:"attrReadFloat",value:function(t){return this.attrRead(t)}},{key:"stringGetLength",value:function(t){return t<this.stringList.length?this.stringList[t].length:(console.warn("string_get_length() called with invalid value: ".concat(t)),0)}},{key:"stringRead",value:function(t,e,i){if(t<this.stringList.length){var n=this.stringList[t],r=(new TextEncoder).encode(n),a=new Uint8Array(this.memory().buffer,e,i);return a.set(r.subarray(0,i-1)),a[Math.min(r.length,i-1)]=0,r.length}return console.warn("string_read() called with invalid value: ".concat(t)),0}},{key:"getSimNanos",value:function(){var t,e;return null!==(e=null===(t=this.clock)||void 0===t?void 0:t.cpuNanos)&&void 0!==e?e:0}},{key:"timerInit",value:function(t){var e,i=this,n=new p.B(new Uint8Array(this.memory().buffer,t)),r={userData:n.readUint32(),callback:this.callbackPtr(n.readUint32(),(function(){return 0}))},a=this.timers.length,s=null===(e=this.clock)||void 0===e?void 0:e.createEvent((function(){r.callback(r.userData);var t=i.timerRepeat[a];t&&(null===s||void 0===s||s.schedule(t))}));return s?(this.timers.push(s),this.timerRepeat.push(0),a):-1}},{key:"timerStart",value:function(t,e,i){this.timerStartNanos(t,1e3*e,i)}},{key:"timerStartNanos",value:function(t,e,i){var n;null===(n=this.timers[t])||void 0===n||n.schedule(e),this.timerRepeat[t]=i?e:0}},{key:"timerStop",value:function(t){var e;null===(e=this.timers[t])||void 0===e||e.unschedule()}},{key:"framebufferInit",value:function(t,e){var i=this.framebufferWidth,n=this.framebufferHeight,r=new DataView(this.memory().buffer);r.setUint32(t,i,!0),r.setUint32(e,n,!0);var a=this.buffers.indexOf(this.buffer);return a>=0?a:(this.buffers.push(this.buffer),this.buffers.length-1)}},{key:"bufferRead",value:function(t,e,i,n){var r=this.buffers[t].data;r?e+n>r.length||e<0||n<1?console.warn("buffer_read() out of bounds: offset=".concat(e,", data_len=").concat(n,", size=").concat(r.length)):new Uint8Array(this.memory().buffer).set(r.slice(e,e+n),i):console.warn("buffer_read() called with invalid buffer: ".concat(t))}},{key:"bufferWrite",value:function(t,e,i,n){var r=this.buffers[t];r?e+n>r.data.length||e<0||n<1?console.warn("buffer_write() out of bounds: offset=".concat(e,", data_len=").concat(n,", buffer_size=").concat(r.data.length)):(r.data.set(new Uint8Array(this.memory().buffer,i,n),e),r.dirty=!0):console.warn("buffer_write called with invalid buffer: ".concat(t))}}]),t}()},36221:function(t,e,i){i.d(e,{l:function(){return a}});var n=i(51438),r=i(14924),a=function t(e){(0,n.Z)(this,t),(0,r.Z)(this,"dirty",void 0),(0,r.Z)(this,"data",void 0),this.data=e,this.dirty=!1}},67044:function(t,e,i){i.d(e,{V:function(){return a},z:function(){return o}});var n=i(47568),r=i(20414);function a(t){return s.apply(this,arguments)}function s(){return(s=(0,n.Z)((function(t){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:switch(t){case"fat":return[3,1];case"lfs":return[3,3]}return[3,5];case 1:return[4,Promise.all([i.e(4102),i.e(9829)]).then(i.bind(i,59829))];case 2:case 4:return e.sent(),[3,5];case 3:return[4,Promise.all([i.e(6137),i.e(4669)]).then(i.bind(i,54669))];case 5:return[2]}}))}))).apply(this,arguments)}function o(t,e,i){return u.apply(this,arguments)}function u(){return(u=(0,n.Z)((function(t,e,n){var a,s,o,u,l,c,d,h,v,f,p,g;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:switch(a=e.type,s=e.flashOffset,o=e.blockSize,u=e.numBlocks,l=e.mkdirs,a){case"fat":return[3,1];case"lfs":return[3,4]}return[3,7];case 1:return[4,Promise.all([i.e(4102),i.e(9829)]).then(i.bind(i,59829))];case 2:return[4,(0,r.sent().makeFatFS)({flash:t.subarray(s),blockSize:o,numBlocks:u,noPartitionTable:!0,mkdirs:l},n)];case 3:case 6:return r.sent(),[3,7];case 4:return[4,Promise.all([i.e(6137),i.e(4669)]).then(i.bind(i,54669))];case 5:return[4,(0,r.sent().makeLittlefs)({flash:t.subarray(s),blockSize:o,numBlocks:u,mkdirs:l},n)];case 7:d=!0,h=!1,v=void 0;try{for(f=(null!==(c=e.overlays)&&void 0!==c?c:[])[Symbol.iterator]();!(d=(p=f.next()).done);d=!0)g=p.value,t.set(g.data,g.offset)}catch(y){h=!0,v=y}finally{try{d||null==f.return||f.return()}finally{if(h)throw v}}return[2]}}))}))).apply(this,arguments)}},26017:function(t,e,i){i.d(e,{$_:function(){return r},H_:function(){return s},KC:function(){return u},NC:function(){return o},Nc:function(){return l},ZY:function(){return n},nX:function(){return c}});var n=u("S02"),r=u("S05");function a(t){return(t>>4).toString(16)+(15&t).toString(16)}function s(t){for(var e=new Uint8Array(t.length/2),i=0;i<e.length;i++)e[i]=parseInt(t.substr(2*i,2),16);return e}function o(t){return Array.from(t).map(a).join("")}function u(t){return"+$".concat(t,"#").concat(a(255&t.split("").map((function(t){return t.charCodeAt(0)})).reduce((function(t,e){return t+e}),0)))}function l(t){return o((new TextEncoder).encode(t))}function c(t){return(new TextDecoder).decode(s(t))}},14116:function(t,e,i){var n;i.d(e,{q:function(){return n}}),function(t){t[t.BRG=0]="BRG",t[t.RGBA=1]="RGBA"}(n||(n={}))},53124:function(t,e,i){i.d(e,{i:function(){return a},x:function(){return s}});var n=i(10253),r=i(20414);function a(t,e){var i=!0,r=!1,a=void 0;try{for(var o,u=s(t)[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=(0,n.Z)(o.value,2),c=l[0],d=l[1];e[c]=d}}catch(h){r=!0,a=h}finally{try{i||null==u.return||u.return()}finally{if(r)throw a}}}function s(t){var e,i,n,a,s,o,u,l,c,d,h,v;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:e=0,i=!0,n=!1,a=void 0,r.label=1;case 1:r.trys.push([1,9,10,11]),s=t.split("\n")[Symbol.iterator](),r.label=2;case 2:if(i=(o=s.next()).done)return[3,8];if(u=o.value,l=u.substr(7,2),":"!==u[0]||"00"!==l)return[3,6];c=parseInt(u.substr(1,2),16),d=parseInt(u.substr(3,4),16),h=0,r.label=3;case 3:return h<c?[4,[e+d+h,parseInt(u.substr(9+2*h,2),16)]]:[3,6];case 4:r.sent(),r.label=5;case 5:return h++,[3,3];case 6:":"===u[0]&&"02"===l&&(e=parseInt(u.substr(9,4),16)<<4),":"===u[0]&&"04"===l&&(e=parseInt(u.substr(9,4),16)<<16),r.label=7;case 7:return i=!0,[3,2];case 8:return[3,11];case 9:return v=r.sent(),n=!0,a=v,[3,11];case 10:try{i||null==s.return||s.return()}finally{if(n)throw a}return[7];case 11:return[2]}}))}},49006:function(t,e,i){i.d(e,{E:function(){return s}});var n=i(51438),r=i(52951),a=i(14924),s=function(){function t(e,i){(0,n.Z)(this,t),(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"state",void 0),this.name=e,this.state=i}return(0,r.Z)(t,[{key:"attach",value:function(t){t.state=this.state}},{key:"outputEnable",get:function(){return!0}}]),t}()},99569:function(t,e,i){i.d(e,{Y:function(){return d}});var n=i(51438),r=i(52951),a=i(14924),s=i(29815),o=Symbol.iterator,u=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"set",void 0),(0,a.Z)(this,"unionSet",null),this.set=new Set(e)}return(0,r.Z)(t,[{key:o,value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set)[Symbol.iterator]()}},{key:"unionWith",value:function(t){if(this.unionSet=t,t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.set[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;t.add(s)}}catch(o){i=!0,n=o}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}},{key:"size",get:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).size}},{key:"add",value:function(t){var e;this.set.add(t),null===(e=this.unionSet)||void 0===e||e.add(t)}},{key:"delete",value:function(t){var e;this.set.delete(t),null===(e=this.unionSet)||void 0===e||e.delete(t)}},{key:"has",value:function(t){var e;return(null!==(e=this.unionSet)&&void 0!==e?e:this.set).has(t)}},{key:"forEach",value:function(t){var e;(null!==(e=this.unionSet)&&void 0!==e?e:this.set).forEach(t)}},{key:"entries",value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).entries()}},{key:"keys",value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).keys()}},{key:"values",value:function(){var t;return(null!==(t=this.unionSet)&&void 0!==t?t:this.set).values()}},{key:"ownPins",get:function(){return this.set}}]),t}(),l=i(37405),c=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"high",void 0),(0,a.Z)(this,"voltage",void 0),(0,a.Z)(this,"hasVoltage",void 0),(0,a.Z)(this,"listeners",void 0),(0,a.Z)(this,"node",void 0),this.node=e,this.high=5,this.voltage=Math.random()*this.high,this.hasVoltage=!1,this.listeners=new Set}return(0,r.Z)(t,[{key:"read",value:function(){if(this.hasVoltage)return this.voltage;switch(this.node.state){case l.J.High:case l.J.PullUp:return this.voltage=5,this.high;case l.J.PullDown:case l.J.Low:return this.voltage=0,0;default:return this.voltage=.9*this.voltage+Math.random()*this.high*.1,this.voltage}}},{key:"readNormalized",value:function(){return this.read()/this.high}},{key:"write",value:function(t){if(!this.hasVoltage||t!==this.voltage){this.voltage=t,this.hasVoltage=!0;var e=t/this.high,i=!0,n=!1,r=void 0;try{for(var a,s=this.listeners[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){(0,a.value)(t,e)}}catch(o){n=!0,r=o}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}}},{key:"writeNormalized",value:function(t){this.write(t*this.high)}},{key:"addListener",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}}]),t}(),d=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"analogPort",void 0),(0,a.Z)(this,"listeners",void 0),(0,a.Z)(this,"stateListeners",void 0),(0,a.Z)(this,"pinSet",void 0),(0,a.Z)(this,"bridges",void 0),(0,a.Z)(this,"bridgedNodes",void 0),(0,a.Z)(this,"digitalValue",void 0),(0,a.Z)(this,"currentState",void 0),(0,a.Z)(this,"valueChangedNanos",void 0),(0,a.Z)(this,"_drivingPin",void 0),(0,a.Z)(this,"clock",void 0),this.clock=e,this.analogPort=new c(this),this.listeners=new Set,this.stateListeners=new Set,this.pinSet=new u,this.bridges=new Set,this.bridgedNodes=new Set([this]),this.digitalValue=!1,this.currentState=l.J.HighZ,this.valueChangedNanos=this.clock.cpuNanos,this._drivingPin=null}return(0,r.Z)(t,[{key:"value",get:function(){return this.digitalValue}},{key:"state",get:function(){return this.currentState}},{key:"pins",get:function(){return this.pinSet}},{key:"attachPin",value:function(t){this.pinSet.add(t)}},{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}},{key:"subscribeState",value:function(t){var e=this;return this.stateListeners.add(t),function(){return e.stateListeners.delete(t)}}},{key:"resolve",value:function(){var t,e,i=null,n=null,r=null,a=null,s=!0,o=!1,u=void 0;try{for(var c,d=this.pins[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var h=c.value;switch(h.internalState){case l.J.Low:n=h;break;case l.J.High:i=h;break;case l.J.PullUp:r=h;break;case l.J.PullDown:a=h}}}catch(U){o=!0,u=U}finally{try{s||null==d.return||d.return()}finally{if(o)throw u}}n&&i&&console.warn('Short circuit! pins: "'.concat(n.name,'" and "').concat(i.name,'"'));var v=null;i?(t=!0,e=l.J.High,v=i):n?(t=!1,e=l.J.Low,v=n):r?(t=!0,e=l.J.PullUp,v=r):a?(t=!1,e=l.J.PullDown,v=a):(t=Math.random()>.5,e=l.J.HighZ,v=null);var f=!0,p=!1,g=void 0;try{for(var y,m=this.bridgedNodes[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var w=y.value,k=w.digitalValue,Z=w.currentState;if(w.digitalValue=t,w.currentState=e,w._drivingPin=v,Z!==e){var b=!0,C=!1,_=void 0;try{for(var S,x=w.stateListeners[Symbol.iterator]();!(b=(S=x.next()).done);b=!0){(0,S.value)()}}catch(U){C=!0,_=U}finally{try{b||null==x.return||x.return()}finally{if(C)throw _}}}if(k!==w.digitalValue){var P=w.digitalValue,I=w.clock.cpuNanos,D=I-w.valueChangedNanos;w.valueChangedNanos=I;var A=!0,R=!1,B=void 0;try{for(var T,E=w.listeners[Symbol.iterator]();!(A=(T=E.next()).done);A=!0){(0,T.value)(P,{nanos:D})}}catch(U){R=!0,B=U}finally{try{A||null==E.return||E.return()}finally{if(R)throw B}}}}}catch(U){p=!0,g=U}finally{try{f||null==m.return||m.return()}finally{if(p)throw g}}}},{key:"drivingPin",get:function(){return this._drivingPin}},{key:"updateBridges",value:function(){for(var t=new Set([this]),e=new Set,i=Array.from(this.bridges);i.length;){var n,r=i.pop();if(r&&!e.has(r))e.add(r),t.add(r.node),(n=i).push.apply(n,(0,s.Z)(r.node.bridges))}if(t.size<2)this.pinSet.unionWith(null),this.bridgedNodes=new Set([this]);else{var a=new Set(this.pinSet.ownPins),o=!0,u=!1,l=void 0;try{for(var c,d=t[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var h=c.value;h.pinSet.unionWith(a),h.bridgedNodes=t}}catch(v){u=!0,l=v}finally{try{o||null==d.return||d.return()}finally{if(u)throw l}}}this.resolve()}}]),t}()},37405:function(t,e,i){i.d(e,{J:function(){return n},U:function(){return o}});var n,r=i(51438),a=i(52951),s=i(14924);!function(t){t[t.Low=0]="Low",t[t.High=1]="High",t[t.HighZ=2]="HighZ",t[t.PullUp=3]="PullUp",t[t.PullDown=4]="PullDown"}(n||(n={}));var o=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"currentState",void 0),(0,s.Z)(this,"protocols",void 0),(0,s.Z)(this,"node",void 0),(0,s.Z)(this,"name",void 0),this.node=e,this.name=i,this.currentState=n.HighZ,this.protocols={},e.attachPin(this)}return(0,a.Z)(t,[{key:"value",get:function(){return this.node.value}},{key:"driven",get:function(){return this.node.state!==n.HighZ}},{key:"onStateChange",value:function(t){return this.node.subscribeState(t)}},{key:"onValueChange",value:function(t){return this.node.subscribe(t)}},{key:"state",get:function(){return this.node.state},set:function(t){t!==this.currentState&&(this.currentState=t,this.node.resolve())}},{key:"internalState",get:function(){return this.currentState}},{key:"setState",value:function(t){this.state=t}}]),t}()},42191:function(t,e,i){function n(t,e,i){var n=function(){var t=e,n=0,r=!0,a=!1,s=void 0;try{for(var o,u=i[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){t|=o.value.value?1<<n:0,n++}}catch(l){a=!0,s=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}return t};t.addressFilter=n();var r=!0,a=!1,s=void 0;try{for(var o,u=i[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){o.value.onValueChange((function(){t.addressFilter=n()}))}}catch(l){a=!0,s=l}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}i.d(e,{u:function(){return n}})},3776:function(t,e,i){i.d(e,{n:function(){return c}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(29815),u=i(37405);function l(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=function(t){var i=e.shift();i&&i(n,t)};n(void 0)}!function(t){t[t.Idle=0]="Idle",t[t.Start=1]="Start",t[t.Write=2]="Write",t[t.Read=3]="Read"}(n||(n={}));var c=function(){function t(e,i){(0,r.Z)(this,t),(0,s.Z)(this,"frequency",void 0),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"busy",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"pins",void 0),this.clock=e,this.pins=i,this.frequency=1e5,this.state=n.Idle,this.busy=!1}return(0,a.Z)(t,[{key:"enable",value:function(){var t=this.pins,e=t.scl,i=t.sda;e.setState(u.J.PullUp),i.setState(u.J.PullUp)}},{key:"disable",value:function(){var t=this.pins,e=t.scl,i=t.sda;e.setState(u.J.HighZ),i.setState(u.J.HighZ)}},{key:"tick",value:function(t){var e=Math.floor(1e9/this.frequency/2);this.clock.addEvent(e,t)}},{key:"clockHigh",value:function(t){var e=this.pins.scl;if(e.value)t();else var i=e.onValueChange((function(){i(),t()}))}},{key:"start",value:function(t){var e=this,i=this.pins,r=i.sda,a=i.scl,s=[];this.state!==n.Idle&&s.push((function(t){r.setState(u.J.PullUp),e.tick(t)}),(function(t){a.setState(u.J.PullUp),e.clockHigh(t)}),(function(t){e.tick(t)})),l.apply(void 0,(0,o.Z)(s).concat([function(i){if(!r.value)return e.state=n.Idle,void t(!1);e.state=n.Start,r.setState(u.J.Low),e.tick(i)},function(){a.setState(u.J.Low),t(!0)}]))}},{key:"stop",value:function(t){var e=this,i=this.pins,r=i.sda,a=i.scl;l((function(t){r.setState(u.J.Low),e.tick(t)}),(function(t){a.setState(u.J.PullUp),e.clockHigh(t)}),(function(t){e.tick(t)}),(function(t){r.setState(u.J.PullUp),e.tick(t)}),(function(){e.state=n.Idle,r.value?t(!0):t(!1)}))}},{key:"connect",value:function(t,e,i){var r=this,a=t<<1|(e?0:1);this.write(a,(function(t){r.state=t?e?n.Write:n.Read:n.Idle,i(t)}))}},{key:"read",value:function(t,e){var i=this,n=0;l((function(t){return i.readBit(t)}),(function(t,e){n|=e?128:0,i.readBit(t)}),(function(t,e){n|=e?64:0,i.readBit(t)}),(function(t,e){n|=e?32:0,i.readBit(t)}),(function(t,e){n|=e?16:0,i.readBit(t)}),(function(t,e){n|=e?8:0,i.readBit(t)}),(function(t,e){n|=e?4:0,i.readBit(t)}),(function(t,e){n|=e?2:0,i.readBit(t)}),(function(e,r){n|=r?1:0,i.writeBit(!t,e)}),(function(){return e(n)}))}},{key:"write",value:function(t,e){var i=this;l((function(e){return i.writeBit(!!(128&t),e)}),(function(n,r){return r?i.writeBit(!!(64&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(32&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(16&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(8&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(4&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(2&t),n):e(!1)}),(function(n,r){return r?i.writeBit(!!(1&t),n):e(!1)}),(function(t,n){n?i.readBit((function(t){return e(!t)})):e(!1)}))}},{key:"writeBit",value:function(t,e){var i=this,r=this.pins,a=r.scl,s=r.sda;l((function(e){s.setState(t?u.J.PullUp:u.J.Low),i.tick(e)}),(function(t){a.setState(u.J.PullUp),i.tick(t)}),(function(t){i.clockHigh(t)}),(function(){var r=s.value;a.setState(u.J.Low),r!==t?(i.state=n.Idle,e(!1)):e(!0)}))}},{key:"readBit",value:function(t){var e=this,i=this.pins,n=i.scl,r=i.sda;l((function(t){r.setState(u.J.PullUp),e.tick(t)}),(function(t){n.setState(u.J.PullUp),e.clockHigh(t)}),(function(t){e.tick(t)}),(function(){var e=r.value;n.setState(u.J.Low),t(e)}))}}]),t}()},13918:function(t,e,i){i.d(e,{A:function(){return u}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(37405);!function(t){t[t.Idle=0]="Idle",t[t.Start=1]="Start",t[t.Stop=2]="Stop",t[t.Read=3]="Read",t[t.Write=4]="Write"}(n||(n={}));var u=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this;(0,r.Z)(this,t),(0,s.Z)(this,"outgoingByte",void 0),(0,s.Z)(this,"incomingByte",void 0),(0,s.Z)(this,"clockIndex",void 0),(0,s.Z)(this,"ack",void 0),(0,s.Z)(this,"firstByte",void 0),(0,s.Z)(this,"state",void 0),(0,s.Z)(this,"onStart",void 0),(0,s.Z)(this,"onConnect",void 0),(0,s.Z)(this,"onReadByte",void 0),(0,s.Z)(this,"onWriteByte",void 0),(0,s.Z)(this,"onDisconnect",void 0),(0,s.Z)(this,"addressFilter",void 0),this.addressFilter=i,this.outgoingByte=0,this.incomingByte=0,this.clockIndex=0,this.ack=!1,this.firstByte=!1,this.state=n.Idle;var u=e.scl,l=e.sda;u.setState(o.J.PullUp),l.setState(o.J.PullUp),l.onValueChange((function(t){var e,i,r,s;u.value&&!t&&(a.state=n.Start,a.clockIndex=0,a.incomingByte=0,null===(i=(e=a).onStart)||void 0===i||i.call(e));u.value&&t&&(a.state=n.Stop,null===(s=(r=a).onDisconnect)||void 0===s||s.call(r))})),u.onValueChange((function(t){var e=a.state===n.Start,i=a.state===n.Write,r=a.state===n.Read;if(t||l.setState(o.J.PullUp),t&&8===a.clockIndex)return a.incomingByte=0,void(a.clockIndex=0);if(e||i)if(t&&a.clockIndex<8)a.incomingByte<<=1,a.incomingByte|=l.value?1:0;else if(!t&&8===a.clockIndex){if(e){var s,u,c,d=a.incomingByte>>>1,h=!(1&a.incomingByte);if(a.addressFilter&&d!==a.addressFilter)a.ack=!1;else a.ack=null!==(c=null===(u=(s=a).onConnect)||void 0===u?void 0:u.call(s,d,h))&&void 0!==c&&c;a.ack?a.state=h?n.Write:n.Read:a.state=n.Idle,a.firstByte=!0}else{var v,f,p;a.ack=null!==(p=null===(f=(v=a).onWriteByte)||void 0===f?void 0:f.call(v,a.incomingByte))&&void 0!==p&&p}l.setState(a.ack?o.J.Low:o.J.PullUp)}if(r&&!t&&a.clockIndex<8)if(0===a.clockIndex&&l.value&&!a.firstByte)a.state=n.Idle;else{var g,y,m;if(0===a.clockIndex)a.outgoingByte=null!==(m=null===(y=(g=a).onReadByte)||void 0===y?void 0:y.call(g))&&void 0!==m?m:255,a.firstByte=!1;var w=a.outgoingByte&1<<7-a.clockIndex;l.setState(w?o.J.PullUp:o.J.Low)}t&&a.clockIndex++}))}return(0,a.Z)(t,[{key:"setHandler",value:function(t){this.onConnect=t.i2cConnect.bind(t),this.onReadByte=t.i2cReadByte.bind(t),this.onWriteByte=t.i2cWriteByte.bind(t),this.onDisconnect=t.i2cDisconnect.bind(t)}}]),t}()},16905:function(t,e,i){i.d(e,{v:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(37405),o=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=this;(0,n.Z)(this,t),(0,a.Z)(this,"busy",void 0),(0,a.Z)(this,"incomingByte",void 0),(0,a.Z)(this,"outgoingByte",void 0),(0,a.Z)(this,"bitIndex",void 0),(0,a.Z)(this,"clockIndex",void 0),(0,a.Z)(this,"clockNanos",void 0),(0,a.Z)(this,"completionCallback",void 0),(0,a.Z)(this,"clockCallback",void 0),(0,a.Z)(this,"clock",void 0),(0,a.Z)(this,"pins",void 0),(0,a.Z)(this,"mode",void 0),this.clock=e,this.pins=i,this.mode=r,this.busy=!1,this.incomingByte=0,this.outgoingByte=0,this.bitIndex=0,this.clockIndex=0,this.clockNanos=0,this.completionCallback=function(){return 0},this.clockCallback=function(){var t=o.clock,e=o.pins,i=e.clk,n=e.mosi,r=e.miso,a=o.clockIndex,u=o.bitIndex;a%2===1?(o.incomingByte|=(null===r||void 0===r?void 0:r.value)?1<<u:0,o.bitIndex--):null===n||void 0===n||n.setState(o.outgoingByte&1<<u?s.J.High:s.J.Low),i.setState(i.value?s.J.Low:s.J.High),o.clockIndex++,15===a?(o.busy=!1,o.completionCallback(o.incomingByte)):t.addEvent(o.clockNanos,o.clockCallback)};var u=r>=2,l=i.miso,c=i.clk,d=i.mosi;null===l||void 0===l||l.setState(s.J.HighZ),null===d||void 0===d||d.setState(s.J.HighZ),null===c||void 0===c||c.setState(u?s.J.High:s.J.Low)}return(0,r.Z)(t,[{key:"transmit",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=this.mode,r=this.pins,a=r.clk,o=r.mosi,u=n>=2,l=1===n||3===n;if(this.busy)throw new Error("SPI hardware is busy");this.busy=!0,this.incomingByte=0,this.bitIndex=7,this.clockIndex=0,this.outgoingByte=t,this.clockNanos=i,this.completionCallback=e,a.setState(u?s.J.High:s.J.Low),l?(null===o||void 0===o||o.setState(s.J.High),this.clock.addEvent(i,this.clockCallback)):this.clockCallback()}},{key:"transmitBuffer",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=this,r=0,a=function(s){s>=0&&(t[r-1]=s),r<t.length?n.transmit(t[r++],a,i):e()};a(-1)}}]),t}()},13291:function(t,e,i){i.d(e,{g:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(37405),o=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this;(0,n.Z)(this,t),(0,a.Z)(this,"outgoingByte",0),(0,a.Z)(this,"incomingByte",0),(0,a.Z)(this,"bitIndex",0),(0,a.Z)(this,"selected",!1),(0,a.Z)(this,"onTransmit",void 0),(0,a.Z)(this,"paused",!1),(0,a.Z)(this,"enable",void 0),(0,a.Z)(this,"disable",void 0);var u=i>=2,l=1===i||3===i,c=e.ss,d=e.miso,h=e.clk,v=e.mosi;null===d||void 0===d||d.setState(r?s.J.PullUp:s.J.HighZ);var f=r?s.J.PullUp:s.J.High,p=d?function(){d.setState(o.outgoingByte&1<<7-o.bitIndex?f:s.J.Low)}:function(){return 0},g=function(){var t,e;(o.incomingByte=o.incomingByte<<1|((null===v||void 0===v?void 0:v.value)?1:0),o.bitIndex++,8===o.bitIndex)&&(o.bitIndex=0,o.outgoingByte=0,null===(e=(t=o).onTransmit)||void 0===e||e.call(t,o.incomingByte),o.incomingByte=0)};this.selected=null==c||c.driven&&!1===c.value,this.enable=function(){o.selected||(o.bitIndex=0,u||p(),o.selected=!0,o.paused=!1)},this.disable=function(){null===d||void 0===d||d.setState(r?s.J.PullUp:s.J.HighZ),o.selected=!1},null===c||void 0===c||c.onStateChange((function(){(null===c||void 0===c?void 0:c.driven)&&!1===(null===c||void 0===c?void 0:c.value)?o.enable():o.disable()})),h.onValueChange((function(){if(o.selected&&!o.paused){var t=u!==h.value;l===t?p():g()}}))}return(0,r.Z)(t,[{key:"sendByte",value:function(t){this.outgoingByte=t}}]),t}()},35154:function(t,e,i){i.d(e,{g:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=i(29182),o=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9600,o=this;(0,n.Z)(this,t),(0,a.Z)(this,"listeners",void 0),(0,a.Z)(this,"autoBaudRate",void 0),(0,a.Z)(this,"rxInProgress",void 0),(0,a.Z)(this,"bits",void 0),(0,a.Z)(this,"stopBits",void 0),(0,a.Z)(this,"parity",void 0),(0,a.Z)(this,"baudRate",void 0),this.baudRate=r,this.listeners=new Set,this.autoBaudRate=!1,this.rxInProgress=!1,this.bits=8,this.stopBits=1,this.parity=s.A.None,i.protocols.uartRX=this,i.onValueChange((function(){if(o.autoBaudRate){var t=!0,n=!1,r=void 0;try{for(var a,u=i.node.pins[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var l=a.value.protocols.uartTX;l&&!l.autoBaudRate&&(o.baudRate=l.baudRate)}}catch(v){n=!0,r=v}finally{try{t||null==u.return||u.return()}finally{if(n)throw r}}}var c=1e9/o.baudRate;if(!i.value&&!o.rxInProgress){o.rxInProgress=!0;var d=0,h=o.bits;e.addEvent(Math.round(.5*c),(function(){var t=function(t){e.addEvent(Math.round(c*(t+1)),(function(){d|=i.value?1<<t:0}))};if(i.value)o.rxInProgress=!1;else{for(var n=0;n<h;n++)t(n);var r=h+o.stopBits;o.parity!==s.A.None&&r++,e.addEvent(Math.round(c*r),(function(){if(i.value){var t=!0,e=!1,n=void 0;try{for(var r,a=o.listeners[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){(0,r.value)(new Uint8Array([d]))}}catch(v){e=!0,n=v}finally{try{t||null==a.return||a.return()}finally{if(e)throw n}}}o.rxInProgress=!1}))}}))}}))}return(0,r.Z)(t,[{key:"feedFromTx",value:function(t){if(this.rxInProgress)return!1;var e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(new Uint8Array([t]))}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}return!0}},{key:"subscribe",value:function(t){var e=this;return this.listeners.add(t),function(){return e.listeners.delete(t)}}}]),t}()},80450:function(t,e,i){i.d(e,{x:function(){return l}});var n=i(51438),r=i(52951),a=i(14924),s=i(96387),o=i(37405),u=i(29182),l=function(){function t(e,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9600;(0,n.Z)(this,t),(0,a.Z)(this,"onTxComplete",void 0),(0,a.Z)(this,"fifo",void 0),(0,a.Z)(this,"busy",void 0),(0,a.Z)(this,"autoBaudRate",void 0),(0,a.Z)(this,"bits",void 0),(0,a.Z)(this,"stopBits",void 0),(0,a.Z)(this,"parity",void 0),(0,a.Z)(this,"clock",void 0),(0,a.Z)(this,"tx",void 0),(0,a.Z)(this,"baudRate",void 0),this.clock=e,this.tx=i,this.baudRate=r,this.fifo=new s.Q,this.busy=!1,this.autoBaudRate=!1,this.bits=8,this.stopBits=1,this.parity=u.A.None,i.protocols.uartTX=this,i.state=o.J.PullUp}return(0,r.Z)(t,[{key:"transmit",value:function(t){var e=this,i=function(i){e.clock.addEvent(f*(i+1),(function(){r.state=t&1<<i?o.J.PullUp:o.J.Low,p^=r.state?1:0}))},n=this,r=this.tx,a=this.bits;if(this.busy)return!1;if(this.autoBaudRate){var s=!0,l=!1,c=void 0;try{for(var d,h=r.node.pins[Symbol.iterator]();!(s=(d=h.next()).done);s=!0){var v=d.value.protocols.uartRX;v&&!v.autoBaudRate&&(this.baudRate=v.baudRate)}}catch(m){l=!0,c=m}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}}this.busy=!0;var f=Math.round(1e9/this.baudRate);r.state=o.J.Low;for(var p=0,g=0;g<a;g++)i(g);var y=a+1;return this.parity!==u.A.None&&(this.parity===u.A.Odd&&(p^=1),this.clock.addEvent(f*y++,(function(){r.state=p?o.J.PullUp:o.J.Low}))),this.clock.addEvent(f*y++,(function(){r.state=o.J.PullUp})),2===this.stopBits&&y++,this.clock.addEvent(f*y++,(function(){n.busy=!1,n.transmitNext()})),!0}},{key:"transmitNext",value:function(){if(!this.busy){var t,e=this.fifo.next();if(null!=e)this.transmit(e);else null===(t=this.onTxComplete)||void 0===t||t.call(this)}}},{key:"write",value:function(t){this.fifo.write(t),this.transmitNext()}},{key:"writeByte",value:function(t){this.busy?this.fifo.writeByte(t):this.transmit(t)}},{key:"isBusy",get:function(){return this.busy}}]),t}()},29182:function(t,e,i){var n;i.d(e,{A:function(){return n}}),function(t){t[t.None=0]="None",t[t.Odd=1]="Odd",t[t.Even=2]="Even"}(n||(n={}))},41725:function(t,e,i){function n(t,e){var i=/^\d+\.\d+V/.test(e)?e.replace(/\.\d+$/,""):e.split(".")[0];return"".concat(t,":").concat(i)}function r(t){var e=t.split(":");return{partId:e[0],pinName:e[1]}}function a(t,e,i){var n=!0,r=!1,a=void 0;try{for(var s,o=i.pins[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;e.pins.add(u),t.set(u,e)}}catch(l){r=!0,a=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}function s(t){var e=new Map,i=!0,r=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var l=o.value,c=l.fromPart,d=l.fromPin,h=l.toPart,v=l.toPin,f=n(c,d),p=n(h,v),g=e.get(f)||{pins:new Set([f])},y=e.get(p)||{pins:new Set([p])};e.set(f,g),e.set(p,y),a(e,g,y)}}catch(m){r=!0,s=m}finally{try{i||null==u.return||u.return()}finally{if(r)throw s}}return e}i.d(e,{XP:function(){return s},_N:function(){return r},r4:function(){return n}})},42051:function(t,e,i){i.d(e,{$:function(){return u}});var n=i(51438),r=i(52951),a=i(14924),s=i(82670),o=function(){function t(e){(0,n.Z)(this,t),(0,a.Z)(this,"callback",void 0),this.callback=e}return(0,r.Z)(t,[{key:"pause",value:function(){}},{key:"resume",value:function(){}}]),t}(),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:125e6;(0,n.Z)(this,t),(0,a.Z)(this,"nextClockEvent",void 0),(0,a.Z)(this,"clockEventPool",void 0),(0,a.Z)(this,"skippedCycles",void 0),(0,a.Z)(this,"cpu",void 0),(0,a.Z)(this,"unschedule",void 0),(0,a.Z)(this,"frequency",void 0),this.frequency=e,this.nextClockEvent=null,this.clockEventPool=[],this.skippedCycles=0,this.cpu={cycles:0},this.unschedule=this.clearEvent}return(0,r.Z)(t,[{key:"micros",get:function(){return this.cpuNanos/1e3}},{key:"cpuMillis",get:function(){return this.cpu.cycles/this.frequency*1e3}},{key:"ticks",get:function(){return this.cpuNanos}},{key:"cpuNanos",get:function(){return this.cpu.cycles/this.frequency*1e9}},{key:"nanos",get:function(){return this.cpuNanos}},{key:"addEvent",value:function(t,e){var i=Math.round(t/1e9*this.frequency);return this.addEventCycles(i,e)}},{key:"clearEvent",value:function(t){var e=this.nextClockEvent;if(!e)return!1;for(var i=this.clockEventPool,n=null;e;){if(e.callback===t)return n?n.next=e.next:this.nextClockEvent=e.next,i.length<10&&i.push(e),!0;n=e,e=e.next}return!1}},{key:"schedule",value:function(t,e){return this.addEvent(e,t)}},{key:"addEventCycles",value:function(t,e){var i=this.clockEventPool;t=this.cpu.cycles+Math.max(1,t);var n=i.pop(),r=null!==n&&void 0!==n?n:{cycles:t,callback:e,next:null};r.cycles=t,r.callback=e;for(var a=this.nextClockEvent,s=null;a&&a.cycles<t;)s=a,a=a.next;return s?(s.next=r,r.next=a):(this.nextClockEvent=r,r.next=a),e}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"tick",value:function(){var t=this.nextClockEvent;t&&t.cycles<=this.cpu.cycles&&(this.nextClockEvent=t.next,this.clockEventPool.length<10&&this.clockEventPool.push(t),t.callback())}},{key:"createTimer",value:function(t,e){var i=new o(e);return this.addEvent(1e3*t,e),i}},{key:"deleteTimer",value:function(t){(0,s.Z)(t,o)&&this.clearEvent(t.callback)}},{key:"createEvent",value:function(t){var e=this;return{schedule:function(i){e.clearEvent(t),e.addEvent(i,t)},unschedule:function(){e.clearEvent(t)}}}},{key:"skipToNextEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.nextClockEvent;e&&(!t||e.cycles<=t)?(this.cpu.cycles=e.cycles,this.nextClockEvent=e.next,this.clockEventPool.length<10&&this.clockEventPool.push(e),e.callback()):t>this.cpu.cycles&&(this.cpu.cycles=t)}},{key:"nextClockEventCycles",get:function(){var t,e;return null!==(e=null===(t=this.nextClockEvent)||void 0===t?void 0:t.cycles)&&void 0!==e?e:0}}]),t}()},99941:function(t,e,i){i.d(e,{B:function(){return o}});var n=i(51438),r=i(52951),a=i(14924),s=1e3/30,o=function(){function t(e){var i=this;(0,n.Z)(this,t),(0,a.Z)(this,"lastMillis",void 0),(0,a.Z)(this,"animationFrame",void 0),(0,a.Z)(this,"legacy",void 0),(0,a.Z)(this,"afterRun",void 0),(0,a.Z)(this,"run",void 0),(0,a.Z)(this,"execute",void 0),this.execute=e,this.lastMillis=-1,this.animationFrame=null,this.legacy=!1,this.run=function(t){var e,n,r=t-i.lastMillis;i.lastMillis=t;var a=i.execute(r<s?r:s);null===(n=(e=i).afterRun)||void 0===n||n.call(e),i.animationFrame=a?requestAnimationFrame(i.run):null}}return(0,r.Z)(t,[{key:"start",value:function(){this.stop(),this.animationFrame=requestAnimationFrame(this.run)}},{key:"stop",value:function(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)}}]),t}()},98561:function(t,e,i){function n(){var t=Math.random();return t<.1?-Math.floor(60+t/.1*10):t<.3?-Math.floor(70+(t-.1)/.2*10):t<.7?-Math.floor(80+(t-.3)/.4*10):-Math.floor(90+(t-.7)/.3*10)}i.d(e,{a:function(){return n}})},24723:function(t,e,i){i.d(e,{c:function(){return F}});var n,r=i(51438),a=i(52951),s=i(14924),o=i(82670),u=i(1965),l=i(4111),c=i(28668),d=i(26626),h=i(29815);!function(t){t[t.SSID=0]="SSID",t[t.SupportedRates=1]="SupportedRates",t[t.FHParameterSet=2]="FHParameterSet",t[t.DSParameterSet=3]="DSParameterSet",t[t.CFParameterSet=4]="CFParameterSet",t[t.TrafficIndicationMap=5]="TrafficIndicationMap",t[t.IBSSParameterSet=6]="IBSSParameterSet",t[t.Country=7]="Country",t[t.HoppingPatternParameters=8]="HoppingPatternParameters",t[t.HoppingPatternTable=9]="HoppingPatternTable",t[t.Request=10]="Request",t[t.ChallengeText=16]="ChallengeText",t[t.PowerConstraint=32]="PowerConstraint",t[t.PowerCapability=33]="PowerCapability",t[t.TPCRequest=34]="TPCRequest",t[t.TPCReport=35]="TPCReport",t[t.SupportedChannels=36]="SupportedChannels",t[t.ChannelSwitchAnnouncement=37]="ChannelSwitchAnnouncement",t[t.MeasurementRequest=38]="MeasurementRequest",t[t.MeasurementReport=39]="MeasurementReport",t[t.Quiet=40]="Quiet",t[t.IBSSDFS=41]="IBSSDFS",t[t.ERPInformation=42]="ERPInformation",t[t.RobustSecurityNetwork=48]="RobustSecurityNetwork",t[t.ExtendedSupportedRates=50]="ExtendedSupportedRates",t[t.WPA=221]="WPA"}(n||(n={}));var v,f,p=[255,255,255,255,255,255];function g(t,e){return[t,e.length].concat((0,h.Z)(Array.from(e)))}function y(t){return"undefined"!==typeof TextEncoder?(new TextEncoder).encode(t):t.split("").map((function(t){return t.charCodeAt(0)}))}function m(t){return"undefined"!==typeof TextDecoder?(new TextDecoder).decode(t):Array.from(t).map((function(t){return String.fromCharCode(t)})).join("")}function w(t,e){return t[e+1]<<8|t[e]}function k(t,e){return(3&t)<<2|(15&e)<<4}function Z(t){for(var e=0,i=[];e+1<t.length;){var n=t[e++],r=t[e++];t.length>=e+r&&i.push({id:n,value:t.slice(e,e+r)}),e+=r}return i}function b(t){return t.slice(10,16)}function C(t,e){var i=e.target,n=e.bssid,r=e.seq;return[k(v.Management,t)].concat((0,h.Z)([0,0,0]),(0,h.Z)(Array.from(i)),(0,h.Z)(Array.from(n)),(0,h.Z)(Array.from(n)),(0,h.Z)([r>>4&255,r<<4&255]))}function _(t){var e=t.bssid,i=t.seq,r=t.channel,a=t.ssid;return new Uint8Array((0,h.Z)(C(f.Beacon,{target:p,bssid:e,seq:i})).concat((0,h.Z)([0,0,0,0,0,0,0,0]),(0,h.Z)([100,0]),(0,h.Z)([33,4]),(0,h.Z)(g(n.SSID,y(a))),(0,h.Z)(g(n.SupportedRates,[140,18,152,36,176,72,96,108])),(0,h.Z)(g(n.DSParameterSet,[r])),(0,h.Z)(g(n.TrafficIndicationMap,[0,2,0,0,0,0]))))}!function(t){t[t.Management=0]="Management",t[t.Control=1]="Control",t[t.Data=2]="Data"}(v||(v={})),function(t){t[t.AssociationRequest=0]="AssociationRequest",t[t.ReassociationRequest=2]="ReassociationRequest",t[t.ProbeRequest=4]="ProbeRequest",t[t.TimingAdvertisement=6]="TimingAdvertisement",t[t.Beacon=8]="Beacon",t[t.Disassociation=10]="Disassociation",t[t.Deauthentication=12]="Deauthentication",t[t.Authentication=11]="Authentication",t[t.Action=14]="Action",t[t.AssociationResponse=1]="AssociationResponse",t[t.ReassociationResponse=3]="ReassociationResponse",t[t.ProbeResponse=5]="ProbeResponse",t[t.Reserved=7]="Reserved"}(f||(f={}));var S,x,P=1e8,I=function(){function t(e,i,n){var a=this;(0,r.Z)(this,t),(0,s.Z)(this,"clients",void 0),(0,s.Z)(this,"onReceive",void 0),(0,s.Z)(this,"sendBeacon",void 0),(0,s.Z)(this,"clock",void 0),(0,s.Z)(this,"medium",void 0),(0,s.Z)(this,"config",void 0),this.clock=e,this.medium=i,this.config=n,this.clients=new Map,this.onReceive=function(t){var e=t.data,i=t.channel,n=a.config;if(!(i!==n.channel&&i!==n.channel+2||e.length<10)){var r=function(t){var e=t[0]>>2&3,i=t.slice(4,10),n=t.slice(16,22);return{version:3&t[0],type:e,subtype:t[0]>>4&15,flags:t[1],duration:(t[3]>>8)+t[2],target:e===v.Data?n:i,source:t.slice(10,16),bssid:e===v.Data?i:n}}(e),s=r.type,o=r.subtype,l=r.target,c=r.bssid,d=r.source;switch(s){case v.Management:n.bssid.match(new u.o(l))&&a.managementFrame(o,e);break;case v.Data:var h=new u.o(d).toString(),f=a.clients.get(h),p=4&o;f&&n.bssid.match(new u.o(c))&&!p&&a.onDataFrame(f,e)}}},this.sendBeacon=function(){var t=a.config;a.medium.transmit({channel:t.channel,data:_({bssid:t.bssid.bytes,ssid:t.ssid,channel:t.channel,seq:0})}),a.clock.addEvent(P,a.sendBeacon)},this.config.hidden||this.clock.addEvent(P,this.sendBeacon),i.listen(this.onReceive)}return(0,a.Z)(t,[{key:"onDataFrame",value:function(t,e){}},{key:"onClientConnected",value:function(t){}},{key:"transmit",value:function(t){this.medium.transmit({data:t,channel:this.config.channel})}},{key:"managementFrame",value:function(t,e){var i,r=this.config;switch(t){case f.ProbeRequest:var a=function(t){var e=Z(t.subarray(24)).find((function(t){return t.id===n.SSID}));return{source:b(t),ssid:e?m(e.value):""}}(e);a.ssid!==r.ssid&&""!==a.ssid||this.transmit(function(t){var e=t.target,i=t.ssid,r=t.bssid,a=t.seq,s=t.channel;return new Uint8Array((0,h.Z)(C(f.ProbeResponse,{target:e,bssid:r,seq:a})).concat((0,h.Z)([0,0,0,0,0,0,0,0]),(0,h.Z)([100,0]),(0,h.Z)([33,4]),(0,h.Z)(g(n.SSID,y(i))),(0,h.Z)(g(n.SupportedRates,[140,18,152,36,176,72,96,108])),(0,h.Z)(g(n.DSParameterSet,[s]))))}({target:a.source,bssid:r.bssid.bytes,ssid:r.ssid,channel:1,seq:0}));break;case f.Deauthentication:this.clients.delete(new u.o(b(e)).toString());break;case f.Authentication:var s={source:b(i=e),algorithm:w(i,24),authSeq:w(i,26),status:w(i,28)};this.transmit(function(t){var e,i=t.target,n=t.bssid,r=t.seq,a=t.authSeq;return new Uint8Array((0,h.Z)(C(f.Authentication,{target:i,bssid:n,seq:r})).concat((0,h.Z)([0,0]),(0,h.Z)([255&(e=a),e>>8&255]),(0,h.Z)([0,0])))}({target:s.source,bssid:r.bssid.bytes,seq:0,authSeq:s.authSeq+1}));break;case f.AssociationRequest:var o=function(t){var e=Z(t.subarray(28)).find((function(t){return t.id===n.SSID}));return{source:b(t),ssid:e?m(e.value):""}}(e),l=new u.o(o.source);if(!this.clients.has(l.toString())){var c={mac:l};this.clients.set(l.toString(),c),this.onClientConnected(c)}this.transmit(function(t){var e=t.target,i=t.bssid,r=t.seq;return new Uint8Array((0,h.Z)(C(f.AssociationResponse,{target:e,bssid:i,seq:r})).concat((0,h.Z)([33,4]),(0,h.Z)([0,0]),(0,h.Z)([1,192]),(0,h.Z)(g(n.SupportedRates,[140,18,152,36,176,72,96,108]))))}({target:o.source,bssid:r.bssid.bytes,seq:0}))}}}]),t}(),D=i(2889),A=function(){function t(e){if((0,r.Z)(this,t),(0,s.Z)(this,"bytes",void 0),(0,s.Z)(this,"address",void 0),this.address=e,"string"===typeof e){var i=e.split(".");this.bytes=new Uint8Array([parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10)])}else this.bytes=e.subarray(0,4)}return(0,a.Z)(t,[{key:"toString",value:function(){var t=this.bytes;return"".concat(t[0],".").concat(t[1],".").concat(t[2],".").concat(t[3])}}]),t}();!function(t){t[t.IP=2048]="IP",t[t.ARP=2054]="ARP",t[t.IPv6=34525]="IPv6"}(S||(S={})),function(t){t[t.ICMP=1]="ICMP",t[t.IGMP=2]="IGMP",t[t.TCP=6]="TCP",t[t.UDP=17]="UDP"}(x||(x={}));var R,B=function(){function t(e){(0,r.Z)(this,t),(0,s.Z)(this,"socket",void 0),(0,s.Z)(this,"buffer",void 0),(0,s.Z)(this,"enableWarning",void 0),(0,s.Z)(this,"gatewayType",void 0),(0,s.Z)(this,"onRecvFrame",void 0),(0,s.Z)(this,"url",void 0),this.url=e,this.buffer=[],this.enableWarning=!0,this.gatewayType="public"}return(0,a.Z)(t,[{key:"connect",value:function(t){var e=this,i=new WebSocket(this.url+"?"+t.toString());i.binaryType="arraybuffer",this.socket=i,i.addEventListener("close",(function(){e.socket=void 0})),i.addEventListener("open",(function(){if(e.buffer){var t=!0,n=!1,r=void 0;try{for(var a,s=e.buffer[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var o=a.value;i.send(o)}}catch(u){n=!0,r=u}finally{try{t||null==s.return||s.return()}finally{if(n)throw r}}e.buffer=[]}})),i.addEventListener("message",(function(t){var i,n,r=t.data;if((0,o.Z)(r,ArrayBuffer))null===(n=(i=e).onRecvFrame)||void 0===n||n.call(i,new Uint8Array(r));else if(e.enableWarning){try{var a=JSON.parse(r);if("aloha"===a.type&&"wokwigw"===a.protocol)return console.log("WiFi proxy",a.gatewayVersion),e.gatewayType=a.gatewayVersion.startsWith("netwi")?"public":"private",(0,D.c)("wifi:connect",{gateway:a.gatewayVersion,gatewayType:e.gatewayType}),void(0,D.L)({action:e.gatewayType,category:"wifi",label:a.gatewayVersion})}catch(s){}console.warn("Unknown WiFi data",r),e.enableWarning=!1}})),i.addEventListener("error",(function(t){console.error("WiFi Internet error",t)}))}},{key:"connected",get:function(){return null!=this.socket}},{key:"send",value:function(t){var e,i=function(t){var e={frame:t,frameLength:t.length,etherType:0,packetType:"unknown"};if(t.length<14)return e;e.destinationMAC=new u.o(t.slice(0,6)).toString(),e.sourceMAC=new u.o(t.slice(6,12)).toString(),e.etherType=t[12]<<8|t[13];var i=t.subarray(14);switch(e.etherType){case S.ARP:e.packetType="arp";break;case S.IP:if(e.packetType="ip",i.length<20)break;var n=4*(15&i[0]);e.protocol=i[9],e.sourceIP=new A(i.slice(12,16)).toString(),e.destinationIP=new A(i.slice(16,20)).toString();var r=i.subarray(n);switch(e.protocol){case x.ICMP:e.packetType="icmp";break;case x.IGMP:e.packetType="igmp";break;case x.TCP:if(e.packetType="tcp",r.length<20)break;e.sourcePort=r[0]<<8|r[1],e.destinationPort=r[2]<<8|r[3];break;case x.UDP:if(e.packetType="udp",r.length<8)break;e.sourcePort=r[0]<<8|r[1],e.destinationPort=r[2]<<8|r[3]}break;case S.IPv6:e.packetType="ip6"}return e}(t);"public"===this.gatewayType&&"udp"===i.packetType&&5353===i.sourcePort&&5353===i.destinationPort||((null===(e=this.socket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN?this.socket.send(t):this.buffer.push(t))}}]),t}(),T=function(t){(0,c.Z)(i,t);var e=(0,d.Z)(i);function i(t,n,a,o){var u;return(0,r.Z)(this,i),u=e.call(this,t,n,a),(0,s.Z)((0,l.Z)(u),"proxyParams",void 0),(0,s.Z)((0,l.Z)(u),"gateway",void 0),(0,s.Z)((0,l.Z)(u),"proxy",void 0),u.proxy=o,u.proxyParams=new URLSearchParams,u.gateway=new B(u.proxy),u.attachGateway(u.gateway),u}return(0,a.Z)(i,[{key:"attachGateway",value:function(t){var e=this;this.gateway.onRecvFrame=void 0,this.gateway=t,this.gateway.onRecvFrame=function(t){var i,n;e.transmit((i=t,n=e.config.bssid.bytes,new Uint8Array([k(v.Data,0),2].concat((0,h.Z)([0,0]),(0,h.Z)(i.slice(0,6)),(0,h.Z)(Array.from(n)),(0,h.Z)(i.slice(6,12)),(0,h.Z)([0,0]),(0,h.Z)([170,170,3,0,0,0]),(0,h.Z)(i.slice(12))))))}}},{key:"onClientConnected",value:function(){this.gateway.connect(this.proxyParams)}},{key:"onDataFrame",value:function(t,e){var i=function(t){var e=128&t[0];return new Uint8Array((0,h.Z)(t.slice(16,22)).concat((0,h.Z)(t.slice(10,16)),(0,h.Z)(t.slice(e?32:30))))}(e);this.gateway.send(i)}}]),i}(I),E=i(95315),U=i(70222),N=i(88409),O=i(84003);function M(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6*(new Date).getTime(),i=new Uint8Array(16+t.length),n=new DataView(i.buffer);return n.setUint32(0,Math.floor(e/1e9),!0),n.setUint32(4,Math.floor(e%1e9),!0),n.setUint32(8,t.length,!0),n.setUint32(12,t.length,!0),i.set(t,16),i}!function(t){t[t.ETHERNET=1]="ETHERNET",t[t.IEEE802_11=105]="IEEE802_11",t[t.IEEE802_11_RADIOTAP=127]="IEEE802_11_RADIOTAP"}(R||(R={}));var L=new WeakMap,V=function(){function t(e){var n,a=this;(0,r.Z)(this,t),(0,U.Z)(this,L,{writable:!0,value:void 0}),(0,s.Z)(this,"listeners",void 0),(0,s.Z)(this,"frames",void 0),(0,s.Z)(this,"framesBytes",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,(0,N.Z)(this,L,"undefined"!==typeof BroadcastChannel?new BroadcastChannel("WiFi"):void 0),this.listeners=new Set,this.frames=[],this.framesBytes=0,null===(n=(0,E.Z)(this,L))||void 0===n||n.addEventListener("message",(function(t){var e=t.data,i=!0,n=!1,r=void 0;try{for(var s,o=a.listeners[Symbol.iterator]();!(i=(s=o.next()).done);i=!0){(0,s.value)(e)}}catch(u){n=!0,r=u}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}})),i.g.downloadPcap=function(){console.log('To download a PCAP file, press "F1" in the code editor and select "Download WiFi Packet Capture (PCAP) file"')}}return(0,a.Z)(t,[{key:"listen",value:function(t){this.listeners.add(t)}},{key:"transmit",value:function(t){this.frames.push({nanos:this.clock.cpuNanos,data:t.data}),this.framesBytes+=t.data.length;var e=!0,i=!1,n=void 0;try{for(var r,a=this.listeners[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){(0,r.value)(t)}}catch(s){i=!0,n=s}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"downloadPcap",value:function(){var t=24+16*this.frames.length,e=new Uint8Array(t+this.framesBytes);e.set(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R.IEEE802_11,e=new Uint8Array(24),i=new DataView(e.buffer);return i.setUint32(0,2712812621,!0),i.setUint16(4,2,!0),i.setUint16(6,4,!0),i.setUint16(16,65535,!0),i.setUint16(20,t,!0),e}());var i=24,n=!0,r=!1,a=void 0;try{for(var s,o=this.frames[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,l=u.data,c=u.nanos;e.set(M(l,c),i),i+=16+l.length}}catch(d){r=!0,a=d}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}(0,O.Sv)("wokwi.pcap",e,"application/vnd.tcpdump.pcap")}}]),t}();var F=function(){function t(e){var i;(0,r.Z)(this,t),(0,s.Z)(this,"medium",void 0),(0,s.Z)(this,"accessPoints",void 0),(0,s.Z)(this,"clock",void 0),this.clock=e,this.medium=new V(this.clock),this.accessPoints=[new T(this.clock,this.medium,{channel:6,ssid:"Wokwi-GUEST",bssid:new u.o("42:13:37:55:aa:01"),hidden:!1},(i="wss://netwi.wokwi.com/","undefined"!==typeof localStorage&&localStorage.getItem("__proxy")||i))]}return(0,a.Z)(t,[{key:"setCredentials",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.accessPoints[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;(0,o.Z)(s,T)&&(s.proxyParams=new URLSearchParams({u:t.user||"anonymous",p:t.project}))}}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"setGateway",value:function(t){var e=!0,i=!1,n=void 0;try{for(var r,a=this.accessPoints[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var s=r.value;(0,o.Z)(s,T)&&s.attachGateway(t)}}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}}]),t}()},28715:function(t,e,i){i.d(e,{Jj:function(){return l},Uf:function(){return o},Y1:function(){return u}});var n=i(2236),r=i(47568),a=i(29815),s=i(20414);function o(){return window.showDirectoryPicker}function u(){return window.showDirectoryPicker()}function l(t,e){return c.apply(this,arguments)}function c(){return(c=(0,r.Z)((function(t,e){var i,r,o,u,c,d,h,v,f,p,g,y,m,w;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:i=[],r=!1,o=!1,s.label=1;case 1:s.trys.push([1,10,11,16]),c=(0,n.Z)(t.values()),s.label=2;case 2:return[4,c.next()];case 3:return(r=!(d=s.sent()).done)?(h=d.value,"directory"!==(v=h).kind?[3,5]:(g=(p=(f=i).push).apply,y=[f],[4,l(v,e)])):[3,9];case 4:return g.apply(p,y.concat(a.Z.apply(void 0,[s.sent()]))),[3,8];case 5:return(m=e(v))&&"then"in m?[4,m]:[3,7];case 6:m=s.sent(),s.label=7;case 7:null!=m&&i.push(m),s.label=8;case 8:return r=!1,[3,2];case 9:return[3,16];case 10:return w=s.sent(),o=!0,u=w,[3,16];case 11:return s.trys.push([11,,14,15]),r&&null!=c.return?[4,c.return()]:[3,13];case 12:s.sent(),s.label=13;case 13:return[3,15];case 14:if(o)throw u;return[7];case 15:return[7];case 16:return[2,i]}}))}))).apply(this,arguments)}},8371:function(t,e,i){function n(t,e,i){return t<e?e:t>i?i:t}i.d(e,{u:function(){return n}})},79207:function(t,e,i){i.d(e,{Z:function(){return r},w:function(){return a}});var n=i(10253);function r(t){var e=t.replace(/[_,]/g,"").trim().toLowerCase(),i=/^([\d.]+)\s*([mk]|[mk]hz|hz|)$/.exec(e);if(!i)return 0;var r=(0,n.Z)(i,3),a=r[1],s=r[2],o=parseFloat(a);switch(s[0]){case"m":return Math.round(1e6*o);case"k":return Math.round(1e3*o);default:return o}}function a(t){var e="";t>=1e3&&t<1e6?(e="k",t/=1e3):t>=1e6&&t<1e9?(e="m",t/=1e6):t>=1e9&&(e="g",t/=1e9);for(var i=3,n=t.toFixed(i);i&&(n.endsWith("0")||n.endsWith(".")||n.length>4);)i--,n=t.toFixed(i);return"".concat(n).concat(e)}},56498:function(t,e,i){function n(t){return t>=16?t.toString(16):"0"+t.toString(16)}function r(t){return n(t>>8&255)+n(255&t)}function a(t){return r(t>>16&65535)+r(65535&t)}i.d(e,{MS:function(){return a},Tf:function(){return r},sA:function(){return n}})},1965:function(t,e,i){i.d(e,{o:function(){return u}});var n=i(51438),r=i(52951),a=i(14924),s=i(82670),o=i(56498),u=function(){function t(e){if((0,n.Z)(this,t),(0,a.Z)(this,"bytes",void 0),"string"===typeof e){var i=e.split(":");this.bytes=new Uint8Array([parseInt(i[0],16),parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16),parseInt(i[4],16),parseInt(i[5],16)])}else this.bytes=e}return(0,r.Z)(t,[{key:"match",value:function(e){return e.equals(t.broadcast)||this.equals(e)}},{key:"equals",value:function(e){return(0,s.Z)(e,t)&&this.toString()===e.toString()}},{key:"toString",value:function(){var t,e,i,n,r,a,s=this.bytes;return[(0,o.sA)(null!==(t=s[0])&&void 0!==t?t:0),(0,o.sA)(null!==(e=s[1])&&void 0!==e?e:0),(0,o.sA)(null!==(i=s[2])&&void 0!==i?i:0),(0,o.sA)(null!==(n=s[3])&&void 0!==n?n:0),(0,o.sA)(null!==(r=s[4])&&void 0!==r?r:0),(0,o.sA)(null!==(a=s[5])&&void 0!==a?a:0)].join(":")}}]),t}();(0,a.Z)(u,"broadcast",new u("ff:ff:ff:ff:ff:ff"))},66869:function(t,e,i){function n(t,e){return t+Math.round(Math.random()*(e-t))}i.d(e,{r:function(){return n}})},76136:function(t,e,i){function n(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65536,n=new Uint8Array(t.buffer),r=Math.min(n.indexOf(0,e),e+i+1),a=n.subarray(e,r);return(new TextDecoder).decode(a)}i.d(e,{V:function(){return n}})}}]);