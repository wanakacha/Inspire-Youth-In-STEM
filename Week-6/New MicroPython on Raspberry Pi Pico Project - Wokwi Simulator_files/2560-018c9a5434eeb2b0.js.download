"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2560],{81564:function(e,n,r){r.d(n,{r:function(){return u}});var t=r(51438),i=r(52951),a=r(14924),o=r(68949),u=function(){function e(){(0,t.Z)(this,e),(0,a.Z)(this,"activeLine",0),(0,a.Z)(this,"breakpoints",[]),(0,a.Z)(this,"debuggers",new Set),(0,o.ky)(this)}return(0,i.Z)(e,[{key:"setBreakpoint",value:function(e){this.breakpoints.push({lineNumber:e});var n=!0,r=!1,t=void 0;try{for(var i,a=this.debuggers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.setBreakpoint(e)}}catch(o){r=!0,t=o}finally{try{n||null==a.return||a.return()}finally{if(r)throw t}}}},{key:"removeBreakpoint",value:function(e){this.breakpoints=this.breakpoints.filter((function(n){return n.lineNumber!==e}));var n=!0,r=!1,t=void 0;try{for(var i,a=this.debuggers[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.removeBreakpoint(e)}}catch(o){r=!0,t=o}finally{try{n||null==a.return||a.return()}finally{if(r)throw t}}}},{key:"setActiveLine",value:function(e){this.activeLine=e}},{key:"addDebugger",value:function(e){var n=this;return this.debuggers.add(e),function(){return n.debuggers.delete(e)}}}]),e}()},22560:function(e,n,r){r.d(n,{IK:function(){return C},d$:function(){return x},ir:function(){return k}});var t=r(47568),i=r(29815),a=r(20414),o=r(38966),u=r.n(o),s=r(67090),d=r(26042),l=r(69396);var c=r(78298),f=r(84104),v=r(41842),h=r(68102),m=r(28467);function g(e){return""!==e?parseInt(e,8):0}var p=r(60286),y=r(81564),b=s.V5.model({name:s.V5.string,size:s.V5.number,serverId:s.V5.maybe(s.V5.string)}).volatile((function(){return{buffer:null,progress:0,modified:!1,uploading:!1,downloading:!1,uploadFailed:!1,abort:new AbortController}})).views((function(e){return{get transferring(){return e.uploading||e.downloading}}})).actions((function(e){return{updateProgress:function(n){e.progress=n},completeUpload:function(n){e.uploading=!1,n?e.serverId=n:(e.uploadFailed=!0,e.modified=!1)},setBuffer:function(n){e.buffer=null!==n&&void 0!==n?n:null,e.downloading=!1},setPristine:function(){e.modified=!1}}})).actions((function(e){return{upload:function(n,r){return(0,t.Z)((function(){var t,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(e.serverId||e.uploading)return[2];(0,h.DT)(r).then((function(n){return e.setBuffer(n)})),e.uploading=!0,e.modified=!0,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(0,v.cT)(n,r,{abortSignal:e.abort.signal,onProgress:function(n){return e.updateProgress(n.loaded/n.total)}})];case 2:return t=a.sent(),e.completeUpload(t.fileId),[3,4];case 3:return i=a.sent(),console.error(i),e.completeUpload(),[3,4];case 4:return[2]}}))}))()},afterCreate:function(){return(0,t.Z)((function(){var n,r;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:if(!e.serverId)return[3,4];e.downloading=!0,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,v.Sv)(e.serverId,{abortSignal:e.abort.signal,onProgress:function(n){return e.updateProgress(n.loaded/e.size)}})];case 2:return n=t.sent(),e.setBuffer(n),[3,4];case 3:return r=t.sent(),console.error(r),e.setBuffer(),[3,4];case 4:return[2]}}))}))()},beforeDestroy:function(){e.abort.abort()}}})),k="sdcard/",x=s.V5.model({name:s.V5.string,content:s.V5.string}).volatile((function(e){return{originalName:e.name,originalContent:e.content,deleted:!1,editorState:null,errors:[],debugger:new y.r}})).views((function(e){return{get type(){return(0,f.r5)(e.name)},get modified(){return e.content!==e.originalContent||e.originalName!==e.name}}})).actions((function(e){return{update:function(n){e.content=n},rename:function(n){e.name=n},setPristine:function(){e.originalContent=e.content,e.originalName=e.name},setEditorState:function(n){e.editorState=n}}})),C=s.V5.model({name:s.V5.optional(s.V5.string,""),id:s.V5.maybe(s.V5.string),parentId:s.V5.maybe(s.V5.string),files:s.V5.array(x),serverFiles:s.V5.array(b),owner:s.V5.maybe(s.V5.string),ownerUsername:s.V5.maybe(s.V5.string),locked:s.V5.maybe(s.V5.boolean),unlisted:s.V5.optional(s.V5.boolean,!1),updated:s.V5.maybe(s.V5.Date),hearts:s.V5.optional(s.V5.number,0),userLiked:s.V5.optional(s.V5.boolean,!1)}).volatile((function(){return{binaryFiles:[],filesDeleted:!1,chips:[],diagramInstance:p.S0.create(),lastDiagramContent:"",tempId:"temp-".concat(Math.random().toString(36).substring(2))}})).views((function(e){return{get diagram(){var n=e.files.find((function(e){return"diagram"===e.type}));if(!n)return null;if((null===n||void 0===n?void 0:n.content)!==e.lastDiagramContent)try{var r;(0,s.Xx)(e.diagramInstance,JSON.parse(null!==(r=null===n||void 0===n?void 0:n.content)&&void 0!==r?r:"null")),e.lastDiagramContent||e.diagramInstance.undoManager.reset()}catch(t){return console.warn("Failed to parse diagram",t),null}return e.diagramInstance},get readme(){return e.files.find((function(e){return"readme"===e.type}))},get modified(){return e.files.some((function(e){return e.modified}))||e.serverFiles.some((function(e){return e.modified}))||e.filesDeleted},findFile:function(n){return e.files.find((function(e){return e.name===n}))},get isDBProject(){return e.id&&/^[0-9]+$/.test(e.id)},get url(){return e.id?(0,f.gd)(e.id):null},get sdCardFiles(){return e.serverFiles.filter((function(e){return e.name.startsWith(k)}))}}})).views((function(e){return{get architecture(){var n,r;switch(null===(n=e.diagram)||void 0===n||null===(r=n.board)||void 0===r?void 0:r.mcuType){case"stm32f103c8":case"stm32l432kc":case"rp2040":return"arm";case"esp32":case"esp32-s2":case"esp32-s3":return"xtensa";case"esp32-c3":case"esp32-c6":return"riscv";case"avr":return"avr"}},get projectType(){var n,r,t,i,a=null===(r=null===(n=e.diagram)||void 0===n?void 0:n.findMCU())||void 0===r?void 0:r.attrs.get("env"),o=null===(i=null===(t=e.diagram)||void 0===t?void 0:t.findMCU())||void 0===i?void 0:i.attrs.get("builder");return(null===a||void 0===a?void 0:a.startsWith("kaluma"))?"kaluma":(null===a||void 0===a?void 0:a.startsWith("micropython"))?"micropython":(null===a||void 0===a?void 0:a.startsWith("circuitpython"))?"circuitpython":(null===o||void 0===o?void 0:o.includes("rust"))?"rust":(null===o||void 0===o?void 0:o.includes("sdk"))||(null===a||void 0===a?void 0:a.includes("zephyr"))?"sdk":"arduino"}}})).actions((function(e){return{addFile:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=e.files.push({name:n,content:r,modified:!0});return e.files[t-1]},addBinaryFile:function(n,r){e.binaryFiles.push({name:n,content:r})},updateFile:function(n,r){var t=e.files.find((function(e){return e.name===n}));null===t||void 0===t||t.update(r)},renameFile:function(n,r){var t;null===(t=e.findFile(n))||void 0===t||t.rename(r),n.endsWith(".ino")&&n===e.name&&(e.name=r)},removeFile:function(n){var r=e.findFile(n);r&&(r.deleted=!0,e.files.remove(r),e.filesDeleted=!0)},uploadFile:function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=t+(0,h.pC)(r),a=e.serverFiles.find((function(e){return e.name===i}));a&&(0,s.ob)(a);var o=b.create({name:i,size:r.size});o.upload(n,r),e.serverFiles.push(o)},removeServerFile:function(e){(0,s.ob)(e)},setName:function(n){e.name=n},changeId:function(n){e.id=n},changeOwner:function(n){e.owner!==n&&(e.ownerUsername=void 0,e.owner=n)},setPristine:function(){e.files.forEach((function(e){return e.setPristine()})),e.serverFiles.forEach((function(e){return e.setPristine()})),e.filesDeleted=!1},setLocked:function(n){e.locked=n},setUnlisted:function(n){e.unlisted=n},updateHearts:function(n){e.hearts=n},updateUserLike:function(n){e.userLiked=n},setChips:function(n){e.chips=n},setGCCErrors:function(n,r){var t=!0,a=!1,o=void 0;try{for(var u,s=e.files[Symbol.iterator]();!(t=(u=s.next()).done);t=!0){u.value.errors=[]}}catch(k){a=!0,o=k}finally{try{t||null==s.return||s.return()}finally{if(a)throw o}}var d=(0,c.qK)(n),l=d.errors,f=d.remainingOutput,v=e.files[0],h=!0,m=!1,g=void 0;try{for(var p,y=function(){var n,r=p.value,t=e.files.find((function(e){return e.name===r}));t?t.errors=l[r]:(n=v.errors).push.apply(n,(0,i.Z)(l[r]))},b=Object.keys(l)[Symbol.iterator]();!(h=(p=b.next()).done);h=!0)y()}catch(k){m=!0,g=k}finally{try{h||null==b.return||b.return()}finally{if(m)throw g}}(n=(0,c.zf)(f)).length>0&&!r&&v.errors.push({type:"error",startLineNumber:1,endLineNumber:1,endColumn:1,startColumn:1,message:n})},syncDiagram:function(){var n,r=e.diagram;r&&(e.lastDiagramContent=u()(function(e){return(0,l.Z)((0,d.Z)({},e),{parts:(e.parts||[]).map((function(e){var n=(0,d.Z)({},e);return n.hide||delete n.hide,n.rotate||delete n.rotate,n}))})}((0,s.vM)(r)),null,2,100),null===(n=e.findFile("diagram.json"))||void 0===n||n.update(e.lastDiagramContent));return e.diagram}}})).actions((function(e){return{updateFromServer:function(n){return(0,t.Z)((function(){var r;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return e.id?[4,(0,v._L)(n,e.id)]:[2];case 1:return r=t.sent().userLiked,e.updateUserLike(r),[2]}}))}))()},loadEgg:function(n){return(0,t.Z)((function(){var t,i,o,u,s,d,l,c,f;return(0,a.__generator)(this,(function(v){switch(v.label){case 0:return t=r.e(2655).then(r.bind(r,27885)),[4,fetch("https://wokwi.com/api/external/hatchery?egg=".concat(encodeURIComponent(n)))];case 1:return[4,v.sent().arrayBuffer()];case 2:return i=v.sent(),[4,t];case 3:o=v.sent().inflate(i),u=!0,s=!1,d=void 0;try{for(l=function(){var n=f.value,r="app/"+n.name.split("/").slice(1).join("/");if(r.endsWith(".png")||r.endsWith(".mpy"))e.addBinaryFile(r,n.data);else{var t=(new TextDecoder).decode(n.data);e.files.find((function(e){return e.name===r}))?e.updateFile(r,t):e.addFile(r,t)}},c=function(e){var n,r,t,i,o,u,s,d,l,c,f,v,h,p,y,b,k,x,C;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:n=new m.B(e),a.label=1;case 1:return n.remaining>512?(r=n.readChars(100),t=g(n.readChars(8)),i=g(n.readChars(8)),o=g(n.readChars(8)),u=g(n.readChars(12)),s=g(n.readChars(12)),d=g(n.readChars(8)),l=n.readChars(1),c=n.readChars(100),f=n.readChars(6),v=n.readChars(2),h="ustar"===f&&"00"===v,p=n.readChars(32),y=n.readChars(32),b=n.readChars(8),k=n.readChars(8),x=n.readChars(155),n.skip(12),r||u||x?(C=n.readBytes(u),u%512!==0&&n.skip(512-u%512),[4,{name:h&&x?"".concat(x,"/").concat(r):r,mode:t,owner:i,group:o,size:u,lastModified:s,checksum:d,type:l,linkName:c,ownerName:h?p:"",groupName:h?y:"",devMajor:h?b:"",devMinor:h?k:"",data:C}]):[3,1]):[3,3];case 2:return a.sent(),[3,1];case 3:return[2]}}))}(o)[Symbol.iterator]();!(u=(f=c.next()).done);u=!0)l()}catch(h){s=!0,d=h}finally{try{u||null==c.return||c.return()}finally{if(s)throw d}}return[2]}}))}))()}}}))},78298:function(e,n,r){r.d(n,{qK:function(){return s},zf:function(){return d},GS:function(){return u}});var t=r(29815),i=r(20014);var a="/sketch/",o="sketch.ino";function u(e,n){return e.split("/sketch/sketch.ino").join(n)}function s(e){var n=(0,t.Z)((0,i.parseString)(e)).concat((0,t.Z)(function(e){for(var n=/(\n|^)(\/sketch\/[^:/]+\.S):(\d+): (Warning|Error): (.+)(\s*\n|$)/g,r=[],t=n.exec(e);t;)r.push({filename:t[2],line:parseInt(t[3],10),type:t[4].toLowerCase(),text:t[5],column:1,tokenLength:999,startIndex:t.index,endIndex:t.index+t[0].length}),n.lastIndex--,t=n.exec(e);return r}(e))),r={},u=null;r[o]=[],n.sort((function(e,n){return e.startIndex==n.startIndex?"note"==e.type?1:-1:e.startIndex-n.startIndex}));var s="",d=!0,l=!1,c=void 0;try{for(var f,v=n[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var h,m,g,p=f.value,y=p.filename,b=p.line,k=p.column,x=p.tokenLength,C=p.text,w=p.type,I=p.startIndex,V=p.endIndex,F=e.substring(null!==(m=null===u||void 0===u?void 0:u.endIndex)&&void 0!==m?m:0,I),L=/\r?\n?.+: In function '.+':\s*$/.exec(F),S=null!==(g=null===L||void 0===L||null===(h=L[0])||void 0===h?void 0:h.replace(/^\s*/g,""))&&void 0!==g?g:"";if(L&&(F=F.substr(0,L.index)),u?u.message+=F:s=F,"note"===w&&u&&u.startLineNumber===b&&u.startColumn===k)u.message+="\n"+C,u.endIndex=V;else if(y.startsWith(a)){var Z=y.substring(a.length);u={type:w,startLineNumber:b,endLineNumber:b,startColumn:k,endColumn:k+(x||1),message:S+C,startIndex:I,endIndex:V},r[Z]||(r[Z]=[]),r[Z].push(u)}else{var N=y.replace(/\/arduino\/hardware\/avr\/[0-9.]+\/cores/g,"");r[o].push({type:w,startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:1,message:"".concat(N,":").concat(b,": ").concat(S+C),startIndex:I,endIndex:V})}}}catch(D){l=!0,c=D}finally{try{d||null==v.return||v.return()}finally{if(l)throw c}}return u&&(u.message+=e.substr(u.endIndex).replace(/Error during build: exit status 1/,"").replace(/\s+$/,"")),{errors:r,remainingOutput:s}}function d(e){var n=e.replace(/.+\n.+\n[ \t]*#\s*pragma message "FastLED version 3\.\d+\.\d+".*\n.+/,"").trim();return"Error during build: exit status 1"===n?"":n}},28467:function(e,n,r){r.d(n,{B:function(){return o}});var t=r(51438),i=r(52951),a=r(14924),o=function(){function e(n){(0,t.Z)(this,e),(0,a.Z)(this,"index",void 0),(0,a.Z)(this,"decoder",void 0),(0,a.Z)(this,"buf",void 0),this.buf=n,this.index=0,this.decoder=new TextDecoder}return(0,i.Z)(e,[{key:"readUint8",value:function(){return this.buf[this.index++]}},{key:"readUint16",value:function(){var e=this.index,n=this.buf[e],r=this.buf[e+1];return this.index+=2,r<<8|n}},{key:"readUint32",value:function(){var e=this.index,n=this.buf[e],r=this.buf[e+1],t=this.buf[e+2],i=this.buf[e+3];return this.index+=4,(i<<24|t<<16|r<<8|n)>>>0}},{key:"readInt32",value:function(){return 0|this.readUint32()}},{key:"readBytes",value:function(e){var n=this.buf.subarray(this.index,this.index+e);return this.index+=e,n}},{key:"readChars",value:function(e){var n=this.readBytes(e),r=n.indexOf(0);return r>=0&&(n=n.subarray(0,r)),this.decoder.decode(n)}},{key:"skip",value:function(e){this.index+=e}},{key:"currentOffset",get:function(){return this.index}},{key:"remaining",get:function(){var e=this.buf.length-this.index;return e>0?e:0}}]),e}()}}]);